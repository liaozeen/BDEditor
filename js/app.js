(function(e){function t(t){for(var i,o,r=t[0],c=t[1],l=t[2],u=0,h=[];u<r.length;u++)o=r[u],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&h.push(n[o][0]),n[o]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);d&&d(t);while(h.length)h.shift()();return s.push.apply(s,l||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],i=!0,r=1;r<a.length;r++){var c=a[r];0!==n[c]&&(i=!1)}i&&(s.splice(t--,1),e=o(o.s=a[0]))}return e}var i={},n={app:0},s=[];function o(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=i,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(a,i,function(t){return e[t]}.bind(null,i));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var d=c;s.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0094":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"top-bar-box"}},[e.mode?a("div",e._l(e.getBtnList,(function(t,i){return a("div",{key:i,staticClass:"btnItem"},[a("BtnTips",{attrs:{itemData:t,disabled:t.disabled&&e.isBanBtn}})],1)})),0):a("div",{staticClass:"topDivBox"},[a("div",{staticClass:"topDiv1"},[a("el-tooltip",{attrs:{content:e.filePath,placement:"bottom",effect:"light",disabled:!e.filePath}},[a("el-input",{attrs:{placeholder:"请选择文件夹",size:"mini",disabled:""},model:{value:e.filePath,callback:function(t){e.filePath=t},expression:"filePath"}},[a("template",{slot:"prepend"},[e._v("路径")]),a("el-button",{attrs:{slot:"append",icon:"el-icon-folder-opened"},on:{click:e.selectFolder},slot:"append"})],2)],1)],1),a("div",{staticClass:"topDiv2"},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入文件名",size:"mini",clearable:""},on:{change:function(t){e.nameUpdated=!0}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitPath(t)}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}),e._v(" "+e._s("当前BD文件："+e.curBDName)+" ")],1)])])},n=[],s=(a("4de4"),a("d3b7"),a("d81d"),a("b0c0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"btnTips-box"},["button"===e.itemData.type?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.itemData.tip||e.itemData.content,placement:"bottom"}},[a("div",{on:{click:function(t){return e.runCallback()}}},[a("el-button",{attrs:{type:"primary",size:"mini",disabled:e.disabled}},[e._v(e._s(e.itemData.content))])],1)]):e._e(),"dropdown"===e.itemData.type?a("el-dropdown",[a("span",{staticClass:"el-dropdown-link"},[e._v(" "+e._s(e.itemData.content)),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.itemData.children,(function(t){return a("el-dropdown-item",{key:t.value},[a("div",{on:{click:function(a){return e.runCallback(t.value)}}},[e._v(" "+e._s(t.content))])])})),1)],1):e._e()],1)}),o=[],r={props:["itemData","disabled"],methods:{runCallback:function(e){this.disabled||this.itemData.method(e)}}},c=r,l=(a("a86e"),a("2877")),d=Object(l["a"])(c,s,o,!1,null,"516316af",null),u=d.exports;function h(e){if(window["ReadStringFromFile"]){var t=QDLocalApi.ReadStringFromFile(e);if(t)return window.UIAction.loadBd(t),!0}return!1}var p=a("1d74"),f={props:["sName","mode","isFromHome","fromHomeFile","originFileName","otherFrameBtn","isBanBtn"],data:function(){return{btnList:[{type:"button",content:"导入",method:this.importFile},{type:"button",content:"源代码",method:this.openXMLCode},{type:"button",content:"撤销",tip:"撤销(Ctrl + Z)",method:this.revoke},{type:"button",content:"恢复",tip:"恢复(Ctrl + Y)",method:this.recover},{type:"button",content:"导出bd",method:this.exportBd},{type:"button",content:"导出png",method:this.exportPng},{type:"button",content:"导出dxf",method:this.exportDxf},{type:"button",content:"清除退出",method:this.clearExit,disabled:!0},{type:"button",content:"重置为矩形",method:this.resetRect},{type:"button",content:"导入Dxf",method:this.importDxfSetRect,disabled:!0}],rootPath:"",filePath:"",curBDName:"",inputValue:"",nameUpdated:!1,isLocalFile:!1}},computed:{getBtnList:function(){var e=this,t=Object(p["a"])();if(1==(null===t||void 0===t?void 0:t.mode))return this.btnList.filter((function(e){return"源代码"==e.content}));if(this.isFromHome){var a=["保存","清除退出","撤销","恢复","导入Dxf"],i=this.btnList.filter((function(t){var i=a.indexOf(t.content)>-1;return e.isBanBtn&&t.disabled&&(i=!1),i}));return i}return this.otherFrameBtn?this.btnList.filter((function(t){return e.otherFrameBtn.indexOf(t.content)>-1})):this.btnList.filter((function(e){return"清除退出"!=e.content}))}},created:function(){this.filePath=localStorage.getItem("bdPath")||""},methods:{clearExit:function(){this.isFromHome&&this.$bus.$emit("btnClick",{type:"清除还原回到主页"})},save:function(){this.isFromHome?this.$bus.$emit("btnClick",{type:"保存到主页"}):this.$bus.$emit("btnClick",{type:this.isLocalFile?"另存为":"保存"})},saveAs:function(){this.$bus.$emit("btnClick",{type:"另存为"})},openXMLCode:function(){this.$bus.$emit("editXMLCode")},revoke:function(){this.$bus.$emit("btnClick",{type:"撤销"})},recover:function(){this.$bus.$emit("btnClick",{type:"恢复"})},importFile:function(){this.isLocalFile=!0,this.$bus.$emit("btnClick",{type:"导入",fileType:"bd"})},openFile:function(){this.isLocalFile=!1,this.$parent.ImgResourceState=!0,this.$parent.dialogType="openBd"},selectFolder:function(){if(this.rootPath){var e=QDLocalApi.ShowFileDialog("dir",this.rootPath);this.filePath=e||this.filePath,localStorage.setItem("bdPath",this.filePath)}else this.$message({message:"请在QD浏览器打开本页面",type:"warning",duration:1500})},submitPath:function(){if(this.filePath)if(this.inputValue){var e=this.filePath+"\\"+this.inputValue+".bd";"0"==QDLocalApi.FileExists(e)?this.$message({message:"当前文件夹下无此BD文件",type:"info",duration:1500}):this.nameUpdated&&h(e)&&(this.curBDName=this.inputValue,this.inputValue="",this.nameUpdated=!1)}else this.$message({message:"请填写文件名",type:"info",duration:1500});else this.$message({message:"请选择文件夹",type:"info",duration:1500})},exportPng:function(){this.$bus.$emit("exportPng")},exportBd:function(){this.$bus.$emit("btnClick",{type:"导出bd"})},exportDxf:function(){this.$bus.$emit("btnClick",{type:"导出dxf"})},importBds:function(e){readTextFiles({fileType:"bd",encoding:"utf-8"}).then((function(t){var a=t.map((function(e){return{content:UnlockBdXML(e.value),filename:e.name}}));"dxf"===e?bdToDxfs(a):"img"===e?bdToImgs(a):"oldBd"===e&&oldBdToNews(a)}))},bdToDxfs:function(){this.importBds("dxf")},bdToImgs:function(){this.importBds("img")},oldToNews:function(){readTextFiles({fileType:"bd",encoding:"gb2312"}).then((function(e){var t=e.map((function(e){return{content:UnlockBdXML(e.value),filename:e.name}}));oldBdToNews(t)}))},openHoleSlotRule:function(){this.$bus.$emit("openHoleSlotRule")},resetRect:function(){this.$bus.$emit("resetRect")},importDxfSetRect:function(){this.$bus.$emit("btnClick",{type:"导入",fileType:"dxf",onlySetGraph:!0})}},components:{BtnTips:u}},m=f,v=(a("3c09"),Object(l["a"])(m,i,n,!1,null,null,null));t["a"]=v.exports},"0297":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"attr-edit-box-cover"},[a("div",{directives:[{name:"drag",rawName:"v-drag",value:{dom:".header",right:-9999,bottom:-9999},expression:"{ dom: '.header', right: -9999, bottom: -9999 }"}],staticClass:"attr-edit-box"},[a("div",{staticClass:"attr-edit-box-main",attrs:{id:"attredit-box"}},[a("div",{staticClass:"header"},[a("span",{staticClass:"title"},[e._v(e._s(e.title))]),a("span",{staticClass:"close",on:{click:e.cancel}},[a("i",{staticClass:"el-icon-close"})])]),a("div",{staticClass:"box-outer"},[a("div",{staticClass:"left-box"},[e._m(0),a("div",{attrs:{id:"table_body_box"}},[a("table",{attrs:{cellspacing:"0",id:"table_body"}},[e._m(1),a("tbody",e._l(e.attrList,(function(t,i){return a("tr",{key:"attr"+i},[a("td",{staticClass:"bgGray"},[e._v(e._s(t[1]))]),a("td",{staticClass:"form-item bgGray"},[a("span",[e._v(e._s(e.getValueOrFormula(t[0],"value")))])]),a("td",{staticClass:"form-item"},[a("div",{staticStyle:{width:"130px"}},[a("QdInput",{class:e.setClass("formula",t[0]),attrs:{inputType:e.getInputType(t[0]),banInput:e.isReadonly(t[0])||e.datas&&e.datas.rangeKeyNames&&e.datas.rangeKeyNames.includes(t[0]),options:e.getInputOpts(t[0])},on:{change:function(a){return e.editAttr(a,t[0],"formula")}},model:{value:e.nodeData[t[0]]["formula"],callback:function(a){e.$set(e.nodeData[t[0]],"formula",a)},expression:"nodeData[item[0]]['formula']"}})],1)])])})),0)])]),a("footer",["Point"!=e.type&&"属性"==e.title?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.openHoleSection}},[e._v(" 孔位区间")]):e._e(),a("el-button",{staticStyle:{float:"right","margin-left":"10px"},attrs:{type:"primary",size:"small"},on:{click:e.comfirm}},[e._v("确定 ")]),a("el-button",{staticStyle:{float:"right"},attrs:{size:"small"},on:{click:e.cancel}},[e._v("取消")]),e.showFaceRadio?a("div",{staticClass:"selectFace"},[a("div",{staticClass:"radio-box"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.nodeData.Face,expression:"nodeData.Face"}],attrs:{type:"radio",id:"radio-faceA",value:"A"},domProps:{checked:e._q(e.nodeData.Face,"A")},on:{change:function(t){return e.$set(e.nodeData,"Face","A")}}}),a("label",{attrs:{for:"radio-faceA"}},[e._v("A")])]),a("div",{staticClass:"radio-box"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.nodeData.Face,expression:"nodeData.Face"}],attrs:{type:"radio",id:"radio-faceB",value:"B"},domProps:{checked:e._q(e.nodeData.Face,"B")},on:{change:function(t){return e.$set(e.nodeData,"Face","B")}}}),a("label",{attrs:{for:"radio-faceB"}},[e._v("B")])])]):e._e()],1)])])]),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isExpand,expression:"!isExpand"}],staticClass:"variableDiv"},[e._m(2),a("div",{staticClass:"variableBody"},e._l(e.keys,(function(t){return a("span",{key:t,staticClass:"variableSpan"},[e._v(e._s(t+"： "+e.attrs[t]))])})),0)]),a("div",{class:[e.isExpand?"shrink_icon1":"expand_btn1"],on:{click:e.expandHandle}},[a("i",{class:[e.isExpand?"el-icon-arrow-right":"el-icon-arrow-left"]})])]),e.holeSectionState?a("holeSection",{attrs:{type:e.holeSectionType,data:e.holeSectionData},on:{close:e.saveHoleSection}}):e._e()],1)},n=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"table_head_box"}},[a("table",{attrs:{cellspacing:"0",id:"table_head"}},[a("colgroup",[a("col",{attrs:{width:"130",name:"项"}}),a("col",{attrs:{width:"130",name:"值"}}),a("col",{attrs:{width:"130",name:"公式"}})]),a("thead",{attrs:{id:"thead"}},[a("tr",[a("td",[e._v("项")]),a("td",[e._v("值")]),a("td",[e._v("公式")])])])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("colgroup",[a("col",{attrs:{width:"130",name:"项"}}),a("col",{attrs:{width:"130",name:"值"}}),a("col",{attrs:{width:"130",name:"公式"}})])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"variableTop"},[a("span",{staticClass:"title"},[e._v("变量")])])}],s=(a("4de4"),a("d3b7"),a("159b"),a("a9e3"),a("b680"),a("caad"),a("2532"),a("ad04")),o=(a("ac1f"),a("5319"),"@@dragContext"),r=function(){return window.document.currentStyle?function(e,t){return e.currentStyle[t]}:function(e,t){return getComputedStyle(e,!1)[t]}}(),c=function(e){var t=this,a=this[o],i=e.clientX-a.dx,n=e.clientY-a.dy,s=document.body.clientWidth,r=document.body.clientHeight,c=this.offsetWidth,l=this.offsetHeight;if(0===a.type)i<a.left?i=a.left:i+c+a.right>s&&(i=s-c-a.right),n<a.top?n=a.top:n+l+a.bottom>r&&(n=r-l-a.bottom);else{var d=s-(a.marginL+c+a.right),u=r-(a.marginT+l+a.bottom);i<-a.marginL+a.left?i=-a.marginL+a.left:i>d&&(i=d),n<-a.marginT+a.top?n=-a.marginT+a.top:n>u&&(n=u)}window.requestAnimationFrame((function(){t.style.left="".concat(i,"px"),t.style.top="".concat(n,"px")}))},l=function(){var e=this[o];document.removeEventListener("mousemove",e.mousemoveEvent,!0),document.removeEventListener("mouseup",e.mouseupEvent,!0)},d=function(e){var t=r(e,"left"),a=r(e,"top");return t.includes("%")?(t=+document.body.clientWidth*(+t.replace(/\%/g,"")/100),a=+document.body.clientHeight*(+a.replace(/\%/g,"")/100)):(t=+t.replace(/\px/g,""),a=+a.replace(/\px/g,"")),{left:t,top:a}},u=function(e){var t=e||event,a=this[o],i=0===a.type?this.offsetLeft:d(this).left,n=0===a.type?this.offsetTop:d(this).top;a.dx=t.clientX-i,a.dy=t.clientY-n,document.addEventListener("mousemove",a.mousemoveEvent,!0),document.addEventListener("mouseup",a.mouseupEvent,!0)},h={bind:function(e,t,a){e[o]={type:0,dx:0,dy:0,top:0,left:0,right:0,bottom:0,marginL:0,marginT:0,mousedownEvent:u.bind(e),mousemoveEvent:c.bind(e),mouseupEvent:l.bind(e),windowResizeEvent:function(){var t=d(e),a=t.left,i=t.top;e[o].marginL=e.offsetLeft-a,e[o].marginT=e.offsetTop-i}};var i=a.context,n=null;i.$nextTick((function(){t.value&&(n=i.$el.querySelector(t.value.dom),t.value.top&&(e[o].top=t.value.top),t.value.left&&(e[o].left=t.value.left),t.value.right&&(e[o].right=t.value.right),t.value.bottom&&(e[o].bottom=t.value.bottom),1===t.value.type&&(e[o].type=1)),1==e[o].type&&(e[o].windowResizeEvent(),window.addEventListener("resize",e[o].windowResizeEvent)),n=n||e,n.style.cursor="move",n.addEventListener("mousedown",e[o].mousedownEvent,!0)}))},unbind:function(e,t,a){var i=a.context;if(t.value){var n=i.$el.querySelector(t.value.dom);n&&n.removeEventListener("mousedown",e[o].mousedownEvent,!0)}window.removeEventListener("resize",e[o].windowResizeEvent),delete e[o]}},p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"holeSection",on:{click:function(t){e.menu.state=!1}}},[a("el-dialog",{attrs:{title:"孔位区间",visible:e.$parent.holeSectionState,width:"80%","close-on-click-modal":!1,"modal-append-to-body":!1,"custom-class":"dialogStyle"},on:{"update:visible":function(t){return e.$set(e.$parent,"holeSectionState",t)}}},[a("div",{on:{contextmenu:function(t){return e.openContextmenu(null,null,t)}}},[a("el-table",{ref:"holeSection",staticStyle:{width:"100%"},attrs:{data:e.tableData,height:"400",border:"","highlight-current-row":""},on:{"row-click":e.setCurrentRow,"row-contextmenu":e.openContextmenu}},e._l(e.tableColumn,(function(t){return a("el-table-column",{key:t.prop,attrs:{prop:t.prop,label:t.label,"min-width":t.minWidth,align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(i){return[t.options?a("QdSelect",{attrs:{options:t.options,optionKey:"value",optionLabel:"label"},model:{value:i.row[t.prop],callback:function(a){e.$set(i.row,t.prop,a)},expression:"scope.row[item.prop]"}}):a("QdInput",{attrs:{isNumber:t.isNumber},model:{value:i.row[t.prop],callback:function(a){e.$set(i.row,t.prop,a)},expression:"scope.row[item.prop]"}})]}}],null,!0)})})),1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.$parent.holeSectionState=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveHoleSection}},[e._v("确 定")])],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.menu.state,expression:"menu.state"}],ref:"contextMenu",style:{top:e.menu.top+"px",left:e.menu.left+"px"},attrs:{id:"qd_contextMenu"}},[a("p",{on:{click:e.tableAdd}},[e._v("添加")]),a("p",{on:{click:e.tableDel}},[e._v("删除")]),a("p",{on:{click:e.tableCopy}},[e._v("复制")]),a("p",{on:{click:e.tablePaste}},[e._v("粘贴")])])],1)},f=[],m=a("b85c"),v=(a("e9c4"),a("b64b"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"QdSelect"},[a("div",{staticStyle:{width:"100%",height:"100%"}},[e._v(" "+e._s(e.getLabel())+" ")]),a("div",{ref:"iconBox",staticClass:"iconBox",on:{click:e.showSelectHandle}},[a("i",{staticClass:"el-icon-caret-bottom"})]),a("transition",{attrs:{name:"el-zoom-in-top"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.editState,expression:"editState"},{name:"clickoutside",rawName:"v-clickoutside",value:e.blurHandle,expression:"blurHandle"}],ref:"QdSelect",staticClass:"QdSelect_ul",style:e.getStyle,on:{mousewheel:function(e){e.stopPropagation()}}},[0==e.options.length?a("div",{staticClass:"QdSelect_ul_box"},[a("p",{staticClass:"QdSelect_ul_box__empty"},[e._v("无数据")])]):e._e(),a("ul",{staticClass:"QdSelect_ul_box"},e._l(e.getOptions,(function(t,i){return a("li",{key:i,class:{selectClass:(e.optionKey?t[e.optionKey]:t)==e.getValue},attrs:{title:e.getOptionsLabel(t)},on:{click:function(a){return e.clickHandle(t)}}},[e._v(" "+e._s(e.getOptionsLabel(t))+" ")])})),0)])])],1)}),b=[],g=(a("7db0"),a("13d5"),a("dd7e")),y={name:"QdSelect",props:{isShowInput:Boolean,row:Object,readonly:Boolean,value:[Number,String],options:{type:Array,default:function(){return[]}},optionKey:"",optionLabel:"",isNumber:{type:Boolean,default:!1},limit:Array,appendToBody:{type:Boolean,default:!1}},data:function(){return{editState:!1,popperElm:null,top:0,left:0,width:100}},methods:{getLabel:function(){var e=this;if(this.optionKey){var t=this.options.find((function(t){return t[e.optionKey]==e.getValue}));return t?t[this.optionLabel]:this.getValue}return this.getValue},getOptionsLabel:function(e){return this.optionLabel?e[this.optionLabel]:e},blurHandle:function(){this.editState=!1},showSelectHandle:function(){this.editState=!this.editState},clickHandle:function(e){var t=this;this.getValue=this.optionKey?e[this.optionKey]:e,this.blurHandle(),this.$nextTick((function(){t.changeHandle()}))},resizeHandle:function(){var e=this.$el.getBoundingClientRect();this.width=e.width,this.left=e.left;var t=this.$refs.QdSelect.clientHeight,a=e.top+e.height;this.top=a+t>document.body.clientHeight?e.top-t:a},changeHandle:function(){this.$emit("change",this.row,this.getValue)}},directives:{clickoutside:g["a"]},watch:{editState:function(e){var t=this;e?(window.addEventListener("resize",this.resizeHandle),document.addEventListener("mousewheel",this.blurHandle),this.$nextTick((function(){t.appendToBody&&t.$el.querySelector(".QdSelect_ul")&&document.body.appendChild(t.$el.querySelector(".QdSelect_ul")),t.resizeHandle()}))):(window.removeEventListener("resize",this.resizeHandle),document.removeEventListener("mousewheel",this.blurHandle))}},components:{QdInput:s["a"]},computed:{getOptions:function(){var e=this;return this.optionLabel?this.options.reduce((function(t,a){return t.some((function(t){return t[e.optionLabel]==a[e.optionLabel]}))||t.push(a),t}),[]):this.options},getValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}},getStyle:function(){return{top:"".concat(this.top,"px"),left:"".concat(this.left,"px"),width:"".concat(this.width,"px")}}},mounted:function(){this.popperElm=this.$refs.iconBox},beforeDestroy:function(){this.appendToBody&&this.$refs.QdSelect&&this.$refs.QdSelect.remove()},destroyed:function(){}},w=y,x=(a("f48e"),a("2877")),C=Object(x["a"])(w,v,b,!1,null,"623fdf18",null),k=C.exports,N={props:["type","data"],data:function(){return{menu:{state:!1,top:0,left:0},currentRow:null,tableColumn:[],tableData:[],copyData:null}},components:{QdInput:s["a"],QdSelect:k},watch:{},computed:{},created:function(){var e=this;"BHole"==this.type?this.tableColumn=[{label:"区间最小值≥",prop:"Min",isNumber:!0,minWidth:"120"},{label:"区间最大值≤",prop:"Max",isNumber:!0,minWidth:"120"},{label:"孔位方向",prop:"HoleAlign",options:[{label:"L",value:"L"},{label:"W",value:"W"}],default:"L",minWidth:"100"},{label:"X坐标",prop:"X",minWidth:"80"},{label:"Y坐标",prop:"Y",minWidth:"80"},{label:"大饼孔直径",prop:"R",isNumber:!0,minWidth:"100"},{label:"大饼孔深度",prop:"Rdepth",isNumber:!0,minWidth:"100"},{label:"水平孔直径",prop:"Rb",isNumber:!0,minWidth:"100"},{label:"水平孔边距",prop:"Hole_Z",isNumber:!0,minWidth:"100"},{label:"水平孔深度",prop:"Hole_D",isNumber:!0,minWidth:"100"},{label:"水平孔朝向",prop:"HDirect",options:[{label:"左",value:"L"},{label:"右",value:"R"},{label:"上",value:"U"},{label:"下",value:"D"}],minWidth:"100"},{label:"X方向孔间距",prop:"Hole_Xcap",minWidth:"120"},{label:"X方向孔数量",prop:"Holenum_X",isNumber:!0,minWidth:"120"},{label:"Y方向孔间距",prop:"Hole_Ycap",minWidth:"120"},{label:"Y方向孔数量",prop:"Holenum_Y",isNumber:!0,minWidth:"120"},{label:"标识",prop:"Rtype",minWidth:"100"}]:this.tableColumn=[{label:"区间最小值≥",prop:"Min",isNumber:!0,minWidth:"120"},{label:"区间最大值≤",prop:"Max",isNumber:!0,minWidth:"120"},{label:"孔位方向",prop:"HoleAlign",options:[{label:"L",value:"L"},{label:"W",value:"W"}],default:"L",minWidth:"100"},{label:"X坐标",prop:"X",minWidth:"80"},{label:"Y坐标",prop:"Y",minWidth:"80"},{label:"垂直孔直径",prop:"R",isNumber:!0,minWidth:"120"},{label:"垂直孔深度",prop:"Rdepth",isNumber:!0,minWidth:"120"},{label:"X方向孔间距",prop:"Hole_Xcap",minWidth:"120"},{label:"X方向孔数量",prop:"Holenum_X",isNumber:!0,minWidth:"120"},{label:"Y方向孔间距",prop:"Hole_Ycap",minWidth:"120"},{label:"Y方向孔数量",prop:"Holenum_Y",isNumber:!0,minWidth:"120"},{label:"标识",prop:"Rtype",minWidth:"100"}],this.data.forEach((function(t){var a={};e.tableColumn.forEach((function(e){a[e.prop]=t[e.prop]||""})),e.tableData.push(a)}))},methods:{setCurrentRow:function(e,t,a){this.currentRow=e},openContextmenu:function(e,t,a){var i=this;a.stopPropagation(),a.preventDefault(),e&&(this.$refs.holeSection.setCurrentRow(e),this.setCurrentRow(e)),this.menu.event=a,this.menu.state=!0,this.$nextTick((function(){if(null!=i.menu.event){var e=i.$refs.contextMenu,t=document.body.clientHeight,a=document.body.clientWidth,n=e.offsetHeight,s=e.offsetWidth,o=i.menu.event.pageX,r=i.menu.event.pageY;i.menu.top=n+r>t?r-n:r,i.menu.left=s+o>a?o-s:o}}))},tableAdd:function(){var e,t={},a=Object(m["a"])(this.tableColumn);try{for(a.s();!(e=a.n()).done;){var i=e.value;t[i.prop]=i.default||""}}catch(n){a.e(n)}finally{a.f()}this.tableData.push(t)},tableDel:function(){var e=this;this.currentRow&&(this.tableData=this.tableData.filter((function(t){return t!=e.currentRow})))},tableCopy:function(){this.currentRow?this.copyData=JSON.parse(JSON.stringify(this.currentRow)):this.$message({type:"error",message:"请选择复制的行",duration:1e3})},tablePaste:function(){var e=this;this.currentRow?this.copyData?this.tableData.forEach((function(t){return t==e.currentRow&&Object.keys(t).forEach((function(a){return t[a]=e.copyData[a]}))})):this.$message({type:"error",message:"请选择复制的行",duration:1e3}):this.$message({type:"error",message:"请选择粘贴的行",duration:1e3})},saveHoleSection:function(){var e=this;if(this.tableData.some((function(e){return""==e.Min||""==e.Max})))this.$message({type:"warning",message:"区间范围不能为空",duration:1e3});else{var t=JSON.parse(JSON.stringify(this.tableData));t.forEach((function(t){e.tableColumn.forEach((function(e){return e.isNumber&&t[e.prop]&&(t[e.prop]=Number(t[e.prop]))}))})),this.$emit("close",t)}}},mounted:function(){}},_=N,H=(a("eaa8"),Object(x["a"])(_,p,f,!1,null,null,null)),S=H.exports,A={props:["datas","type","attrs","title","face"],directives:{drag:h},data:function(){return{nodeData:null,showFaceRadio:!1,showHDirect:!1,showCutDirect:!1,node:nodeAttr,inputOptions:{HDirect:[{label:"左",value:"L"},{label:"右",value:"R"},{label:"上",value:"U"},{label:"下",value:"D"}],CDirect:[{label:"水平",value:"水平"},{label:"垂直",value:"垂直"}],Hotspot:[{label:"是",value:"1"},{label:"否",value:"0"}],IsDim:[{label:"是",value:"1"},{label:"否",value:"0"}],IsBulge:[{label:"是",value:"1"},{label:"否",value:"0"}],IsFill:[{label:"是",value:"1"},{label:"否",value:"0"}]},curInput:null,HDirect:"",CDirect:"",curHcConfigName:"",cutWidth:400,isEdit:!1,unEditKeysByEditAttr:{BHole:["Hole_D"],VHole:[],Point:[],Arc:["StartAngle","Angle"]},unEditKeys:{VHole:[],Point:[],Cut:[]},isExpand:!1,defaultKeys:["L","W","CA","CB","CC","CD","CE","CF","CG","CH","CI","CJ","CK","CL","CM","CN","CO","CP"],holeSectionState:!1,holeSectionType:"",holeSectionData:[]}},components:{QdInput:s["a"],holeSection:S},watch:{HDirect:function(e,t){if(t){this.showHDirect=!1,this.nodeData.HDirect={value:e,formula:e};var a=document.getElementById("HDirect").parentNode.childNodes[0];a.innerHTML=e,this.isEdit=!0}},CDirect:function(e,t){t&&(this.showCutDirect=!1,this.nodeData.CDirect={value:e,formula:e},this.isEdit=!0)}},computed:{handleValidate:function(){console.log(888)},attrList:function(){var e=this,t=this.node[this.type];return"属性"===this.title?"Cut"===this.type?t.filter((function(e){var t=e[0];return"CDirect"!==t&&"Cut_L"!==t})):t:t.filter((function(t){var a=t[0];return"BHole"===e.type?"X"!==a&&"Y"!==a&&"Y1"!==a:"X"!==a&&"Y"!==a&&"X1"!==a&&"Y1"!==a}))},keys:function(){var e=this,t=[];return this.attrs&&this.defaultKeys.forEach((function(a){e.attrs.hasOwnProperty(a)&&t.push(a)})),t}},created:function(){if("属性"===this.title){var e=this.datas.node;"Point"===e||"Arc"===e||"TArc"===e?(this.addLoseAttr(this.datas.attr,e),this.nodeData=copyObject(this.datas.attr)):(this.addLoseAttr(this.datas,e),this.nodeData=copyObject(this.datas)),this.showFaceRadio=!!this.nodeData.Face}else this.nodeData=this.addHoleOrCut(),this.showFaceRadio=!1,this.isEdit=!0},methods:{getValueOrFormula:function(e,t){return this.nodeData[e]||(this.nodeData[e]={value:"",formula:""}),this.nodeData[e][t]},comfirm:function(){var e,t;(this.datas&&this.datas.Face!==this.nodeData.Face&&(this.isEdit=!0),this.isEdit)?("FB"==(null===this||void 0===this||null===(e=this.datas)||void 0===e?void 0:e.Face)?bdDecode.changeFBCutData(this.nodeData):this.nodeData.BDUtils&&(this.nodeData.BDUtils=BDUtils),"FB"==(null===this||void 0===this||null===(t=this.datas)||void 0===t?void 0:t.Face)?this.$emit("close"):this.$emit("close",this.nodeData)):this.$emit("close")},cancel:function(){this.$emit("close")},editAttr:function(e,t,a){if("formula"===a){var i,n,s=null===(i=event)||void 0===i||null===(n=i.currentTarget)||void 0===n?void 0:n.querySelector(".el-input__inner");if(s&&(e.newValue=s.value=ghgjUtil.hgSubZeroFromFormula(e.newValue)),"HDirect"===t||"CDirect"===t)return this.isEdit=!0,void this.setAttr(t,e.newValue,e.newValue);if(""===e.newValue)return this.nodeData[t].formula=0,this.nodeData[t].value=0,void(this.isEdit=!0);var o=this.calculateValue(e.newValue,t);if("number"===typeof o&&(o=Number(o.toFixed(4))),!1!==o&&this.nodeData[t].formula!==o){var r=this.nodeData[t].value;this.isEdit=!0,this.setAttr(t,o,e.newValue),this.editNewAttr(t,r,o)}else this.nodeData[t].formula===o&&(this.isEdit=!0,this.nodeData[t].formula=o,this.nodeData[t].value=o)}},hideSelect:function(){this.showHDirect=!1,this.showCutDirect=!1},calculateValue:function(e,t){var a,i=["HDirect","CutName","Cutter","Rtype"],n=["R","Rb","Holenum_X","Holenum_Y","Cut_L","Hole_Z","Cut_Z"];if(t&&i.indexOf(t)>-1)a=e;else try{a=calcFormula(e,[this.attrs,BDUtils.planeAttr])}catch(s){return this.$message({type:"info",message:"输入值错误，请重新输入",duration:2e3}),!1}if(t&&n.indexOf(t)>-1&&a<0)return this.$message({type:"info",message:"输入值不能为负值，请重新输入",duration:2e3}),!1;try{return null==a?"":a}catch(s){return!1}},addHoleOrCut:function(){var e=this.type,t=this.node[e],a={Face:this.face,node:e};return t.forEach((function(e){a[e[0]]={value:e[2],formula:e[2]}})),"VHole"!==e&&"BHOle"!==e||(a.HDirect={value:"",formula:""}),a},setClass:function(e,t){var a,i,n={selected:!1,bgGray:!1};if("hcConfig"===e&&this.curHcConfigName===t&&(n.selected=!0),"formula"===e){var s=this.getUnEditKeys(this.type);s.indexOf(t)>-1&&(n.bgGray=!0)}return(null===(a=this.datas)||void 0===a?void 0:a.rangeKeyNames)&&(null===(i=this.datas)||void 0===i?void 0:i.rangeKeyNames.includes(t))&&(n.bgGray=!0),n},isReadonly:function(e){var t=this.getUnEditKeys(this.type);return t.indexOf(e)>-1},getUnEditKeys:function(e){var t="属性"===this.title?this.unEditKeysByEditAttr:this.unEditKeys,a=t[e];return a||[]},editNewAttr:function(e,t,a){var i=this.type,n=this.nodeData;if("Cut"===i){var s=a-parseInt(t);if("Cut_L"===e){var o=n["X"].value,r=n["Y"].value,c=n["X1"].value,l=n["Y1"].value;o===c&&r!==l&&(l+=s,n["Y1"].value=l,n["Y1"].formula=l),o!==c&&r===l&&(c+=s,n["X1"].value=c,n["X1"].formula=c)}}if("BHole"===i&&"属性"===this.title){var d=a-parseInt(t);if("Hole_D"===e){var u=n["HDirect"].value,h=0,p=0;"L"===u&&(h=d),"R"===u&&(h=-d),"D"===u&&(p=d),"U"===u&&(p=-d),n["X"].value+=h,n["Y"].value+=p,n["X"].formula=n["X"].value,n["Y"].formula=n["Y"].value}}},setAttr:function(e,t,a){var i=this.nodeData;i[e].value=t,i[e].formula=a,this.updateOtherAttr(e)},updateOtherAttr:function(e){var t=this.nodeData;if("BHole"===t.node&&"属性"===this.title&&("X"===e||"Y"===e||"HDirect"===e)){var a=t["Hole_D"].value,i=t.X.value,n=t.Y.value,s=Number(this.attrs.L)||0,o=Number(this.attrs.W)||0;switch(t.HDirect.value){case"L":a=i;break;case"R":a=s-i;break;case"U":a=o-n;break;case"D":a=n}t["Hole_D"].value=a,t["Hole_D"].formula=a}},getInputType:function(e){switch(e){case"HDirect":case"CDirect":case"Hotspot":case"IsDim":case"IsBulge":case"IsFill":return"el-select"}return"el-input"},getInputOpts:function(e){return this.inputOptions[e]||[]},expandHandle:function(){this.isExpand=!this.isExpand},openHoleSection:function(){var e;this.holeSectionType=this.datas.node,this.holeSectionData=(null===(e=this.datas)||void 0===e?void 0:e.getHoleRanges())||[],this.holeSectionState=!0},saveHoleSection:function(e){this.datas.setHoleRanges(e),this.holeSectionState=!1},addLoseAttr:function(e,t){var a=this.node[t];a&&a.forEach((function(t){var a=t[0],i=t[2]||0;void 0===e[a]&&(e[a]={formula:i,value:i})}))}},mounted:function(){}},B=A,D=(a("d490"),Object(x["a"])(B,i,n,!1,null,"768e5410",null));t["a"]=D.exports},"0795":function(e,t,a){"use strict";a("4a36")},"0ef8":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"QdInput",class:[e.readonly?"unInput_item":""]},[e.editState?a("el-input",{ref:"input",attrs:{readonly:e.readonly,maxlength:e.maxlength},on:{input:e.limitNumber,focus:e.focusHandle,blur:e.blurHandle,change:e.changeHandle},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}):a("div",{staticClass:"Qd-edit__text",on:{click:function(t){return e.toggleHandle("click")},dblclick:function(t){return e.toggleHandle("dblclick")}}},[e.readonly?a("i",{staticClass:"el-readonly el-icon-lock"}):e._e(),e.$slots.default?e._t("default"):a("div",[e._v(e._s(e.getValue))])],2)],1)},n=[],s=a("3835");a("a9e3"),a("4d63"),a("ac1f"),a("2c3e"),a("25f0"),a("00b4"),a("5319"),a("d3b7"),a("466d"),a("b64b");var o=function(e){if(null==e)return!0;if("boolean"===typeof e)return!1;if("number"===typeof e)return isNaN(e);if(e instanceof Error)return""===e.message;switch(Object.prototype.toString.call(e)){case"[object String]":case"[object Array]":return!e.length;case"[object File]":case"[object Map]":case"[object Set]":return!e.size;case"[object Object]":return!Object.keys(e).length}return!1};var r={name:"QdInput",props:{isShowInput:Boolean,isFocus:Boolean,readonly:Boolean,value:[String,Number],isNumber:{type:Boolean,default:!1},limit:Array,trigger:{type:String,default:"dblclick"},maxlength:Number,rule:RegExp,emptyDefault:{type:String}},data:function(){return{inputValue:"",editState:!1}},methods:{focusHandle:function(){this.$emit("focus")},toggleHandle:function(e){var t=this;this.readonly||e==this.trigger&&(this.inputValue=this.getValue,this.editState=!0,this.$nextTick((function(){t.$el.querySelector(".el-input__inner")&&t.$el.querySelector(".el-input__inner").focus()})))},blurHandle:function(){if(this.isNumber&&Array.isArray(this.limit)&&this.limit.length>1){var e=Object(s["a"])(this.limit,2),t=e[0],a=e[1];void 0!=a&&this.inputValue>a&&(this.inputValue=a,this.$message({type:"info",message:"最大值是: ".concat(a),duration:1500,customClass:"qd-input-message"})),void 0!=t&&this.inputValue<t&&(this.inputValue=t,this.$message({type:"info",message:"最小值是: ".concat(t),duration:1500,customClass:"qd-input-message"}))}void 0!=this.emptyDefault&&o(this.inputValue)&&(this.inputValue=this.emptyDefault),this.rule&&!this.rule.test(this.inputValue)?this.$message({type:"info",message:"填写规则不符合",duration:1e3,customClass:"qd-input-message"}):this.getValue=this.inputValue,!this.isShowInput&&(this.editState=!1),this.$emit("blur",this.getValue),this.changeHandle(this.getValue)},changeHandle:function(e){this.$emit("change",e)},limitNumber:function(){if(this.isNumber){var e=this.$el.querySelector("input");e.value=e.value.replace(/[^(\-){1}\d.]/g,"").replace(/\.{2,}/g,".").replace(".","$#$").replace(/\./g,"").replace("$#$",".").replace(/\-{2,}/g,"-").replace(/(\d)-/g,"$1").replace("-","$#$").replace(/\-/g,"").replace("$#$","-"),this.getValue=this.inputValue=e.value}}},computed:{getValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},watch:{getValue:{immediate:!0,handler:function(e){this.inputValue=e}}},mounted:function(){var e=this;this.editState=this.isShowInput,this.$nextTick((function(){var t=e.$refs["input"];t&&e.isShowInput&&e.isFocus&&(t.focus(),t.select())}))}},c=r,l=(a("5c5a"),a("25f3"),a("2877")),d=Object(l["a"])(c,i,n,!1,null,"6d638bd2",null);t["a"]=d.exports},"16f4":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"imgSource"},[i("div",{directives:[{name:"drag",rawName:"v-drag",value:{dom:".content_header",type:1},expression:"{dom:'.content_header',type:1}"}],staticClass:"imgSrc_content"},[i("div",{staticClass:"content_header"},[i("span",{staticClass:"header_title"},[e._v(e._s(e.getTitle))]),i("i",{staticClass:"el-icon-close",on:{click:e.closeHandle}})]),i("div",{staticClass:"content_main"},[i("div",{staticClass:"main_left"},[i("div",{staticClass:"main_left--header"},[i("el-input",{attrs:{placeholder:"请输入目录",size:"mini"},model:{value:e.seachListText,callback:function(t){e.seachListText=t},expression:"seachListText"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),i("el-scrollbar",{staticStyle:{height:"100%"},attrs:{"wrap-class":"scrollbar-wrapper"}},[i("div",{staticClass:"main_left--tree"},[i("el-tree",{ref:"tree",attrs:{data:e.tree.data,"node-key":"sName",props:e.tree.defaultProps,"highlight-current":!0,accordion:"","expand-on-click-node":!1,"filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.node;return i("span",{staticClass:"custom-tree-node"},[i("span",[i("i",{staticClass:"el-icon-folder-opened"}),e._v(" "+e._s(a.label)+" ")])])}}])})],1)])],1),i("div",{staticClass:"main_right"},[i("div",{staticClass:"main_right--header"},[i("el-input",{attrs:{placeholder:"请输入文件名",size:"mini"},model:{value:e.seachImgText,callback:function(t){e.seachImgText=t},expression:"seachImgText"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),i("div",{staticClass:"main_right--body"},[i("el-scrollbar",{staticStyle:{height:"100%"}},e._l(e.getListData,(function(t){return i("div",{key:t.id,class:["imgItem",e.currentImgName==t.sName?"select_img":""],on:{click:function(a){return a.stopPropagation(),e.imgClickHandle(t)}}},[i("el-image",{attrs:{src:t.icon,lazy:""}},[i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("img",{attrs:{src:a("ee87")}})])]),i("div",{staticClass:"imgTitle",attrs:{title:t.sName}},[e._v(e._s(t.sName))]),i("el-popover",{attrs:{placement:"bottom-start",width:"350",trigger:"hover","visible-arrow":!1,"popper-class":"ImgInfo_popper"}},[i("el-image",{attrs:{src:t.icon}},[i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("img",{attrs:{src:a("ee87")}})])]),i("div",{staticClass:"popper_title"},[e._v("名称: "+e._s(t.sName))]),i("i",{staticClass:"el-icon-info img_info",attrs:{slot:"reference"},slot:"reference"})],1)],1)})),0)],1)])]),i("div",{staticClass:"content_footer"},[e.isShowSaveAs?i("el-row",{staticClass:"saveAs_class",attrs:{gutter:10}},[i("el-col",{attrs:{span:10}},[e._v("另存为文件名:")]),i("el-col",{attrs:{span:14}},[i("el-input",{attrs:{size:"mini"},model:{value:e.saveAsText,callback:function(t){e.saveAsText=t},expression:"saveAsText"}})],1)],1):e._e(),i("el-button",{attrs:{size:"mini"},on:{click:e.closeHandle}},[e._v("关闭")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.confirmHandle}},[e._v("确认")])],1)])])},n=[],s=a("c7eb"),o=a("1da1"),r=(a("4de4"),a("d3b7"),a("caad"),a("2532"),a("d81d"),a("32e0")),c=a("ee37"),l={name:"imgSource",data:function(){return{seachListText:"",seachImgText:"",saveAsText:"",currentImgName:"",tree:{query:"",data:[],selectNode:null,defaultProps:{children:"children",label:"sName"}},list:{data:[],query:"",selectArray:[]}}},props:{type:String},watch:{seachListText:function(e){this.$refs.tree.filter(e)}},computed:{getTitle:function(){var e={openBd:"选择文件",saveBd:"保存",saveAsBd:"另存为"};return e[this.type]},isShowSaveAs:function(){return"saveAsBd"==this.type},getListData:function(){var e=this;return this.list.data.filter((function(t){return t.sName.includes(e.seachImgText)||""==e.seachImgText}))}},directives:{drag:r["a"]},methods:{handleInit:function(){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){var a;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("openBd"!=e.type&&"saveAsBd"!=e.type){t.next=8;break}return t.next=3,Object(c["a"])({type:"BD"});case 3:a=t.sent,1==a.state&&(e.tree.data=a.dataList.map((function(e){return{sName:e.dirName,type:"group",dirId:e.id}}))),e.handleNodeClick(e.tree.data[0]),t.next=9;break;case 8:e.type;case 9:case"end":return t.stop()}}),t)})))()},handleNodeClick:function(e){var t=this;return Object(o["a"])(Object(s["a"])().mark((function a(){var i;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.seachListText=t.seachImgText="",t.tree.selectNode=e,"openBd"!=t.type&&"saveAsBd"!=t.type){a.next=7;break}return a.next=5,Object(c["c"])({type:"BD",dirId:e.dirId});case 5:i=a.sent,1==i.state?t.list.data=i.dataList.map((function(e){return{sName:e.fileName,id:e.id,dirId:e.dir,icon:e.icon}})):t.$message({type:"error",message:"获取数据失败",duration:1e3,customClass:"messageClass"});case 7:case"end":return a.stop()}}),a)})))()},imgClickHandle:function(e){this.currentImgName=e.sName,this.list.selectArray=[e],this.isShowSaveAs&&(this.saveAsText=e.sName.substring(0,e.sName.indexOf(".")))},confirmHandle:function(){if(this.isShowSaveAs&&""==this.saveAsText)this.$message({type:"error",message:"另存为文件名不能为空",duration:1e3});else{var e=this.list.selectArray[0],t=this.tree.selectNode;this.$emit("onSuccess",e,t,this.saveAsText)}},closeHandle:function(){this.$emit("onClose")},filterNode:function(e,t){return!e||-1!==t.sName.indexOf(e)}},mounted:function(){this.handleInit()}},d=l,u=(a("83a5"),a("9bb1"),a("2877")),h=Object(u["a"])(d,i,n,!1,null,"d90e251a",null);t["a"]=h.exports},"1d74":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));a("ac1f"),a("841c");function i(){var e=location.search.length>0?location.search.substring(1):"",t={},a=e.length?e.split("&"):[],i=null,n=null,s=null,o=0,r=a.length;for(o=0;o<r;o++)i=a[o].split("="),n=decodeURIComponent(i[0]),s=decodeURIComponent(i[1]),n.length&&(t[n]=s);return t}},"20ca":function(e,t,a){"use strict";function i(e,t){var a,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=function(){for(var n=this,s=arguments.length,o=new Array(s),r=0;r<s;r++)o[r]=arguments[r];if(a&&clearTimeout(a),i){var c=!a;a=setTimeout((function(){a=null}),t),c&&e.apply(this,o)}else a=setTimeout((function(){return e.apply(n,o)}),t)};return n.cancel=function(){clearTimeout(a)},n}a.d(t,"a",(function(){return i}))},"25f3":function(e,t,a){"use strict";a("e19c")},"26a1":function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));a("a9e3"),a("ac1f"),a("5319");var i=a("2b0e"),n=i["default"].prototype.$isServer,s=(n||Number(document.documentMode),function(){return!n&&document.addEventListener?function(e,t,a){e&&t&&a&&e.addEventListener(t,a,!1)}:function(e,t,a){e&&t&&a&&e.attachEvent("on"+t,a)}}());(function(){!n&&document.removeEventListener})()},"292a":function(e,t,a){"use strict";a("fabb")},2940:function(e,t,a){},"2a4d":function(e,t,a){},"2acc":function(e,t,a){},"2d1e":function(e,t,a){var i={"./1.jpg":"38f3","./中心孔.jpg":"d898","./前后端等距.jpg":"6161","./均分孔.jpg":"9be2","./靠前对齐.jpg":"3aa0","./靠背对齐.jpg":"bc4d"};function n(e){var t=s(e);return a(t)}function s(e){if(!a.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}n.keys=function(){return Object.keys(i)},n.resolve=s,e.exports=n,n.id="2d1e"},"2d48":function(e,t,a){},"2e6a":function(e,t,a){"use strict";a("526c")},3233:function(e,t,a){"use strict";a("8c7e")},"32e0":function(e,t,a){"use strict";a("caad"),a("2532"),a("ac1f"),a("5319");var i="@@dragContext",n=function(){return window.document.currentStyle?function(e,t){return e.currentStyle[t]}:function(e,t){return getComputedStyle(e,!1)[t]}}(),s=function(e){var t=this,a=this[i],n=e.clientX-a.dx,s=e.clientY-a.dy,o=document.body.clientWidth,r=document.body.clientHeight,c=this.offsetWidth,l=this.offsetHeight;if(0==a.type)n<a.left?n=a.left:n+c+a.right>o&&(n=o-c-a.right),s<a.top?s=a.top:s+l+a.bottom>r&&(s=r-l-a.bottom);else{var d=o-(a.marginL+c+a.right),u=r-(a.marginT+l+a.bottom);n<-a.marginL+a.left?n=-a.marginL+a.left:n>d&&(n=d),s<-a.marginT+a.top?s=-a.marginT+a.top:s>u&&(s=u)}window.requestAnimationFrame((function(){t.style.left="".concat(n,"px"),t.style.top="".concat(s,"px")}))},o=function(){var e=this[i];document.removeEventListener("mousemove",e.mousemoveEvent,!0),document.removeEventListener("mouseup",e.mouseupEvent,!0)},r=function(e){var t=n(e,"left"),a=n(e,"top");return t.includes("%")?(t=+document.body.clientWidth*(+t.replace(/\%/g,"")/100),a=+document.body.clientHeight*(+a.replace(/\%/g,"")/100)):(t=+t.replace(/\px/g,""),a=+a.replace(/\px/g,"")),{left:t,top:a}},c=function(e){var t=e||event,a=this[i],n=0==a.type?this.offsetLeft:r(this).left,s=0==a.type?this.offsetTop:r(this).top;a.dx=t.clientX-n,a.dy=t.clientY-s,document.addEventListener("mousemove",a.mousemoveEvent,!0),document.addEventListener("mouseup",a.mouseupEvent,!0)};t["a"]={bind:function(e,t,a){e[i]={type:0,dx:0,dy:0,top:0,left:0,right:0,bottom:0,marginL:0,marginT:0,mousedownEvent:c.bind(e),mousemoveEvent:s.bind(e),mouseupEvent:o.bind(e),windowResizeEvent:function(){var t=r(e),a=t.left,n=t.top;e[i].marginL=e.offsetLeft-a,e[i].marginT=e.offsetTop-n}};var n=a.context,l=null;n.$nextTick((function(){t.value&&(l=n.$el.querySelector(t.value.dom),t.value.top&&(e[i].top=t.value.top),t.value.left&&(e[i].left=t.value.left),t.value.right&&(e[i].right=t.value.right),t.value.bottom&&(e[i].bottom=t.value.bottom),1==t.value.type&&(e[i].type=1)),1==e[i].type&&(e[i].windowResizeEvent(),window.addEventListener("resize",e[i].windowResizeEvent)),l=l||e,l.style.cursor="move",l.addEventListener("mousedown",e[i].mousedownEvent,!0)}))},unbind:function(e,t,a){var n=a.context;if(t.value){var s=n.$el.querySelector(t.value.dom);s&&s.removeEventListener("mousedown",e[i].mousedownEvent,!0)}window.removeEventListener("resize",e[i].windowResizeEvent),delete e[i]}}},"33c4":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:{"is-viewer":!e.mode},attrs:{id:"right-part-box"}},[a("Canvas2d",{staticClass:"main",attrs:{mode:e.mode}}),a("RightBottomBar",{staticClass:"bottom",attrs:{mode:e.mode}})],1)},n=[],s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"right-bottom-box"},[a("qd-arrow",{attrs:{padding:10,step:300,size:"small"}},[a("div",{staticClass:"btn-area"},[a("div",{staticClass:"btn-area-item"},[a("el-checkbox",{model:{value:e.isShowHoleInfo,callback:function(t){e.isShowHoleInfo=t},expression:"isShowHoleInfo"}},[e._v("显示孔位信息")])],1),a("div",{staticClass:"btn-area-item"},[a("b",[e._v("长度")]),e._v("："+e._s(e.attrs.L||0))]),a("div",{staticClass:"btn-area-item"},[a("b",[e._v("宽度")]),e._v("："+e._s(e.attrs.W||0))]),a("div",{staticClass:"btn-area-item"},[a("b",[e._v("厚度")]),e._v("："+e._s(e.attrs.BH||0))]),a("div",{staticClass:"btn-area-item flex-center"},[a("b",[e._v("靠挡")]),e._v("： "),e.mode?a("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.gearTips,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):a("div",[e._v(" "+e._s(e.gearTips.filter((function(t){return t.value==e.value}))[0].label)+" ")])],1),e._l(e.fbs,(function(t){return a("div",{key:t.key,staticClass:"btn-area-item flex-center"},[a("b",[e._v(e._s(t.label))]),e._v("： "),a("el-input",{attrs:{size:"mini",readonly:!e.mode},nativeOn:{input:function(a){return function(i){return e.eidtBdAttr(a,e.attrs,t.key)}()}},model:{value:e.attrs[t.key],callback:function(a){e.$set(e.attrs,t.key,a)},expression:"attrs[item.key]"}})],1)})),a("div",{staticClass:"btn-area-item"},[a("b",[e._v("备注")]),e._v("： "),a("el-input",{staticStyle:{width:"100px"},attrs:{size:"mini",disabled:""},nativeOn:{input:function(t){return function(a){return e.eidtBdAttr(t,e.attrs,"MEMO",!1)}()}},model:{value:e.attrs.MEMO,callback:function(t){e.$set(e.attrs,"MEMO",t)},expression:"attrs.MEMO"}})],1)],2)]),a("div",{staticClass:"info-box",style:{right:e.isExpand?"-300px":"0"}},[a("div",{staticClass:"expand_btn1",on:{click:e.expandHandle}},[e._v(" 订单信息 "),a("i",{class:e.isExpand?"el-icon-caret-left":"el-icon-caret-right"})]),a("div",{staticClass:"info-main"},[a("el-scrollbar",{staticStyle:{height:"100%"}},e._l(e.showAttrKeys,(function(t){return a("div",{key:t[0],staticClass:"info-item"},[a("div",{staticClass:"label"},[e._v(e._s(t[1]+"："))]),a("el-tooltip",{attrs:{content:e.attrs[t[0]],placement:"bottom",effect:"light","open-delay":500}},[a("div",{staticClass:"value"},[e._v(e._s(e.attrs[t[0]]))])])],1)})),0)],1)])],1)},o=[],r=(a("ac1f"),a("5319"),a("b64b"),a("99af"),a("ad04")),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"resize",rawName:"v-resize",value:e.handleResize,expression:"handleResize"}],class:{QdArrow:!0,"qd-arrow-mini":"mini"==e.size,"qd-arrow-small":"small"==e.size,"qd-arrow-medium":"medium"==e.size},on:{mouseenter:function(t){return e.handleShowArrow(!0)},mouseleave:function(t){return e.handleShowArrow(!1)},mousewheel:e.handleMousewheel}},[a("div",{ref:"main",staticClass:"QdArrow-main",style:e.getMainStyle},[a("div",{directives:[{name:"resize",rawName:"v-resize",value:e.handleResize,expression:"handleResize"}],ref:"container",staticClass:"QdArrow-container",style:e.getStyle},[e._t("default")],2)]),e.isOverFlow?[a("transition",{attrs:{name:e.transition}},[a("button",{directives:[{name:"show",rawName:"v-show",value:e.arrowState,expression:"arrowState"}],staticClass:"QdArrow-button QdArrow-button-left",on:{click:function(t){return e.handleArrow(1)}}},[a("i",{staticClass:"el-icon-arrow-left"})])]),a("transition",{attrs:{name:e.transition}},[a("button",{directives:[{name:"show",rawName:"v-show",value:e.arrowState,expression:"arrowState"}],staticClass:"QdArrow-button QdArrow-button-right",on:{click:function(t){return e.handleArrow(-1)}}},[a("i",{staticClass:"el-icon-arrow-right"})])])]:e._e()],2)},l=[],d=(a("a9e3"),a("20ca")),u=a("eec4"),h=a.n(u),p=function(e,t){var a=300,i=function(){console.log("没有执行方法")};t.value&&(i="function"==typeof t.value?t.value:"function"==typeof t.value.handler?t.value.handler:i,a=parseFloat(t.value.delay)>0?t.value.delay:a),e._v_delay=a,e._v_resize=i},f={bind:function(e,t){p(e,t),e._v_resize_detector=e._v_resize_detector||h()({strategy:"scroll"}),e._v_resize_detector.listenTo(e,Object(d["a"])((function(t){e._v_resize(e)}),e._v_delay))},update:function(e,t){t.value!==t.oldValue&&(delete e._v_resize,p(e,t))},unbind:function(e,t){e._v_resize_detector.uninstall(e),delete e._v_resize_detector,delete e._v_resize,delete e._v_delay}},m={name:"QdArrow",props:{step:{type:Number,default:150},size:{type:String},padding:{type:Number,default:30},transition:{type:String,default:"el-zoom-in-top"}},data:function(){return{isOverFlow:!1,arrowState:!1,moveX:0}},directives:{resize:f},methods:{handleArrow:function(e,t){var a,i,n,s=this.moveX,o=(null!==t&&void 0!==t?t:this.step)*e,r=null===(a=this.$refs.container)||void 0===a?void 0:a.clientWidth,c=null===(i=this.$refs)||void 0===i||null===(n=i.main)||void 0===n?void 0:n.clientWidth;o=-1==e?c-r>o+s?c-r:o+s:s+o>0?0:s+o,this.moveX=o},handleResize:function(){var e,t,a,i=null===(e=this.$refs.container)||void 0===e?void 0:e.clientWidth,n=null===(t=this.$refs)||void 0===t||null===(a=t.main)||void 0===a?void 0:a.clientWidth;this.isOverFlow=n<i,this.isOverFlow?this.moveX<n-i&&(this.moveX=n-i):this.moveX=0},handleShowArrow:function(e){this.arrowState=e},handleMousewheel:function(){if(this.isOverFlow){var e=event.wheelDelta>0?-1:1;this.handleArrow(e,50)}}},computed:{getMainStyle:function(){return{margin:"0 ".concat(this.padding,"px")}},getStyle:function(){return{transform:"translateX(".concat(this.moveX,"px)")}}},mounted:function(){}},v=m,b=(a("0795"),a("2877")),g=Object(b["a"])(v,c,l,!1,null,"0d7db7a4",null),y=g.exports,w={props:["data","mode"],data:function(){return{curFace:"0",attrs:{},isExpand:!0,isShowHoleInfo:!1,gearTips:[{label:"下靠档(初始状态)",value:0},{label:"上靠档(旋转180度)",value:180},{label:"左靠档(旋转90度)",value:90},{label:"右靠档(旋转270度)",value:270}],planes:[{label:"层板类(XY平面)",value:"XY"},{label:"侧板类(YZ平面)",value:"YZ"},{label:"背板类(XZ平面)",value:"XZ"}],value:0,planeType:"",byParam:{},memo:"",fbs:[{label:"左封边",key:"LFB"},{label:"右封边",key:"RFB"},{label:"上封边",key:"UFB"},{label:"下封边",key:"DFB"},{label:"异形封边",key:"FB"}],showAttrKeys:[["ORDER","订单号"],["GNO","产品号"],["NAME","板件名称"],["Mat","板件材料"],["Color","板件颜色"],["MEMO","备注"],["成品尺寸","成品尺寸"],["Size","开料尺寸"],["TIME","订单日期"],["OrderType","订单类型"],["JXS","经销商"],["JXSADDR","经销商地址"],["JXSPHONE","经销商电话"],["CLIENT","客户名称"],["ProductLevel","产品难度"],["TYPE","板件类型"],["KcFlag","开槽备注"],["Classifyl","分类标签1"],["Classifyl2","分类标签2"],["Classifyl3","分类标签3"],["Classifyl4","分类标签4"],["Classifyl5","分类标签5"],["HoleStr","打孔备注"]]}},components:{QdInput:r["a"],QdArrow:y},created:function(){var e=this;this.attrs=BdAttrs,bdDecode.event.selectFace.replaceSubcribe((function(t){e.curFace!==t&&(e.curFace=t)}),"rightBottomBar")},mounted:function(){var e=this;this.$bus.$on("boarAttr",this.update),this.handleEdit=Object(d["a"])((function(t,a){e.$bus.$emit("editBoard",{key:a,newValue:t[a],oldValue:""})}),500)},watch:{value:function(e,t){this.attrs&&this.$bus.$emit("cncback",{CncBack:cncbacks[this.value],degree:this.value})},isShowHoleInfo:function(){this.$bus.$emit("isShowHoleInfo",this.isShowHoleInfo)}},methods:{update:function(e){var t,a;for(var i in this.memo=null!==(t=null===e||void 0===e?void 0:e.MEMO)&&void 0!==t?t:"",this.planeType=e.planeType?e.planeType.replace(/Plane/,""):"",this.value=cncbacks[e.CncBack],"百叶"===e.type?this.setBYParam(e.Param):this.byParam={},e)this.attrs[i]=e[i];(null===(a=this.attrs)||void 0===a||!a.MEMO)&&this.$set(this.attrs,"MEMO",""),this.attrs["成品尺寸"]=this.getProductSize(e.L,e.W,e.BH)},changePlane:function(){this.$bus.$emit("changePlane",this.planeType.toLowerCase())},setBYParam:function(e){if(e){var t=parseObjectString(e,/\^/g);this.byParam=t||{},this.byParam.BarH=this.byParam.BarH||""}},changeBYBarH:function(){for(var e="",t=Object.keys(this.byParam),a=0;a<t.length;a++){var i=t[a];e+="^".concat(i,"^:^").concat(this.byParam[i]||"","^"),a!==t.length-1&&(e+=",")}this.attrs["Param"]=e},eidtBdAttr:function(e,t,a){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=e.target;i&&(n.value=n.value.replace(/[^(\-){1}\d.]/g,"").replace(/\.{2,}/g,".").replace(".","$#$").replace(/\./g,"").replace("$#$",".").replace(/\-{2,}/g,"-").replace("-","$#$").replace(/\-/g,"").replace("$#$","-"),t[a]=n.value),this.handleEdit(t,a)},getProductSize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return"".concat(e,"*").concat(t,"*").concat(a)},expandHandle:function(){this.isExpand=!this.isExpand}}},x=w,C=(a("e3ac"),Object(b["a"])(x,s,o,!1,null,"27aecd46",null)),k=C.exports,N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"canvas-box"},on:{dragenter:e.dragenter,dragleave:e.dragleave,dragover:e.dragover,drop:e.fileDrop}},[a("canvas",{ref:"canvas",attrs:{id:"canvas",tabindex:"-1"}}),a("div",{ref:"jcanvas",attrs:{tabindex:"-1"}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.mode,expression:"mode"}],staticClass:"face-select"},[e._l(e.faces,(function(t){return a("div",{staticClass:"face-item",class:{selected:e.state===t},on:{click:function(a){return e.selectFace(t)}}},[e._v(" "+e._s(t)+"面 ")])})),a("div",{staticClass:"face-item",class:{selected:"0"===e.state},on:{click:function(t){return e.selectFace("0")}}},[e._v(" 预览 ")])],2),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowAddBtns,expression:"isShowAddBtns"}],staticClass:"addHC-box"},[e._l(e.btnList,(function(t){return a("el-tooltip",{key:t.content,attrs:{effect:"light",content:t.tip,placement:"left"}},[a("div",{staticClass:"addHC-item",on:{click:function(a){return e.addHC(t.content)}}},[a("i",[e._v(e._s(t.content))])])])})),"home"!==e.$vuex.parentpagename?a("el-tooltip",{attrs:{effect:"light",content:"导入图元",placement:"left"}},[a("div",{staticClass:"addHC-item",on:{click:e.importPrimitive}},[a("i",[e._v("图元")])])]):e._e(),a("el-tooltip",{attrs:{effect:"light",content:"组合孔",placement:"left"}},[a("div",{staticClass:"addHC-item",on:{click:e.holeCfgHandle}},[a("i",[e._v("孔")])])]),a("el-tooltip",{attrs:{effect:"light",content:"线转圆弧",placement:"left"}},[a("div",{staticClass:"addHC-item",on:{click:e.lineToArcHandle}},[a("i",[e._v("弧")])])])],2),e.holeCfg.state?a("holeCfg",{attrs:{direct:e.direct},on:{close:function(t){e.holeCfg.state=!1}}}):e._e(),e.floatPanel.state?a("div",{staticClass:"panelInfo"},[a("i",{staticClass:"el-icon-info"}),e._v(" "+e._s(e.floatPanel.info)+" ")]):e._e(),e.ImgResourceState?a("ImgResource",{attrs:{"on-close":e.ImgResourceClose,"on-success":e.ImgResourceSuccess,type:"import"}}):e._e()],1)},_=[],H=a("c7eb"),S=a("1da1"),A=(a("caad"),a("b0c0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"holeCfg",attrs:{loading:e.loading}},[a("div",{directives:[{name:"drag",rawName:"v-drag",value:{dom:"header",type:1},expression:"{dom:'header',type:1}"}],staticClass:"holeCfg_content"},[a("header",[a("span",{staticClass:"header_title"},[e._v("新增组合孔")]),a("i",{staticClass:"el-icon-close",on:{click:e.closeHandle}})]),a("main",[a("el-row",{staticClass:"row_item",attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-row",[a("el-col",{attrs:{span:10}},[e._v("孔位类型:")]),a("el-col",{attrs:{span:14}},[a("el-radio-group",{on:{change:e.holeTypeChange},model:{value:e.holeType,callback:function(t){e.holeType=t},expression:"holeType"}},[a("el-radio",{attrs:{label:"大饼孔"}},[e._v("大饼孔")]),a("el-radio",{attrs:{label:"垂直孔"}},[e._v("垂直孔")])],1)],1)],1)],1)],1),a("el-row",{staticClass:"row_item",attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-row",[a("el-col",{attrs:{span:10}},[e._v("孔位朝向:")]),a("el-col",{attrs:{span:14}},[a("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:e.holeFB.value,callback:function(t){e.$set(e.holeFB,"value",t)},expression:"holeFB.value"}},e._l(e.holeFB.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-row",[a("el-col",{attrs:{span:10}},[e._v("垂直孔边距:")]),a("el-col",{attrs:{span:14}},[a("el-input",{attrs:{placeholder:"请输入内容",size:"mini",disabled:e.getSiteDisable},model:{value:e.holeSite.value,callback:function(t){e.$set(e.holeSite,"value",t)},expression:"holeSite.value"}})],1)],1)],1)],1),a("el-row",{staticClass:"row_item",attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-row",[a("el-col",{attrs:{span:10}},[e._v("孔位信息:")]),a("el-col",{attrs:{span:14}},[a("el-select",{attrs:{placeholder:"请选择",size:"mini"},on:{change:e.holeInfoChange},model:{value:e.holeInfo.value,callback:function(t){e.$set(e.holeInfo,"value",t)},expression:"holeInfo.value"}},e._l(e.getHoleInfoOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1)],1),a("el-row",{staticClass:"row_item",attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-row",[a("el-col",{attrs:{span:10}},[e._v("计算方式")]),a("el-col",{attrs:{span:14}},[a("el-select",{attrs:{size:"mini"},on:{change:e.computeStyleChange},model:{value:e.computeStyle.value,callback:function(t){e.$set(e.computeStyle,"value",t)},expression:"computeStyle.value"}},e._l(e.computeStyle.options,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-row",[a("el-col",{attrs:{span:10}},[e._v("孔位计算规则:")]),a("el-col",{attrs:{span:14}},[a("el-select",{attrs:{placeholder:"请选择",size:"mini",disabled:""==e.computeStyle.value},model:{value:e.holeRule.value,callback:function(t){e.$set(e.holeRule,"value",t)},expression:"holeRule.value"}},e._l(e.getHoleRuleOptions,(function(t){return a("el-popover",{key:t.value,attrs:{placement:"right","open-delay":300,width:"500",trigger:"hover"}},[a("el-image",{attrs:{src:e.getImage(t)}}),a("el-option",{attrs:{slot:"reference",label:t.label,value:t.value},slot:"reference"})],1)})),1)],1)],1)],1)],1),a("div",{staticClass:"ruleInfo"},[a("el-divider",{attrs:{"content-position":"left"}},[e._v("孔位计算规则信息")]),a("el-row",{staticClass:"row_item",attrs:{gutter:10}},e._l(e.ruleInfoCfg,(function(t,i){return a("el-col",{key:i,attrs:{span:12}},[a("el-row",[a("el-col",{attrs:{span:10}},[e._v(e._s(t.label))]),t.isNumber?a("el-col",{attrs:{span:14}},[a("el-input-number",{attrs:{controls:!1,size:"mini",disabled:t.disabled},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1):a("el-col",{attrs:{span:14}},[a("el-input",{attrs:{placeholder:"请输入内容",size:"mini",disabled:t.disabled},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1)],1)],1)})),1)],1)],1),a("footer",[a("el-button",{attrs:{size:"mini"},on:{click:e.closeHandle}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.confirmHandle}},[e._v("确认")])],1)])])}),B=[],D=(a("d3b7"),a("159b"),a("13d5"),a("4de4"),a("e9c4"),a("dca8"),a("dac6")),L="".concat(D["a"],"/hgsoft_base/holeInfo/"),$=Object(D["b"])("".concat(L,"getHoleInfos")),E=Object(D["b"])("".concat(L,"getHoleCalRules")),F=a("0ef8"),O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"QdSelect"},[a("QdInput",{attrs:{trigger:"click",isNumber:e.isNumber,limit:e.limit,disabled:e.disabled,readonly:e.readonly,isShowInput:e.isShowInput,emptyDefault:e.emptyDefault},on:{blur:e.changeHandle},model:{value:e.getValue,callback:function(t){e.getValue=t},expression:"getValue"}},[e.$slots.label?e._t("label"):a("div",{staticClass:"label_text",staticStyle:{width:"100%",height:"100%"},attrs:{title:e.getLabel()},on:{click:function(){e.readonly&&e.showSelectHandle()}}},[e._v(" "+e._s(e.getLabel())+" ")])],2),a("div",{ref:"iconBox",staticClass:"iconBox",on:{click:e.showSelectHandle}},[a("i",{staticClass:"el-icon-caret-bottom"})]),a("transition",{attrs:{name:"el-zoom-in-top"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.editState,expression:"editState"},{name:"clickoutside",rawName:"v-clickoutside",value:e.blurHandle,expression:"blurHandle"}],ref:"QdSelect",staticClass:"QdSelect_ul",style:e.getStyle,on:{mousewheel:function(e){e.stopPropagation()}}},[0==e.options.length?a("div",{staticClass:"QdSelect_ul_box"},[a("p",{staticClass:"QdSelect_ul_box__empty"},[e._v("无数据")])]):e._e(),a("ul",{staticClass:"QdSelect_ul_box"},e._l(e.getOptions,(function(t,i){return a("li",{key:i,class:{selectClass:e.selectClass(t)},attrs:{title:e.getOptionsLabel(t)},on:{click:function(a){return e.clickHandle(t)}}},[e._v(" "+e._s(e.getOptionsLabel(t))+" ")])})),0)])])],1)},T=[],I=(a("7db0"),a("b680"),a("dd7e")),j={name:"QdSelect",props:{isShowInput:Boolean,row:Object,disabled:Boolean,readonly:Boolean,value:[Number,String],options:{type:Array,default:function(){return[]}},optionKey:"",optionLabel:"",extraKey:"",isNumber:{type:Boolean,default:!1},limit:Array,appendToBody:{type:Boolean,default:!1},emptyDefault:{type:String}},data:function(){return{editState:!1,popperElm:null,top:0,left:0,width:100}},methods:{selectClass:function(e){return this.optionKey?this.row&&this.extraKey&&this.row[this.extraKey]?e[this.optionKey]==this.row[this.extraKey]:e[this.optionKey]==this.getValue:e==this.getValue},getLabel:function(){var e,t,a=this;if(this.optionKey){var i=this.options.find((function(e){return a.row&&a.extraKey&&a.row[a.extraKey]?e[a.optionKey]==a.row[a.extraKey]:e[a.optionKey]==a.getValue}));t=i?i[this.optionLabel]:this.getValue}else t=this.getValue;return isNaN(Number(t))||-1==(null===(e=String(t))||void 0===e?void 0:e.indexOf("."))?t:Number(t).toFixed(1)},getOptionsLabel:function(e){return this.optionLabel?e[this.optionLabel]:e},blurHandle:function(){this.editState=!1},showSelectHandle:function(){this.disabled?this.editState=!1:this.editState=!this.editState},clickHandle:function(e){var t=this;this.getValue=this.optionKey?e[this.optionKey]:e,this.blurHandle(),this.$nextTick((function(){t.changeHandle()}))},resizeHandle:function(){var e=this.$el.getBoundingClientRect();this.width=e.width,this.left=e.left;var t=this.$refs.QdSelect.clientHeight,a=e.top+e.height;this.top=a+t>document.body.clientHeight?e.top-t:a},changeHandle:function(){this.$emit("change",this.row,this.getValue)}},directives:{clickoutside:I["a"]},watch:{editState:function(e){var t=this;e?(window.addEventListener("resize",this.resizeHandle),document.addEventListener("mousewheel",this.blurHandle),this.$nextTick((function(){t.appendToBody&&t.$el.querySelector(".QdSelect_ul")&&document.body.appendChild(t.$el.querySelector(".QdSelect_ul")),t.resizeHandle()}))):(window.removeEventListener("resize",this.resizeHandle),document.removeEventListener("mousewheel",this.blurHandle))}},components:{QdInput:F["a"]},computed:{getOptions:function(){var e=this;return this.optionLabel?this.options.reduce((function(t,a){return t.some((function(t){return t[e.optionLabel]==a[e.optionLabel]}))||t.push(a),t}),[]):this.options},getValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}},getStyle:function(){return{top:"".concat(this.top,"px"),left:"".concat(this.left,"px"),width:"".concat(this.width,"px")}}},mounted:function(){this.popperElm=this.$refs.iconBox},beforeDestroy:function(){this.appendToBody&&this.$refs.QdSelect&&this.$refs.QdSelect.remove()},destroyed:function(){}},P=j,R=(a("395d"),Object(b["a"])(P,O,T,!1,null,"2a09ebbc",null)),X=R.exports,M=a("32e0"),V={name:"holeCfg",data:function(){return{loading:!1,computeStyle:{value:"",options:[]},holeRuleData:[],holeInfoData:[],holeType:"大饼孔",holeFB:{value:"",options:[]},holeSite:{value:""},holeInfo:{value:""},holeRule:{value:"",options:[]},ruleInfoCfg:{calType:{label:"计算方式",value:"",disabled:!0,isNumber:!1},holeNum:{label:"孔数量",value:"",disabled:!0,isNumber:!0},behindBlank:{label:"后留空(固定)",value:"",disabled:!0,isNumber:!0},minBehindBlank:{label:"最小后留空",value:"",disabled:!0,isNumber:!0},frontBlank:{label:"前留空(固定)",value:"",disabled:!0,isNumber:!0},minFrontBlank:{label:"最小前留空",value:"",disabled:!0,isNumber:!0},fixedHoleDistance:{label:"两孔间距(固定)",value:"",disabled:!0,isNumber:!0},holeDistanceMagnification:{label:"两孔间距(倍率)",value:"",disabled:!0,isNumber:!0}},holeInfos:{}}},components:{QdInput:F["a"],QdSelect:X},props:{direct:{type:String,default:"横"}},directives:{drag:M["a"]},methods:{computeStyleChange:function(){this.holeRule.value=""},holeInfoChange:function(e){this.holeRule.value=""},holeTypeChange:function(e){this.holeSite.value="",this.holeInfo.value="",this.computeStyle.value="",this.holeRule.value=""},getImage:function(e){var t=JSON.parse(e.value);return a("2d1e")("./".concat(t.calType,".jpg"))},getdisable:function(e,t){if("FB"==t.prop);else if("gap"==t.prop)return"垂直孔"!=e["holeType"]},closeHandle:function(){this.$emit("close")},confirmHandle:function(){var e=this,t=JSON.parse(this.holeInfo.value||{});t["FB"]=this.holeFB.value,t["gap"]=this.holeSite.value||0;var a=t["associatedMxHole"];a&&this.holeInfos[a]&&(t["木肖孔"]=this.holeInfos[a]);var i={holeType:this.holeType,holeFB:this.holeFB.value,holeSite:this.holeSite.value,holeInfo:t,holeRule:this.holeRule.value,ruleInfoCfg:{}};Object.keys(this.ruleInfoCfg).forEach((function(t){i.ruleInfoCfg[t]=e.ruleInfoCfg[t].value})),this.$bus.$emit("addGroupHole","addHolesByCfg",i),this.$emit("close")}},watch:{"holeRule.value":{handler:function(e,t){var a=this,i=""==e?{}:JSON.parse(e);Object.keys(this.ruleInfoCfg).forEach((function(e){var t;null!==i&&void 0!==i&&i[e]?"calType"==e||"holeNum"==e&&"均分孔"!==i.calType?a.ruleInfoCfg[e].disabled=!0:a.ruleInfoCfg[e].disabled=!1:a.ruleInfoCfg[e].disabled=!0,"均分孔"==(null===i||void 0===i?void 0:i.calType)&&(a.ruleInfoCfg["behindBlank"].disabled=!1,a.ruleInfoCfg["frontBlank"].disabled=!1),a.ruleInfoCfg[e].value=null!==(t=null===i||void 0===i?void 0:i[e])&&void 0!==t?t:""}))}}},computed:{getSiteDisable:function(){return"垂直孔"!=this.holeType},getHoleInfoOptions:function(){var e=this;return this.holeInfoData.filter((function(t){return t.holeType==e.holeType})).reduce((function(e,t){var a={label:null===t||void 0===t?void 0:t.name,value:JSON.stringify(t)};return e.push(a),e}),[])},getHoleRuleOptions:function(){var e=this;return this.holeRuleData.reduce((function(t,a){var i,n;a.calType==e.computeStyle.value&&t.push({label:null!==(i=null===a||void 0===a?void 0:a.expression)&&void 0!==i?i:"",value:null!==(n=JSON.stringify(a))&&void 0!==n?n:""});return t}),[])}},created:function(){var e=this;return Object(S["a"])(Object(H["a"])().mark((function t(){var a,i,n,s,o,r;return Object(H["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,a=localStorage.getItem("loginId"),t.next=4,$({loginId:a});case 4:if(i=t.sent,1==i.state)for(e.holeInfoData=Object.freeze(i.data),n=0;n<(null===(s=i.data)||void 0===s?void 0:s.length);n++)o=i.data[n],e.holeInfos[o.name]=o;else e.$message.error("获取孔位信息失败");return t.next=8,E({loginId:a});case 8:r=t.sent,1==r.state?(e.holeRuleData=Object.freeze(r.data),e.computeStyle.options=e.holeRuleData.reduce((function(e,t){return-1==e.indexOf(null===t||void 0===t?void 0:t.calType)&&e.push(t.calType),e}),[])):e.$message.error("获取孔位计算规则失败"),e.loading=!1;case 11:case"end":return t.stop()}}),t)})))()},mounted:function(){this.holeFB.options="横"==this.direct?[{label:"UFB",value:"UFB"},{label:"DFB",value:"DFB"}]:[{label:"LFB",value:"LFB"},{label:"RFB",value:"RFB"}]}},U=V,z=(a("57d5"),Object(b["a"])(U,A,B,!1,null,"e46515b8",null)),Y=z.exports,G=a("85e5"),K=a("db04"),W={props:{mode:Boolean},data:function(){return{faces:["A","B","L","R","U","D"],floatPanel:{state:!1,info:""},direct:"",holeCfg:{state:!1},state:"0",btnList:[{content:"槽",tip:"开槽",method:this.addHC("C")}],ImgResourceState:!1,ImgResourceType:""}},computed:{isShowAddBtns:function(){return["A","B"].includes(this.state)}},mounted:function(){var e=this;canvas2d.init(this.$refs.canvas),mouse.setCanvas(canvas2d.canvas),bdDecode.jcanvas=new JBDCanvas(bdDecode),bdDecode.jcanvas.init(this.$refs.jcanvas),bdDecode.jcanvas.display(!1),this.$bus.$on("addGroupHole",(function(t,a){if("openAddholeDialog"==t){e.holeCfg.state=!0,e.floatPanel.state=!1;var i=a.direct;e.direct=i}})),this.$bus.$on("closeSelectSlide",(function(){e.floatPanel.state=!1}))},methods:{showSelectEdgeInfo:function(){this.floatPanel.state=!0,this.floatPanel.info="选择板件边"},holeCfgHandle:function(){this.showSelectEdgeInfo(),this.$bus.$emit("addGroupHole","selectSlide")},lineToArcHandle:function(){this.showSelectEdgeInfo(),this.$bus.$emit("lineToArc")},selectFace:function(e){this.state=e,this.$bus.$emit("selectFace",e),"0"===e&&this.$bus.$emit("selectCanvasNode","")},addHC:function(e){var t={V:"增加垂直孔",B:"增加大饼孔","槽":"增加开槽"};this.$bus.$emit("btnClick",{type:t[e]})},importPrimitive:function(){this.ImgResourceState=!0},ImgResourceClose:function(){this.ImgResourceState=!1},ImgResourceSuccess:function(e){var t=this;return Object(S["a"])(Object(H["a"])().mark((function a(){var i,n;return Object(H["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e||!e[0]){a.next=5;break}return a.next=3,Object(K["e"])({key:e[0].sName});case 3:i=a.sent,1===i.result&&(n=i.configdata,t.$bus.$emit("importPathData",n));case 5:t.ImgResourceClose();case 6:case"end":return a.stop()}}),a)})))()},dragenter:function(e){e.stopPropagation(),e.preventDefault()},dragleave:function(e){e.stopPropagation(),e.preventDefault()},dragover:function(e){e.stopPropagation(),e.preventDefault()},fileDrop:function(e){var t=this;return Object(S["a"])(Object(H["a"])().mark((function a(){var i,n,s;return Object(H["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.stopPropagation(),e.preventDefault(),i=e.dataTransfer.files[0],n=getFileType(i.name),"bd"!==n){a.next=9;break}return a.next=7,decodeFile(i);case 7:s=a.sent,t.$bus.$emit("loadXmlData",s,i.name,"bd");case 9:case"end":return a.stop()}}),a)})))()}},components:{ImgResource:G["a"],holeCfg:Y}},Q=W,q=(a("4222"),Object(b["a"])(Q,N,_,!1,null,"7662f962",null)),J=q.exports,Z={props:{mode:Boolean},components:{RightBottomBar:k,Canvas2d:J}},ee=Z,te=(a("d804"),Object(b["a"])(ee,i,n,!1,null,"7a1a4900",null));t["a"]=te.exports},"35da":function(e,t,a){},"384e":function(e,t,a){},"38f3":function(e,t,a){e.exports=a.p+"img/1.jpg"},"395d":function(e,t,a){"use strict";a("e286")},"3aa0":function(e,t,a){e.exports=a.p+"img/靠前对齐.jpg"},"3c09":function(e,t,a){"use strict";a("ec51")},"3de3":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}]},[a("div",{staticClass:"code-main-box"},[a("div",{ref:"cmEditorWarp",staticClass:"codemirror-warp"},[a("codemirror",{ref:"cmEditor",attrs:{options:e.cmOptions},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}})],1),a("footer",[a("el-button",{on:{click:e.close}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")])],1)])])},n=[],s=a("8f94"),o=(a("a7be"),a("d5e0"),{data:function(){return{isShow:!1,code:"",cmOptions:{tabSize:4,mode:"text/xml",lineNumbers:!0,lineWrapping:!0,line:!0}}},computed:{codemirror:function(){return this.$refs.cmEditor.codemirror}},mounted:function(){var e=this;this.$bus.$on("openXMLCode",(function(t){e.isShow=!0,e.code=t}))},methods:{save:function(){this.$bus.$emit("saveXMLCode",this.code),this.close()},close:function(){this.isShow=!1},setValue:function(e){this.codemirror.setValue(e)}},components:{codemirror:s["codemirror"]}}),r=o,c=(a("292a"),a("2877")),l=Object(c["a"])(r,i,n,!1,null,null,null);t["a"]=l.exports},4222:function(e,t,a){"use strict";a("5d57")},"4a36":function(e,t,a){},"4f75":function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return o}));var i=a("b85c");a("b0c0"),a("a15b"),a("d81d"),a("4de4"),a("d3b7"),a("ac1f"),a("466d"),a("caad"),a("2532"),a("99af");function n(e,t,a){var i=parseFormulaXml(e,a),n=r(i);if(n){var s=Object.assign({},i.attr,n.attr);return s.name=t,s.d=l(n.children),c(s,[]),XmlUtil.toXml({node:"Path",attr:s,children:[]})}console.error("x2d数据不完整，没有点弧列表轮廓数据")}function s(e,t){return e.split(";").filter((function(e){return e})).map((function(e){return e.split(",").map((function(e){for(var a=e.split(" "),i=a[0],n=1;n<a.length;n++)i+=" ".concat(calcFormula(a[n],t));return i})).join(",")})).join(";")}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=parseFormulaXml(e,[]);return a.attr.d=s(a.attr.d,[t,a.attr]),a}function r(e){var t,a=Object(i["a"])(e.children);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(n.children.length>0)return n}}catch(s){a.e(s)}finally{a.f()}}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];for(var a in e)(a.match(/^\$+/)||!e[a]&&0!==e[a]&&!1!==e[a])&&delete e[a],t.includes(a)&&delete e[a]}function l(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a="",i=0;i<e.length;i++){var n=e[i].attr;if("Point"===e[i].node?a+=0===i?"m ".concat(n["$X"]," ").concat(n["$Y"],","):"l ".concat(n["$X"]," ").concat(n["$Y"],","):"Arc"===e[i].node?(0===i&&(a+="m ".concat(n["$X"]," ").concat(n["$Y"],",")),a+="a ".concat(n["$X"]," ").concat(n["$Y"]," ").concat(n["$R"]," ").concat(n["$StartAngle"]," ").concat(n["$Angle"],",")):"TArc"===e[i].node&&(0===i&&(a+="m ".concat(n["$X"]," ").concat(n["$Y"],",")),a+="ta ".concat(n["$X"]," ").concat(n["$Y"]," ").concat(n["$X2"]," ").concat(n["$Y2"]," ").concat(n["$ChordH"]," ").concat(n["$IsBulge"],",")),!t&&i===e.length-1){if("Arc"===e[0].node||"Arc"===e[i].node)break;a+="l ".concat(e[0].attr["$X"]," ").concat(e[0].attr["$Y"])}}return a+=";",a}},"526c":function(e,t,a){},5403:function(e,t,a){"use strict";var i=a("20ca"),n=a("eec4"),s=a.n(n),o=function(e,t){var a=100,i=function(){console.log("没有执行方法")};t.value&&(i="function"===typeof t.value?t.value:"function"===typeof t.value.handler?t.value.handler:i,a=parseFloat(t.value.delay)>0?t.value.delay:a),e._v_delay=a,e._v_resize=i};t["a"]={bind:function(e,t){o(e,t),e._v_resize_detector=e._v_resize_detector||s()({strategy:"scroll"}),e._v_resize_detector.listenTo(e,Object(i["a"])((function(t){e._v_resize(e)}),e._v_delay))},update:function(e,t){t.value!==t.oldValue&&(delete e._v_resize,o(e,t))},unbind:function(e,t){e._v_resize_detector.uninstall(e),delete e._v_resize_detector,delete e._v_resize,delete e._v_delay}}},"551b":function(e,t,a){"use strict";t["a"]='<?xml version="1.0" encoding="utf-8"?>\n<Board V="1" L="1000" W="1000" BH="18" CA="" CB="" CC="" CD="" CE="" CF="" CG="" CH="" CI="" CJ="" CK="" CL="" CM="" CN="" CO="" CP="" lengthen="0" type="板件" CncBack="0" planeType="PlaneXY">\n<Graph>\n\t<Point Hotspot="1" IsDim="0" X="554" Y="0"></Point>\n\t<Point Hotspot="1" IsDim="0" Modelling="1" X="0" Y="0"></Point>\n\t<Point X="0" Y="500"></Point>\n\t<Point X="496" Y="500"></Point>\n\t<Point Hotspot="1" IsDim="0" Modelling="1" X="496" Y="W"></Point>\n\t<Point Hotspot="1" IsDim="0" X="500" Y="1000"></Point>\n\t<Point Hotspot="1" IsDim="0" Modelling="1" X="1000" Y="W"></Point>\n\t<Point X="1000" Y="500"></Point>\n\t<Point Hotspot="1" IsDim="0" Modelling="1" X="1000" Y="438"></Point>\n\t<Point X="554" Y="438"></Point>\n</Graph>\n<FaceA></FaceA>\n<FaceB>\n\t<BHole Face="B" HDirect="L" Hole_D="50" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="20" Rb="8" Rbdepth="50" Rdepth="10" Rtype="" X="50" X1="0" X1depth="0" Y="30"></BHole>\n\t<BHole Face="B" HDirect="L" Hole_D="29" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="20" Rb="8" Rbdepth="29" Rdepth="10" Rtype="" X="525" X1="0" X1depth="0" Y="974"></BHole>\n\t<Cut Face="B" Hole_Z="10" X="50" X1="50" Y="50" Y1="450"></Cut>\n\t<Cut Face="B" Hole_Z="10" X="950" X1="950" Y="549" Y1="949"></Cut>\n</FaceB>\n</Board>\n'},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var i=a("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{id:"app",tabindex:"-1","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"},on:{click:e.clickApp}},[a("AppLeft",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"appLeft",attrs:{current:e.current},on:{expandState:e.expandState}}),a("AppRight",{ref:"appRight",attrs:{current:e.current,id:"AppRight",mode:e.mode}})],1)},s=[],o=(a("b0c0"),a("caad"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"AppLeft"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isExpand,expression:"!isExpand"}],staticClass:"leftContent"},[a("div",{staticClass:"app_search"},[a("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}})],1),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"app_ul",on:{contextmenu:function(t){return t.stopPropagation(),t.preventDefault(),e.menuHandle(t)}}},[a("el-tree",{ref:"treeData",attrs:{data:e.data,props:e.defaultProps,"node-key":"sName",accordion:"","show-checkbox":"","filter-node-method":e.filterNode},on:{"node-click":e.doClick,"node-contextmenu":e.menuHandle,check:e.selectChange},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node;return a("span",{staticClass:"custom-tree-node"},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:i.label,placement:"right","open-delay":500}},[a("span",{staticClass:"el-tree-node__label"},[a("i",{class:!i.data.children&&i.isLeaf?"el-icon-document":"el-icon-folder-opened"}),e._v(" "+e._s(i.label)+" ")])])],1)}}])})],1),a("LeftMenu",{ref:"leftMenu",attrs:{current:e.current,selectArray:e.selectArray,treeArray:e.data}})],1),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.isExpand?"展开":"隐藏",placement:"right"}},[a("div",{class:[e.isExpand?"shrink_icon":"expand_btn"],on:{click:e.expandHandle}},[a("i",{class:[e.isExpand?"el-icon-arrow-right":"el-icon-arrow-left"]})])])],1)}),r=[],c=a("2909"),l=a("c7eb"),d=a("1da1"),u=(a("ac1f"),a("841c"),a("4de4"),a("d3b7"),a("e9c4"),a("99af"),a("4e82"),a("d81d"),a("db04")),h=(a("e67d"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"leftMenuDiv"},[a("transition",{attrs:{name:"el-zoom-in-top"}},[e.menu.state?a("ul",{style:e.getStyle,attrs:{id:"QdMenu",tabindex:"-1"},on:{blur:e.blurHandle}},[a("li",{directives:[{name:"show",rawName:"v-show",value:1!=e.menu.type,expression:"menu.type != 1"}],on:{click:function(t){return e.addAndUpdate("add",-1)}}},[e._v(" 新建分组 ")]),a("li",{directives:[{name:"show",rawName:"v-show",value:-1!=e.menu.type,expression:"menu.type != -1"}],on:{click:function(t){return e.addAndUpdate("add",e.menu.type)}}},[e._v(" 新建x2d ")]),a("li",{directives:[{name:"show",rawName:"v-show",value:1==e.menu.type,expression:"menu.type == 1"}],on:{click:function(t){return e.delHandle(0)}}},[e._v("删除")]),a("li",{directives:[{name:"show",rawName:"v-show",value:-1!=e.menu.type,expression:"menu.type != -1"}],on:{click:function(t){return e.addAndUpdate("update")}}},[e._v("重命名")]),a("li",{directives:[{name:"show",rawName:"v-show",value:1==e.menu.type,expression:"menu.type == 1"}],on:{click:function(t){return e.copyHandle(0)}}},[e._v("复制")]),a("li",{directives:[{name:"show",rawName:"v-show",value:1==e.menu.type,expression:"menu.type == 1"}],on:{click:e.pasteHandle}},[e._v("粘贴")]),a("li",{directives:[{name:"show",rawName:"v-show",value:1==e.menu.type,expression:"menu.type == 1"}],on:{click:e.moveHandle}},[e._v("移动")]),a("li",{directives:[{name:"show",rawName:"v-show",value:1==e.menu.type,expression:"menu.type == 1"}],on:{click:e.copyFileName}},[e._v("复制基础图形")]),a("li",{directives:[{name:"show",rawName:"v-show",value:-1!=e.menu.type,expression:"menu.type != -1"}],on:{click:e.uploadGraph}},[e._v("本地x2d上传")]),a("li",{directives:[{name:"show",rawName:"v-show",value:1==e.menu.type,expression:"menu.type == 1"}],on:{click:e.uploadPrimitiveHandle}},[e._v(" 上传为图元 ")])]):e._e()]),a("el-dialog",{attrs:{visible:e.dialog.state,width:"250px","close-on-click-modal":!1,"show-close":!1,top:"35vh"},on:{"update:visible":function(t){return e.$set(e.dialog,"state",t)}},nativeOn:{keyup:function(e){e.stopPropagation()}}},[e._v(" "+e._s(e.dialog.title)+" "),a("el-input",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addAndUpdate("save",e.dialog.saveType)}},model:{value:e.dialog.text,callback:function(t){e.$set(e.dialog,"text",t)},expression:"dialog.text"}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialog.state=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.addAndUpdate("save",e.dialog.saveType)}}},[e._v("确 定")])],1)],1),e.ImgResourceState?a("ImgResource",{attrs:{"on-close":e.ImgResourceClose,"on-success":e.ImgResourceSuccess,type:e.ImgResourceType}}):e._e()],1)}),p=[],f=a("b85c"),m=(a("466d"),a("4d63"),a("2c3e"),a("25f0"),a("159b"),a("5319"),a("2532"),a("a9e3"),"QDBaseGraph"),v={handle:null,store:null,setStore:function(){var e=this.handle.transaction("webStorage","readwrite");this.store=e.objectStore("webStorage")},get:function(e){this.setStore();var t=this.store.get(m);t.addEventListener("success",e)},put:function(e,t){this.setStore();var a=this.store.put({id:m,content:e});a.addEventListener("success",t)}},b=indexedDB.open("QdDatabase",1);b.addEventListener("success",(function(e){console.log("连接数据库成功")})),b.addEventListener("error",(function(e){console.log("连接数据库失败")})),b.addEventListener("upgradeneeded",(function(e){var t=e.target.result;t.createObjectStore("webStorage",{keyPath:"id",autoIncrement:!0});console.log("创建对象仓库成功")})),b.addEventListener("success",(function(e){var t=e.target.result;v.handle=t}));var g=v,y=a("fa7d"),w=a("85e5"),x=a("4f75"),C={name:"QdMenu",props:{current:Object,selectArray:Array,treeArray:Array},data:function(){return{menu:{type:0,state:!1,top:0,left:0},dialog:{type:"",state:!1,text:"",title:"",saveType:""},curNodeName:"",ImgResourceState:!1,ImgResourceType:""}},methods:{nodeMenuHandle:function(e,t){var a=this;t&&(this.curNodeName=t.sName),this.menu.type=t?t.children?0:1:-1,this.menu.state=!0,this.$nextTick((function(){var t=e.pageX,i=e.pageY,n=a.$el.querySelector("#QdMenu");a.menu.left=t+10,a.menu.top=i+n.offsetHeight<document.body.offsetHeight?i:i-n.offsetHeight,a.$el.querySelector("#QdMenu").focus()}))},blurHandle:function(){this.menu.state=!1},addAndUpdate:function(e,t){var a=this;return Object(d["a"])(Object(l["a"])().mark((function i(){var n,s,o,r,c,d,h,p;return Object(l["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if("save"!==e){i.next=63;break}if(n=a.dialog.text,""!==n){i.next=5;break}return a.$message({type:"info",message:"名称不能为空",duration:1e3}),i.abrupt("return");case 5:if("add"!==a.dialog.type){i.next=27;break}if(1==a.menu.type||-1!=t){i.next=10;break}a.treeArray.some((function(e){return e.sName===n}))?a.$message({type:"info",message:"分组名不能重复",duration:1e3}):(a.treeArray.push({sName:n,children:[]}),a.dialog.state=!1),i.next=25;break;case 10:if(-1==a.menu.type||0!=t&&1!=t){i.next=25;break}if(n.match(new RegExp(".x2d"))||(n+=".x2d"),s="",0==t?s=a.curNodeName:a.treeArray.forEach((function(e){e.children.some((function(e){return e.sName==a.curNodeName}))&&(s=e.sName)})),o=!1,a.treeArray.forEach((function(e){e.children.some((function(e){return e.sName==n}))&&(o=!0)})),!o){i.next=20;break}a.$message({type:"info",message:"文件名不能重复",duration:1e3}),i.next=25;break;case 20:return i.next=22,Object(u["b"])({key:n,dataType:"x2d",groupName:s,data:"",type:"add"});case 22:r=i.sent,1===r.state?(0==t?a.treeArray.forEach((function(e){e.sName==s&&e.children.push({sName:n})})):a.treeArray.forEach((function(e){e.children.some((function(e){return e.sName==a.curNodeName}))&&e.children.push({sName:n})})),a.$message({type:"success",message:"添加成功",duration:1e3})):a.$message({type:"error",message:"文件名已存在"==r.info?r.info:"添加失败",duration:1e3}),a.dialog.state=!1;case 25:i.next=61;break;case 27:if("update"!==a.dialog.type){i.next=61;break}if(0!=a.menu.type){i.next=45;break}if(!a.treeArray.some((function(e){return e.sName===n}))){i.next=33;break}a.$message({type:"info",message:"分组名不能重复",duration:1e3}),i.next=43;break;case 33:if(a.curNodeName!=n){i.next=37;break}a.dialog.state=!1,i.next=43;break;case 37:return c=a.treeArray.filter((function(e){return e.sName==a.curNodeName}))[0].children.map((function(e){return e.sName})),i.next=40,Object(u["h"])({data:JSON.stringify([{key:c,groupName:n,dataType:"x2d"}])});case 40:d=i.sent,1===d.result?(a.treeArray.forEach((function(e){e.sName==a.curNodeName&&(e.sName=n)})),a.$message({type:"success",message:"修改成功",duration:1e3})):a.$message({type:"error",message:"修改失败",duration:1e3}),a.dialog.state=!1;case 43:i.next=61;break;case 45:if(n.match(new RegExp(".x2d"))||(n+=".x2d"),h=!1,a.treeArray.forEach((function(e){e.children.some((function(e){return e.sName==n}))&&(h=!0)})),!h){i.next=52;break}a.$message({type:"info",message:"文件名不能重复",duration:1e3}),i.next=61;break;case 52:if(a.curNodeName!=n){i.next=56;break}a.dialog.state=!1,i.next=61;break;case 56:return i.next=58,Object(u["c"])({key:a.curNodeName,newKey:n});case 58:p=i.sent,1===p.result?(Object(u["c"])({key:a.curNodeName.replace(".x2d",".png"),newKey:n.replace(".x2d",".png")}),a.treeArray.forEach((function(e){e.children.forEach((function(e){e.sName==a.curNodeName&&(e.sName=n)}))})),a.$bus.$emit("leftMenuHandle",{type:"x2d重命名",oldName:a.curNodeName.replace(/\.x2d/,""),newName:n.replace(/\.x2d/,"")}),a.$message({type:"success",message:"修改成功",duration:1e3})):a.$message({type:"error",message:"文件名已存在"==p.info?p.info:"修改失败",duration:1e3}),a.dialog.state=!1;case 61:i.next=68;break;case 63:a.dialog.type=e,a.dialog.saveType=t,"add"!=e||-1==a.menu.type||0!=t&&1!=t?"update"==e&&1!=a.menu.type?(a.dialog.title="分组名称",a.dialog.text=a.curNodeName):"update"==e&&1==a.menu.type?(a.dialog.title="文件名称",a.dialog.text=a.curNodeName.substring(0,a.curNodeName.indexOf("."))):(a.dialog.title="分组名称",a.dialog.text=""):(a.dialog.title="文件名称",a.dialog.text=""),a.dialog.state=!0,a.$nextTick((function(){return a.$el.querySelector(".el-dialog__wrapper .el-input__inner").focus()}));case 68:case"end":return i.stop()}}),i)})))()},delHandle:function(e){var t=this;this.$confirm("是否确认删除文件?","",{type:"warning",showClose:!1}).then(Object(d["a"])(Object(l["a"])().mark((function e(){var a,i,n;return Object(l["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t.getCheckedArr(),i=a.map((function(e){return e.replace(".x2d",".png")})),e.next=4,Object(u["d"])({key:JSON.stringify([].concat(Object(c["a"])(a),Object(c["a"])(i)))});case 4:n=e.sent,1===n.result?(t.getParent.data.forEach((function(e){e.children=e.children.filter((function(e){return!t.getCheckedArr().includes(e.sName)}))})),t.getParent.clearHandle(),t.$nextTick((function(){t.$message({type:"success",message:"删除成功",duration:1e3}),t.$bus.$emit("saveXMLCode","")}))):t.$message({type:"error",message:"删除失败",duration:1e3});case 6:case"end":return e.stop()}}),e)})))).catch((function(e){}))},copyHandle:function(e){var t=this;return Object(d["a"])(Object(l["a"])().mark((function a(){var i,n;return Object(l["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(1!=e||0!=t.selectArray.length){a.next=4;break}t.$message({type:"info",message:"请选择要复制的文件",duration:1e3}),a.next=10;break;case 4:return t.blurHandle(),i=0==e?t.curNodeName:t.selectArray[0].sName,a.next=8,Object(u["e"])({key:i});case 8:n=a.sent,1===n.result&&n.configdata?g.put(n.configdata,(function(){t.$message({type:"success",message:"复制成功",duration:1e3})})):t.$message({type:"error",message:"复制失败",duration:1e3});case 10:case"end":return a.stop()}}),a)})))()},pasteHandle:function(){var e=this;0==this.selectArray.length?this.$message({type:"info",message:"请选择要粘贴的文件",duration:1e3}):(this.blurHandle(),g.get((function(t){t.target.result&&t.target.result.content?(e.$bus.$emit("saveXMLCode",t.target.result.content),e.$message({type:"success",message:"粘贴成功",duration:1e3})):e.$message({type:"error",message:"暂无粘贴数据",duration:1e3})})))},copyFileName:function(){var e=this;return Object(d["a"])(Object(l["a"])().mark((function t(){var a,i,n,s,o;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.blurHandle(),t.next=3,Object(u["e"])({key:e.curNodeName});case 3:if(a=t.sent,i={"文件名":e.curNodeName,"变量":{}},1===a.result&&a.configdata)for(s in n=XmlUtil.toJson(a.configdata)[0],n.attr)o=n.attr[s],isNumber(o)&&Number(o)&&(i.变量[s]=o);Object(y["a"])(JSON.stringify(i)),e.$message({type:"success",message:"复制基础图形成功",duration:1e3});case 8:case"end":return t.stop()}}),t)})))()},uploadGraph:function(){var e=this;readTextFiles({fileType:"x2d",encoding:"utf-8"}).then((function(t){var a=t.map((function(e){if(e.value)return{key:e.name,dataType:"x2d",data:e.value}})).filter((function(e){return e}));e.uploadHandle(a)}))},uploadHandle:function(e){var t=this;return Object(d["a"])(Object(l["a"])().mark((function a(){var i,n,s;return Object(l["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(i=!1,e.forEach((function(e){t.treeArray.forEach((function(t){t.children.some((function(t){return t.sName==e.key}))&&(i=!0)}))})),!i){a.next=6;break}t.$message({type:"info",message:"存在同名文件",duration:1e3}),a.next=14;break;case 6:return t.$parent.loading=!0,n="",0==t.menu.type?n=t.curNodeName:t.treeArray.forEach((function(e){e.children.some((function(e){return e.sName==t.curNodeName}))&&(n=e.sName)})),e.forEach((function(e){return e["groupName"]=n})),a.next=12,Object(u["a"])({data:JSON.stringify(e)});case 12:s=a.sent,1===s.result?(t.treeArray.forEach((function(t){t.sName==n&&e.forEach((function(e){t.children.push({sName:e.key,dataType:e.dataType})}))})),t.$message({type:"success",message:"上传成功",duration:1e3}),t.$parent.loading=!1):(t.$message({type:"error",message:"文件名已存在"==s.info?s.info:"上传失败",duration:1e3}),t.$parent.loading=!1);case 14:case"end":return a.stop()}}),a)})))()},moveHandle:function(){this.ImgResourceType="move",this.ImgResourceState=!0,this.blurHandle()},getCheckedArr:function(){var e=0==this.$parent.checkBoxArr.length?[this.curNodeName]:Object(c["a"])(this.$parent.checkBoxArr);return e},ImgResourceClose:function(){this.ImgResourceState=!1},ImgResourceSuccess:function(e){var t=this;return Object(d["a"])(Object(l["a"])().mark((function a(){var i;return Object(l["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.ImgResourceClose(),""==e){a.next=11;break}if("move"!=t.ImgResourceType){a.next=10;break}return t.$parent.loading=!0,a.next=6,Object(u["h"])({data:JSON.stringify([{key:t.getCheckedArr(),groupName:e,dataType:"x2d"}])});case 6:i=a.sent,1===i.result?(0==t.$parent.checkBoxArr.length?(t.treeArray.forEach((function(e){e.children=e.children.filter((function(e){return e.sName!=t.curNodeName}))})),t.treeArray.forEach((function(a){a.sName==e&&a.children.push({sName:t.curNodeName,dataType:"x2d"})}))):(t.treeArray.forEach((function(e){t.$parent.checkBoxArr.forEach((function(t){e.children=e.children.filter((function(e){return e.sName!=t}))}))})),t.treeArray.forEach((function(a){a.sName==e&&t.$parent.checkBoxArr.forEach((function(e){a.children.push({sName:e,dataType:"x2d"})}))}))),t.$message({type:"success",message:"移动成功",duration:1e3}),t.$parent.loading=!1):(t.$message({type:"error",message:"移动失败",duration:1e3}),t.$parent.loading=!1),a.next=11;break;case 10:"upload"==t.ImgResourceType&&t.uploadPrimitive(e);case 11:case"end":return a.stop()}}),a)})))()},uploadPrimitiveHandle:function(){this.ImgResourceType="upload",this.ImgResourceState=!0,this.blurHandle()},uploadPrimitive:function(e){var t=this;return Object(d["a"])(Object(l["a"])().mark((function a(){var i,n,s,o,r,c,d,h,p;return Object(l["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(i=t.getCheckedArr()||[],!(i.length>0)){a.next=33;break}n=Object(f["a"])(i),a.prev=3,n.s();case 5:if((s=n.n()).done){a.next=23;break}return o=s.value,a.next=9,Object(u["e"])({key:o});case 9:if(r=a.sent,1!==r.result||!r.configdata){a.next=20;break}return c=x["b"](r.configdata,o),d=(o.replace(/\.x2d/,"")||"")+".path",h={key:d,dataType:"path",data:c,groupName:e},a.next=16,Object(u["a"])({data:JSON.stringify([h])});case 16:p=a.sent,1===p.result?t.$message({type:"success",message:"".concat(o,"上传为图元成功"),duration:1e3}):t.$message({type:"error",message:"文件名已存在"==p.info?p.info:"".concat(o,"上传为图元失败"),duration:1e3}),a.next=21;break;case 20:t.$message({type:"error",message:"".concat(o,"未获取到x2d数据"),duration:1e3});case 21:a.next=5;break;case 23:a.next=28;break;case 25:a.prev=25,a.t0=a["catch"](3),n.e(a.t0);case 28:return a.prev=28,n.f(),a.finish(28);case 31:a.next=34;break;case 33:t.$message({type:"info",message:"请选择x2d",duration:1e3});case 34:case"end":return a.stop()}}),a,null,[[3,25,28,31]])})))()}},computed:{getParent:function(){return this.$parent},getStyle:function(){var e=this.menu,t=e.top,a=e.left;return{top:"".concat(t,"px"),left:"".concat(a,"px")}}},created:function(){var e=this;this.$bus.$on("menuHandle",(function(t){switch(t){case"copy":return e.copyHandle(1);case"paste":return e.pasteHandle();case"del":return e.delHandle(1)}}))},components:{ImgResource:w["a"]}},k=C,N=(a("3233"),a("2877")),_=Object(N["a"])(k,h,p,!1,null,"008b933c",null),H=_.exports,S=a("c32a"),A={name:"AppLeft",props:["current"],data:function(){return{data:[],defaultProps:{children:"children",label:"sName"},selectArray:[],loading:!0,isExpand:!1,checkBoxArr:[],filterText:"",nodeKey:"",x2dchange:!1}},methods:{searchHandle:function(){this.search.confirm=this.search.input},menuHandle:function(e,t){this.$refs.leftMenu.nodeMenuHandle(e,t)},clickHandle:function(e,t){var a=this;return Object(d["a"])(Object(l["a"])().mark((function i(){return Object(l["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:a.x2dchange?a.$confirm("是否确认保存?","",{type:"warning",showClose:!1}).then(Object(d["a"])(Object(l["a"])().mark((function i(){return Object(l["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:a.$bus.$emit("saveX2d"),a.getData(e,t);case 2:case"end":return i.stop()}}),i)})))).catch((function(){a.getData(e,t)})):a.getData(e,t);case 1:case"end":return i.stop()}}),i)})))()},doClick:function(e,t,a){e.children?this.$refs.treeData.setCurrentKey(this.nodeKey):(e.sName!=this.nodeKey&&this.clickHandle(a,e),this.nodeKey=t.key)},clearHandle:function(){this.selectArray=[],this.$bus.$emit("setCurrent",null),this.$bus.$emit("setRightHandle","Textarea","")},expandHandle:function(){this.isExpand=!this.isExpand,this.$emit("expandState",!this.isExpand)},filterNode:function(e,t){return!e||-1!==t.sName.indexOf(e)},selectChange:function(e,t){this.checkBoxArr=Object(c["a"])(this.$refs.treeData.getCheckedKeys(!0))},getData:function(e,t){var a=this;return Object(d["a"])(Object(l["a"])().mark((function i(){var n;return Object(l["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return a.$bus.$emit("setRightHandle","Loading",!0),e&&a.selectRowHandleMethods(e,a.getFilter,a.selectArray,t),i.next=4,Object(u["e"])({key:t.sName});case 4:n=i.sent,1===n.result?a.$bus.$emit("setCurrent",{data:n.configdata,sName:t.sName,dataType:n.dataType,groupName:n.groupName}):a.$message({type:"error",message:"请求服务器失败",duration:1e3}),a.$nextTick((function(){return a.$bus.$emit("setRightHandle","Loading",!1)})),a.x2dchange=!1;case 8:case"end":return i.stop()}}),i)})))()}},watch:{filterText:function(e){this.$refs.treeData.filter(e)}},components:{LeftMenu:H},created:function(){var e=this;return Object(d["a"])(Object(l["a"])().mark((function t(){var a,i,n;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!1,t.abrupt("return");case 5:if(a=t.sent,1===a.result){for(i in a.data["默认"]=[].concat(Object(c["a"])(a.data[""]||[]),Object(c["a"])(a.data["默认"]||[])),delete a.data[""],a.data)n={sName:i,children:a.data[i].map((function(e){return{sName:e.key,dataType:e.dataType}})).sort(Object(S["a"])("sName"))},e.data.push(n);e.data.sort(Object(S["a"])("sName"))}else 0===a.result?e.data=[]:e.$message({type:"error",message:"请求服务器失败",duration:1e3});e.$nextTick((function(){e.loading=!1})),e.$bus.$on("x2dchange",(function(t){e.x2dchange=t}));case 9:case"end":return t.stop()}}),t)})))()},mounted:function(){}},B=A,D=(a("ad4b"),Object(N["a"])(B,o,r,!1,null,"072324f2",null)),L=D.exports,$=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"},{name:"resize",rawName:"v-resize",value:e.resizefn,expression:"resizefn"}],attrs:{id:"AppRight","element-loading-text":"数据加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[a("TopBar",{ref:"topBar",staticClass:"top-bar",attrs:{sName:e.sName,mode:e.mode,isFromHome:e.isFromHome,otherFrameBtn:e.otherFrameBtn,fromHomeFile:e.fromHomeFile,originFileName:e.originFileName,isBanBtn:e.isBanBtn}}),a("div",{staticClass:"main-box"},[a("LeftMenu",{directives:[{name:"show",rawName:"v-show",value:e.mode,expression:"mode"}],ref:"left",staticClass:"left-menu",attrs:{data:e.dataList,attrs:e.boardAttr,view:e.viewState,face_a:e.dataList.FaceA,face_b:e.dataList.FaceB,isFromHome:e.isFromHome},on:{"show-attr":e.showAttr,"show-menu":e.showHoleCutMenu,"select-node":e.seletcNode,draw:e.updateAllNode}}),a("Right",{staticClass:"right-part",attrs:{mode:e.mode}}),a("div",{staticClass:"inputs"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.showEditInput,expression:"showEditInput"}],attrs:{id:"setInput"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.editHc.value,expression:"editHc.value"}],staticClass:"input-item",attrs:{type:"text"},domProps:{value:e.editHc.value},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.setInputValue(t)},input:function(t){t.target.composing||e.$set(e.editHc,"value",t.target.value)}}})]),a("div",{staticClass:"input-box"},[a("input",{directives:[{name:"show",rawName:"v-show",value:e.editInput.edit1.show,expression:"editInput.edit1.show"},{name:"model",rawName:"v-model",value:e.showEdit1Data,expression:"showEdit1Data"}],staticClass:"item input-item",attrs:{type:"text",id:"edit1"},domProps:{value:e.showEdit1Data},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.setInputValue2("edit1")},input:function(t){t.target.composing||(e.showEdit1Data=t.target.value)}}}),a("input",{directives:[{name:"show",rawName:"v-show",value:e.editInput.edit2.show,expression:"editInput.edit2.show"},{name:"model",rawName:"v-model",value:e.showEdit2Data,expression:"showEdit2Data"}],staticClass:"item input-item",attrs:{type:"text",id:"edit2"},domProps:{value:e.showEdit2Data},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.setInputValue2("edit2")},input:function(t){t.target.composing||(e.showEdit2Data=t.target.value)}}})])]),a("XmlCode",{staticClass:"xml-code"})],1),e.showAttrEdit?a("Attredit",{attrs:{datas:e.curNode,type:e.curEditType,attrs:e.boardAttr,title:e.attreditTitle,face:e.curFace},on:{close:e.hideAttr}}):e._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showMenu.hc,expression:"showMenu.hc"}],staticClass:"right-menu",attrs:{id:"hcMenu"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.menuItemShow.hc.toFaceA,expression:"menuItemShow.hc.toFaceA"}],staticClass:"item",on:{click:e.moveToFaceA}},[e._v(" 移为A面 ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.menuItemShow.hc.toFaceB,expression:"menuItemShow.hc.toFaceB"}],staticClass:"item",on:{click:e.moveToFaceB}},[e._v(" 移为B面 ")]),a("div",{staticClass:"item",on:{click:e.copyToOtherFace}},[e._v("拷贝到另一面")]),a("div",{staticClass:"item",on:{click:function(t){return e.deleteHC(-1)}}},[e._v("删除")]),a("div",{staticClass:"item",on:{click:function(t){return e.moveInFace("up")}}},[e._v("上移")]),a("div",{staticClass:"item",on:{click:function(t){return e.moveInFace("down")}}},[e._v("下移")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showMenu.point,expression:"showMenu.point"}],staticClass:"right-menu",class:{banclick:e.isBanPointMenu},attrs:{id:"pointMenu"}},e._l(e.rightPointMenuList,(function(t){return a("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"item.show"}],key:t.label,staticClass:"item",on:{click:function(e){return t.method.apply(t,t.args)}}},[e._v(" "+e._s(t.label)+" ")])})),0),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showMenu.editAttr,expression:"showMenu.editAttr"}],staticClass:"right-menu",attrs:{id:"editAttr"}},[a("div",{staticClass:"item",on:{click:e.ediltNodeAttr}},[e._v("属性编辑")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showMenu.holeGroup,expression:"showMenu.holeGroup"}],staticClass:"right-menu",attrs:{id:"holeGroup"}},[a("div",{staticClass:"item",on:{click:function(t){return e.holeGroupRightMenu("copy")}}},[e._v("复制")]),a("div",{staticClass:"item",on:{click:function(t){return e.holeGroupRightMenu("stick")}}},[e._v("粘贴")]),a("div",{staticClass:"item",on:{click:function(t){return e.holeGroupRightMenu("group")}}},[e._v("成组")]),a("div",{staticClass:"item",on:{click:function(t){return e.holeGroupRightMenu("ungroup")}}},[e._v("解组")]),a("div",{staticClass:"item",on:{click:function(t){return e.holeGroupRightMenu("delete")}}},[e._v("删除")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showMenu.lineToTArc,expression:"showMenu.lineToTArc"}],staticClass:"right-menu",attrs:{id:"lineToTArcMenu"}},[a("div",{staticClass:"item",on:{click:function(t){return e.lineToTArc("1")}}},[e._v("转为外凸弧")]),a("div",{staticClass:"item",on:{click:function(t){return e.lineToTArc("0")}}},[e._v("转为内凹弧")])]),a("Dialog"),e.ImgResourceState?a("imgSource",{attrs:{type:e.dialogType},on:{onClose:e.ImgResourceClose,onSuccess:e.ImgResourceSuccess}}):e._e(),a("el-dialog",{attrs:{title:"参数设置",visible:e.dialogFormVisible,width:"300px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"外凸弧"===e.formType||"内凹弧"===e.formType,expression:"formType === '外凸弧' || formType === '内凹弧'"}],attrs:{label:"圆弧半径"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.radius,callback:function(t){e.$set(e.form,"radius",t)},expression:"form.radius"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"斜线"===e.formType||"直角"===e.formType,expression:"formType === '斜线' || formType === '直角'"}],attrs:{label:"水平距离"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.width,callback:function(t){e.$set(e.form,"width",t)},expression:"form.width"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"斜线"===e.formType||"直角"===e.formType,expression:"formType === '斜线' || formType === '直角'"}],attrs:{label:"垂直距离"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.height,callback:function(t){e.$set(e.form,"height",t)},expression:"form.height"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.transformPoint}},[e._v("确 定")])],1)],1),e.dialogVisible_line2arc.LineToArc?a("LineToArc",{attrs:{method:e.dialogVisible_line2arc.method,isBulge:e.dialogVisible_line2arc.isBulge,chordH:e.dialogVisible_line2arc.chordH},on:{close:function(t){e.dialogVisible_line2arc.LineToArc=!1},confirm:e.transformSelectLineToTArc}}):e._e()],1)},E=[],F=a("bc9c"),O=F["a"],T=(a("dd71"),Object(N["a"])(O,$,E,!1,null,"7acea3eb",null)),I=T.exports,j=a("dac6"),P=a("1d74"),R={name:"App",data:function(){return{current:null,isLeftExpand:!0,mode:!1,fullscreenLoading:!1}},watch:{},computed:{},methods:{setCurrent:function(e){this.current=e},keyHandle:function(e){46==e.keyCode||e.ctrlKey&&67===e.keyCode||e.ctrlKey&&86===e.keyCode||(e.ctrlKey&&90===e.keyCode?this.$bus.$emit("keyboardHandle","cancel"):e.ctrlKey&&89===e.keyCode?this.$bus.$emit("keyboardHandle","recover"):e.ctrlKey&&81===e.keyCode&&this.$bus.$emit("editXMLCode"))},expandState:function(e){this.isLeftExpand=e,this.canvasResize()},canvasResize:function(){var e=this;this.$nextTick((function(){var t=e.$children[0].$el;e.$bus.$emit("canvasResize",{w:t.offsetWidth,h:t.offsetHeight})}))},clickApp:function(e){this.$bus.$emit("clickApp",e)}},components:{AppLeft:L,AppRight:I},created:function(){var e,t,a,i,n,s,o=this,r=Object(P["a"])(),c=null!==(e=null===(t=window)||void 0===t||null===(a=t.opener)||void 0===a?void 0:a.name)&&void 0!==e?e:"";if(j["c"]||1==(null===r||void 0===r?void 0:r.mode)||"qd_window_personCenter"==(null===(i=window)||void 0===i||null===(n=i.parent)||void 0===n?void 0:n.name)||["FileLib","qd_window_home"].includes(c));else if(null!==(s=window)&&void 0!==s&&s.opener&&["tab_数据处理中心主页面_iframe","qd_window_bom","qd_window_bom3","kailiao"].includes(c)){var l={"tab_数据处理中心主页面_iframe":["源代码"],qd_window_bom:["源代码"],qd_window_bom3:["源代码"],kailiao:["源代码"]};this.$nextTick((function(){o.$refs.appRight.otherFrameBtn=null===l||void 0===l?void 0:l[c]}))}this.mode=!0,this.$bus.$on("setCurrent",this.setCurrent),this.canvasResize()},mounted:function(){var e=this;document.addEventListener("keydown",(function(e){83===e.keyCode&&e.ctrlKey&&e.preventDefault()})),document.addEventListener("keyup",(function(t){e.keyHandle(t)})),document.oncontextmenu=function(){return!1},window.addEventListener("resize",this.canvasResize)}},X=R,M=(a("2e6a"),a("d320"),Object(N["a"])(X,n,s,!1,null,"94c2ab92",null)),V=M.exports,U=(a("eca7"),a("450d"),a("3787")),z=a.n(U),Y=(a("425f"),a("4105")),G=a.n(Y),K=(a("e3ea"),a("7bc3")),W=a.n(K),Q=(a("5466"),a("ecdf")),q=a.n(Q),J=(a("38a0"),a("ad41")),Z=a.n(J),ee=(a("06f1"),a("6ac9")),te=a.n(ee),ae=(a("2986"),a("14e9")),ie=a.n(ae),ne=(a("560b"),a("dcdc")),se=a.n(ne),oe=(a("e612"),a("dd87")),re=a.n(oe),ce=(a("075a"),a("72aa")),le=a.n(ce),de=(a("5e32"),a("6721")),ue=a.n(de),he=(a("b5d8"),a("f494")),pe=a.n(he),fe=(a("6611"),a("e772")),me=a.n(fe),ve=(a("1f1a"),a("4e4b")),be=a.n(ve),ge=(a("3c52"),a("0d7b")),ye=a.n(ge),we=(a("fe07"),a("6ac5")),xe=a.n(we),Ce=(a("bd49"),a("18ff")),ke=a.n(Ce),Ne=(a("960d"),a("defb")),_e=a.n(Ne),He=(a("cb70"),a("b370")),Se=a.n(He),Ae=(a("0c67"),a("299c")),Be=a.n(Ae),De=(a("6b30"),a("c284")),Le=a.n(De),$e=(a("a7cc"),a("df33")),Ee=a.n($e),Fe=(a("be4f"),a("896a")),Oe=a.n(Fe),Te=(a("9d4c"),a("e450")),Ie=a.n(Te),je=(a("10cb"),a("f3ad")),Pe=a.n(je),Re=(a("f4f9"),a("c2cc")),Xe=a.n(Re),Me=(a("7a0f"),a("0f6c")),Ve=a.n(Me),Ue=(a("acb6"),a("c673")),ze=a.n(Ue),Ye=(a("1951"),a("eedf")),Ge=a.n(Ye),Ke=(a("9e1f"),a("6ed5")),We=a.n(Ke),Qe=(a("0fb7"),a("f529")),qe=a.n(Qe),Je={install:function(e){e.prototype.$message=qe.a,e.prototype.$confirm=We.a.confirm,e.prototype.$alert=We.a.alert,e.prototype.$prompt=We.a.prompt,e.use(Ge.a),e.use(ze.a),e.use(Ve.a),e.use(Xe.a),e.use(Pe.a),e.use(Ie.a),e.use(Oe.a),e.use(Ee.a),e.use(Le.a),e.use(Be.a),e.use(Se.a),e.use(_e.a),e.use(ke.a),e.use(xe.a),e.use(ye.a),e.use(be.a),e.use(me.a),e.use(pe.a),e.use(ue.a),e.use(le.a),e.use(re.a),e.use(se.a),e.use(ie.a),e.use(te.a),e.use(Z.a),e.use(q.a),e.use(W.a),e.use(G.a),e.use(z.a)}},Ze=Je,et=a("8f94"),tt=a.n(et);a("a7be"),a("bee2"),a("d4ec");window["math2d"]=Math2d,window["mat2d"]=Mat2d,console.log("xxx");var at=Object(y["b"])();i["default"].use(Ze),i["default"].use(tt.a),i["default"].config.devtools=!0,i["default"].prototype.$vuex=i["default"].observable({parentpagename:""}),i["default"].prototype.$bus=new i["default"],i["default"].prototype.$gData={qdsoftId:at};var it=new i["default"]({el:"#app",render:function(e){return e(V)}});window.UIAction={loadBd:function(e){it.$bus.$emit("loadBd",e)}}},"57d5":function(e,t,a){"use strict";a("d287")},"5b96":function(e,t,a){},"5c5a":function(e,t,a){"use strict";a("eb89")},"5d57":function(e,t,a){},"5f0f":function(e,t,a){"use strict";a("2940")},6161:function(e,t,a){e.exports=a.p+"img/前后端等距.jpg"},"6c03":function(e,t,a){"use strict";a("b8e5")},"83a5":function(e,t,a){"use strict";a("35da")},"85e5":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"bg",attrs:{tabindex:"-1"},on:{keyup:function(t){return t.stopPropagation(),e.keyHandle(t)}}},[a("transition",{attrs:{name:"fade"}},[e.fadeState?a("div",{staticClass:"imgUpload__box"},[a("div",{staticClass:"imgUpload__box-header"},[e._v(" "+e._s("manage"==e.type?"管理图元":"选择分组")+" "),a("i",{staticClass:"el-icon-close",on:{click:e.closeHandle}})]),a("div",{staticClass:"imgUpload__box-content"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.tree.loading,expression:"tree.loading"}],staticClass:"imgUpload__tree"},[a("div",{staticClass:"imgUpload-search"},[a("el-input",{attrs:{placeholder:"请输入目录",clearable:""},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchHandle("tree")}},model:{value:e.tree.inputText,callback:function(t){e.$set(e.tree,"inputText",t)},expression:"tree.inputText"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){return e.searchHandle("tree")}},slot:"append"})],1)],1),a("div",{staticClass:"imgUpload__tree-box",on:{contextmenu:function(t){return t.stopPropagation(),t.preventDefault(),e.menuHandle(t,null,null,null,1)}}},[a("el-tree",{ref:"tree",attrs:{data:e.tree.data,props:e.tree.defaultProps,"node-key":"sName",accordion:"","expand-on-click-node":!1,"filter-node-method":e.filterNode},on:{"node-click":e.nodeClickHandle,"node-contextmenu":e.menuHandle},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node;return a("span",{staticClass:"custom-tree-node"},[a("span",{staticClass:"el-tree-node__label"},[a("i",{staticClass:"el-icon-folder-opened"}),e._v(" "+e._s(i.label)+" ")])])}}],null,!1,1102169073)})],1)]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.list.loading,expression:"list.loading"}],staticClass:"imgUpload__list"},[a("div",{staticClass:"imgUpload-search"},[a("el-input",{attrs:{placeholder:"请输入文件名",clearable:""},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchHandle("list")}},model:{value:e.list.inputText,callback:function(t){e.$set(e.list,"inputText",t)},expression:"list.inputText"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){return e.searchHandle("list")}},slot:"append"})],1)],1),a("div",{staticClass:"imgUpload__list-box",on:{contextmenu:function(t){t.stopPropagation(),t.preventDefault(),"manage"==e.type&&e.menuHandle(t,null,null,null,2)}}},[a("ul",e._l(e.getListData,(function(t){return a("li",{key:t.id,class:{selectClass:e.list.selectArray.includes(t)},on:{click:function(a){return e.clickHandle(t,a)},contextmenu:function(a){return a.stopPropagation(),a.preventDefault(),e.menuHandle(a,t,null,null,4)}}},[a("el-tooltip",{attrs:{placement:"bottom-start","visible-arrow":!1,"open-delay":1e3,offset:-5,"popper-class":"popperClass"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("div",[e._v(" "+e._s(t.sName)+" ")])]),a("div",[a("div",{ref:t.sName,refInFor:!0,staticClass:"imgUpload__box-img"}),a("div",{staticClass:"imgUpload__box-title"},["manage"==e.type?a("el-checkbox",{model:{value:t.checked,callback:function(a){e.$set(t,"checked",a)},expression:"item.checked"}}):e._e(),e._v(e._s(t.sName)+" ")],1)])])],1)})),0)])])]),a("div",{staticClass:"imgUpload__box-btns"},[a("el-button",{attrs:{size:"mini"},on:{click:e.closeHandle}},[e._v("取消")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.saveHandle}},[e._v("确定")])],1)]):e._e()]),a("ImgMenu",{ref:"imgMenu",attrs:{treeArray:e.tree.data}})],1)},n=[],s=a("c7eb"),o=a("1da1"),r=(a("d81d"),a("e9c4"),a("4e82"),a("4de4"),a("d3b7"),a("159b"),a("a434"),a("caad"),a("2532"),a("db04"));a("13d5"),a("a630"),a("3ca3"),a("b0c0");var c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"leftMenuDiv"},[a("transition",{attrs:{name:"el-zoom-in-top"}},[e.menu.state?a("ul",{style:e.getStyle,attrs:{id:"QdMenu",tabindex:"-1"},on:{blur:e.blurHandle}},[a("li",{directives:[{name:"show",rawName:"v-show",value:1==e.menu.type||3==e.menu.type,expression:"menu.type == 1 || menu.type == 3"}],on:{click:e.addHandle}},[e._v(" 新建分组 ")]),a("li",{directives:[{name:"show",rawName:"v-show",value:4==e.menu.type,expression:"menu.type == 4"}],on:{click:e.delHandle}},[e._v("删除")]),a("li",{directives:[{name:"show",rawName:"v-show",value:(3==e.menu.type||4==e.menu.type)&&"manage"==e.$parent.type,expression:"\n          (menu.type == 3 || menu.type == 4) && $parent.type == 'manage'\n        "}],on:{click:e.updateHandle}},[e._v(" 重命名 ")]),a("li",{directives:[{name:"show",rawName:"v-show",value:4==e.menu.type,expression:"menu.type == 4"}],on:{mouseenter:function(t){e.groupListState=!0},mouseleave:function(t){e.groupListState=!1}}},[e._v(" 移动"),a("i",{staticClass:"el-icon-arrow-right"}),a("transition",{attrs:{name:"el-zoom-in-top"}},[e.groupListState?a("ul",{staticClass:"groupList",style:e.getStyle1},[a("p",{staticStyle:{background:"#f2faff","text-align":"center"}},[e._v("分组名:")]),e._l(e.treeArray.filter((function(t){return t.sName!=e.getParent.curPath})),(function(t){return a("li",{key:t.sName,on:{click:function(a){return e.moveHandle(t.sName)}}},[e._v(" "+e._s(t.sName)+" ")])}))],2):e._e()])],1)]):e._e()]),a("el-dialog",{attrs:{visible:e.dialog.state,width:"250px","close-on-click-modal":!1,"modal-append-to-body":!1,top:"35vh","show-close":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"state",t)}},nativeOn:{keyup:function(e){e.stopPropagation()}}},[e._v(" "+e._s(e.dialog.title)+" "),a("el-input",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.saveHandle(t)}},model:{value:e.dialog.text,callback:function(t){e.$set(e.dialog,"text",t)},expression:"dialog.text"}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialog.state=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.saveHandle}},[e._v("确 定")])],1)],1)],1)},l=[],d=(a("ac1f"),a("466d"),a("4d63"),a("2c3e"),a("25f0"),{name:"QdMenu",props:{treeArray:Array},data:function(){return{menu:{type:0,state:!1,top:0,left:0},dialog:{type:"",state:!1,text:"",title:"",saveType:""},curNodeName:"",ImgResourceState:!1,ImgResourceType:"",groupListState:!1}},methods:{nodeMenuHandle:function(e,t,a){var i=this;t&&(this.curNodeName=t.sName),this.menu.type=a,this.menu.state=!0,this.$nextTick((function(){var t=e.pageX,a=e.pageY,n=i.$el.querySelector("#QdMenu");i.menu.left=t+10,i.menu.top=a+n.offsetHeight<document.body.offsetHeight?a:a-n.offsetHeight,i.$el.querySelector("#QdMenu").focus()}))},blurHandle:function(){this.groupListState=!1,this.menu.state=!1},delHandle:function(){var e=this,t=[];this.getParent.list.data.forEach((function(e){return e.checked&&t.push(e.sName)})),0==t.length&&t.push(this.curNodeName),this.$confirm("是否确认删除?","",{type:"warning",showClose:!1}).then(Object(o["a"])(Object(s["a"])().mark((function a(){var i;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(r["d"])({key:JSON.stringify(t)});case 2:i=a.sent,1===i.result?(t.forEach((function(t){e.getParent.list.data=e.getParent.list.data.filter((function(e){return e.sName!=t}))})),e.getParent.list.selectArray.splice(0),e.$nextTick((function(){e.$message({type:"success",message:"删除成功",duration:1e3})}))):e.$message({type:"error",message:"删除失败",duration:1e3});case 4:case"end":return a.stop()}}),a)})))).catch((function(e){}))},addHandle:function(){var e=this;2!=this.menu.type||this.getParent.curPath?(this.dialog.text="",this.dialog.title=1==this.menu.type||3==this.menu.type?"分组名称":"文件名称",this.dialog.state=!0,this.dialog.type="add",this.$nextTick((function(){return e.$el.querySelector(".el-dialog__wrapper .el-input__inner").focus()}))):this.$message({type:"info",message:"请选择分组",duration:1e3})},updateHandle:function(){var e=this;this.dialog.title=3==this.menu.type?"分组名称":"文件名称",this.dialog.text=3==this.menu.type?this.curNodeName:this.curNodeName.substring(0,this.curNodeName.indexOf(".")),this.dialog.state=!0,this.dialog.type="update",this.$nextTick((function(){return e.$el.querySelector(".el-dialog__wrapper .el-input__inner").focus()}))},saveHandle:function(){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){var a,i,n,o,c,l,d;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.dialog.text,""!==a){t.next=4;break}return e.$message({type:"info",message:"名称不能为空",duration:1e3}),t.abrupt("return");case 4:if(1!=e.menu.type&&3!=e.menu.type||"add"!=e.dialog.type){t.next=8;break}e.treeArray.some((function(e){return e.sName===a}))?e.$message({type:"info",message:"分组名不能重复",duration:1e3}):("move"==e.$parent.type&&e.$parent.$parent.treeArray.push({sName:a,children:[]}),e.treeArray.push({sName:a,type:"group"}),e.dialog.state=!1),t.next=55;break;case 8:if(2!=e.menu.type&&4!=e.menu.type||"add"!=e.dialog.type){t.next=22;break}if(a.match(new RegExp(".path"))||(a+=".path"),i=e.getParent.list.data.some((function(e){return e.sName==a})),!i){t.next=15;break}e.$message({type:"info",message:"文件名不能重复",duration:1e3}),t.next=20;break;case 15:return t.next=17,Object(r["b"])({key:a,dataType:"path",groupName:e.getParent.curPath,data:"",type:"add"});case 17:n=t.sent,1===n.state?(e.getParent.list.data.push({sName:a,data:""}),e.$message({type:"success",message:"添加成功",duration:1e3})):e.$message({type:"error",message:"文件名已存在"==n.info?n.info:"添加失败",duration:1e3}),e.dialog.state=!1;case 20:t.next=55;break;case 22:if(3!=e.menu.type||"update"!=e.dialog.type){t.next=39;break}if(!e.treeArray.some((function(e){return e.sName===a}))){t.next=27;break}e.$message({type:"info",message:"分组名不能重复",duration:1e3}),t.next=37;break;case 27:if(e.curNodeName!=a){t.next=31;break}e.dialog.state=!1,t.next=37;break;case 31:return o=e.getParent.list.data.map((function(e){return e.sName})),t.next=34,Object(r["h"])({data:JSON.stringify([{key:o,groupName:a,dataType:"path"}])});case 34:c=t.sent,1===c.result?(e.treeArray.forEach((function(t){t.sName==e.curNodeName&&(t.sName=a)})),e.$message({type:"success",message:"修改成功",duration:1e3})):e.$message({type:"error",message:"修改失败",duration:1e3}),e.dialog.state=!1;case 37:t.next=55;break;case 39:if(4!=e.menu.type||"update"!=e.dialog.type){t.next=55;break}if(a.match(new RegExp(".path"))||(a+=".path"),l=e.getParent.list.data.some((function(e){return e.sName==a})),!l){t.next=46;break}e.$message({type:"info",message:"文件名不能重复",duration:1e3}),t.next=55;break;case 46:if(e.curNodeName!=a){t.next=50;break}e.dialog.state=!1,t.next=55;break;case 50:return t.next=52,Object(r["c"])({key:e.curNodeName,newKey:a});case 52:d=t.sent,1===d.result?(e.getParent.list.data.forEach((function(t){t.sName==e.curNodeName&&(t.sName=a)})),e.$message({type:"success",message:"修改成功",duration:1e3})):e.$message({type:"error",message:"文件名已存在"==d.info?d.info:"修改失败",duration:1e3}),e.dialog.state=!1;case 55:case"end":return t.stop()}}),t)})))()},moveHandle:function(e){var t=this;this.$confirm("确认移动图元至 "+e+" ?","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",showClose:!1}).then(Object(o["a"])(Object(s["a"])().mark((function a(){var i,n;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i=[],t.getParent.list.data.forEach((function(e){return e.checked&&i.push(e.sName)})),0==i.length&&i.push(t.curNodeName),t.getParent.list.loading=!0,a.next=6,Object(r["h"])({data:JSON.stringify([{key:i,groupName:e,dataType:"path"}])});case 6:n=a.sent,1===n.result?(t.getParent.list.data=t.getParent.list.data.filter((function(e){return!i.includes(e.sName)})),t.$message({type:"success",message:"移动成功",duration:1e3}),t.getParent.list.loading=!1):(t.$message({type:"error",message:"移动失败",duration:1e3}),t.getParent.list.loading=!1);case 8:case"end":return a.stop()}}),a)})))).catch((function(){}))}},computed:{getParent:function(){return this.$parent},getStyle:function(){var e=this.menu,t=e.top,a=e.left;return{top:"".concat(t,"px"),left:"".concat(a,"px")}},getStyle1:function(){var e=this.menu,t=e.top,a=e.left;return{top:"".concat(t,"px"),left:"".concat(a+100,"px")}}},created:function(){}}),u=d,h=(a("b944"),a("2877")),p=Object(h["a"])(u,c,l,!1,null,"ff0ca972",null),f=p.exports,m=a("c32a"),v=a("b85c"),b=a("d4ec"),g=a("bee2"),y=function(){function e(t,a,i){var n=this;Object(b["a"])(this,e),this.container=t,this.jcanvas=new JCanvas,this.jcanvas.init(t,a,i),this.jcanvas.strokeStyle="red",this.jcanvas.setCoordinate(1,-1),this.bitmapSys=new CanvasBitmapSys(this.jcanvas),this.bitmapSys.init(),this.bits=[],this.bitDatas=[],this.container.appendChild(this.canvas),document.body.addEventListener("keyup",(function(e){"q"==e.key&&(n.bitmapSys.clear(),n.bitmapSys.draw(),console.log("q"))}))}return Object(g["a"])(e,[{key:"canvas",get:function(){return this.jcanvas.canvas}},{key:"setData",value:function(e){this.bitDatas=this.createBitData(e)}},{key:"draw",value:function(){var e=this.createBitGroup(this.bitDatas);this.bitmapSys.draw(),e.setCenter(10),this.bitmapSys.draw()}},{key:"setX2dXml",value:function(e){var t=parseFormulaXml(e);this.bitmapSys.clear(),this.bitmapSys.draw();var a,i=this.bitmapSys.createBitmap("group"),n=null,s=Object(v["a"])(t.children);try{for(s.s();!(a=s.n()).done;){var o=a.value;if(o.children.length>0){n=o.children;break}}}catch(l){s.e(l)}finally{s.f()}if(n){var r=this.getOutLineGarphData(n),c=this.createBitData(r);this.createBitGroup(c,i);this.bitmapSys.draw(),i.setCenter(0,.1),this.bitmapSys.draw()}}},{key:"getOutLineGarphData",value:function(e){var t,a=[],i=Object(v["a"])(e);try{for(i.s();!(t=i.n()).done;){var n=t.value,s=w(n,{X:"x",Y:"y",X2:"x2",Y2:"y2",StartAngle:"startAngle",Angle:"angle",R:"r",ChordH:"h",IsBulge:"isBulge"});switch(n.node){case"Point":s.type="point",a.push(s);break;case"Arc":var o=getCanvasArcByHGArc({type:"arc",start:{x:s.x,y:s.y},r:s.r,startAngle:s.startAngle,angle:s.angle});s.type="arc",Object.assign(s,o),a.push(s);break;case"TArc":var r=getCanvasArcByHGArc({type:"tArc",start:{x:s.x,y:s.y},end:{x:s.x2,y:s.y2},h:s.h,isBulge:s.isBulge});s.type="arc",Object.assign(s,r),a.push(s);break}}}catch(c){i.e(c)}finally{i.f()}return"point"===a[0].type&&a.push(a[0]),a}},{key:"createBitData",value:function(e){for(var t=[],a=[],i=0;i<e.length;i++){var n=e[i];"arc"===n.type?(t.push({type:"path",path:a}),t.push(n),a=[]):"point"===n.type&&(a.push(new JPos(n.x,n.y)),i===e.length-1&&t.push({type:"path",path:a}))}return t}},{key:"createBitGroup",value:function(e,t){var a=t&&t.createBitmap("group")||this.bitmapSys.createBitmap("group");return e.forEach((function(e){if("path"===e.type){var t=a.createBitmap("path");t.data=t.getpolyLinePath(e.path)}else if("arc"===e.type){var i=a.createBitmap("arc");e.startAngle=-e.startAngle,e.endAngle=-e.endAngle,e.isCounterClockwise=!e.isCounterClockwise,i.data=e}})),a}}]),e}();function w(e,t){var a={};for(var i in t)if(void 0!==e.attr[i]){var n=t[i];a[n]=e.attr[i]}return a}var x=a("4f75"),C={name:"ImgResource",props:{onClose:Function,onSuccess:Function,type:String},data:function(){return{tree:{loading:!1,defaultProps:{children:"children",label:"sName"},data:[],inputText:""},list:{loading:!1,data:[],inputText:"",searchText:"",selectArray:[]},fadeState:!1,curPath:""}},methods:{filterNode:function(e,t){return!e||t.sName&&-1!==t.sName.indexOf(e)},initTreeHandle:function(){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){var a;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("move"!=e.type){t.next=4;break}e.tree.data=e.$parent.treeArray.map((function(e){return{sName:e.sName,type:"group"}})),t.next=8;break;case 4:return t.next=6,Object(r["g"])({dataTypeJsonArr:JSON.stringify(["path"])});case 6:a=t.sent,1==a.state?(e.tree.data=a.data.map((function(e){return{sName:e,type:"group"}})),e.tree.data.sort(Object(m["a"])("sName"))):e.$message({type:"error",message:"获取数据失败",duration:1e3,customClass:"messageClass"});case 8:e.$nextTick((function(){return e.tree.loading=!1}));case 9:case"end":return t.stop()}}),t)})))()},closeHandle:function(){var e=this;this.fadeState=!1,setTimeout((function(){e.onClose&&e.onClose()}),200)},searchHandle:function(e){"tree"==e?this.$refs.tree.filter(this.tree.inputText):this.list.searchText=this.list.inputText},nodeClickHandle:function(e,t,a){var i=this,n=this;a.tree.$children.forEach((function(e){e.node.isCurrent=!1})),t.isCurrent=!0,this.curPath=e.sName,this.list.data.splice(0),this.list.selectArray.splice(0),this.list.searchText=this.list.inputText="","manage"!=this.type&&"import"!=this.type||(this.list.loading=!0,setTimeout(Object(o["a"])(Object(s["a"])().mark((function t(){var a;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(r["f"])({dataType:JSON.stringify(["path"]),groupName:JSON.stringify([e.sName]),getDataFlag:!0});case 2:a=t.sent,1==a.result?a.data[e.sName]&&(i.list.data=a.data[e.sName].map((function(e){return{sName:e.key,data:e.data||"",checked:!1}})),i.list.data.sort(Object(m["a"])("sName"))):i.$message({type:"error",message:"获取数据失败",duration:1e3,customClass:"messageClass"}),i.$nextTick((function(){i.list.loading=!1,i.getListData.forEach((function(e){return n.addCanvasAndRenderPath(e)}))}));case 5:case"end":return t.stop()}}),t)}))),200))},clickHandle:function(e,t){this.list.selectArray=[e]},saveHandle:function(){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:"manage"==e.type||"import"==e.type?0==e.list.selectArray.length?e.$message({type:"info",message:"没有选中图元",duration:1e3,customClass:"messageClass"}):e.onSuccess(e.list.selectArray):e.onSuccess(e.curPath);case 1:case"end":return t.stop()}}),t)})))()},getUrlImg:function(e){e.md5,e.sName&&e.sName.substring(e.sName.lastIndexOf(".")+1);return""},addCanvasAndRenderPath:function(e){var t=this.$refs[e.sName];if(t&&e.data){var a=new y(t[0],t[0].clientWidth,t[0].clientHeight);try{var i=x["a"](e.data,{W:1e3,L:1e3}),n=getPointAndArcListByPathD(i.attr.d);a.setData(n[0]),a.draw()}catch(s){console.log(s,e.data)}}return""},keyHandle:function(){var e=event||window.event;27==e.keyCode?this.closeHandle():13!=e.keyCode||document.querySelector("input[type=text]:focus")||this.saveHandle()},menuHandle:function(e,t,a,i,n){if("import"!=this.type){var s=n;t&&"group"==t.type?(this.nodeClickHandle(t,a,i),s=3,i.tree.$children.forEach((function(e){e.node.isCurrent=!1})),a.isCurrent=!0):t&&4==n&&this.clickHandle(t),this.$refs.imgMenu.nodeMenuHandle(e,t,s)}},deleteBatch:function(){console.log(this.list.selectArray)}},computed:{getListData:function(){var e=this.list;return e.data.filter((function(t){return t.sName&&t.sName.includes(e.searchText)}))}},components:{ImgMenu:f},destroyed:function(){},created:function(){},mounted:function(){this.fadeState=!0,this.initTreeHandle()}},k=C,N=(a("9985"),a("af2d"),Object(h["a"])(k,i,n,!1,null,"a338cf7c",null));t["a"]=N.exports},"863d":function(e,t,a){},"8a5a":function(e,t,a){},"8a9f":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"lineToArcBox"},[a("div",{directives:[{name:"drag",rawName:"v-drag",value:{dom:"header",type:1},expression:"{dom:'header',type:1}"}],staticClass:"content"},[a("header",[a("span",{staticClass:"header_title"},[e._v(e._s(e.title))]),a("i",{staticClass:"el-icon-close",on:{click:e.closeHandle}})]),a("main",[a("el-radio",{attrs:{label:"1"},model:{value:e.curIsBulge,callback:function(t){e.curIsBulge=t},expression:"curIsBulge"}},[e._v("转为外凸弧")]),a("el-radio",{attrs:{label:"0"},model:{value:e.curIsBulge,callback:function(t){e.curIsBulge=t},expression:"curIsBulge"}},[e._v("转为内凹弧")]),a("el-divider"),a("div",{staticClass:"cfg"},[e._v(" 设置弦高: "),a("div",{staticClass:"input"},[a("QdInput",{attrs:{isNumber:!0,isShowInput:!0,isFocus:!0},model:{value:e.curChordH,callback:function(t){e.curChordH=t},expression:"curChordH"}})],1)])],1),a("footer",[a("el-button",{attrs:{size:"mini"},on:{click:e.closeHandle}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.confirmHandle}},[e._v("确认")])],1)])])},n=[],s=(a("a9e3"),a("32e0")),o=a("0ef8"),r={directives:{drag:s["a"]},components:{QdInput:o["a"]},data:function(){return{title:"转为圆弧",curIsBulge:"1",curChordH:10,isNumber:{type:Boolean,default:!0}}},props:["method","isBulge","chordH"],mounted:function(){this.title=this.method||"转为圆弧","设置属性"===this.method&&(this.curIsBulge=this.isBulge,this.curChordH=this.chordH)},methods:{closeHandle:function(){this.$emit("close")},confirmHandle:function(){"设置属性"===this.method?(this.curIsBulge==this.isBulge&&this.curChordH==this.chordH||this.$emit("confirm",Number(this.curChordH),this.curIsBulge,this.method),this.$emit("close")):(this.$emit("confirm",Number(this.curChordH),this.curIsBulge),this.$emit("close"))},lineToTArc:function(e){}}},c=r,l=(a("9a2b"),a("2877")),d=Object(l["a"])(c,i,n,!1,null,"21b3ae22",null);t["a"]=d.exports},"8c7e":function(e,t,a){},"8da3":function(e,t,a){"use strict";a("2a4d")},"91a8":function(e,t,a){},"93e7":function(e,t,a){},"94ab":function(e,t,a){},"95a0":function(e,t,a){},9985:function(e,t,a){"use strict";a("5b96")},"9a2b":function(e,t,a){"use strict";a("8a5a")},"9bb1":function(e,t,a){"use strict";a("2d48")},"9be2":function(e,t,a){e.exports=a.p+"img/均分孔.jpg"},"9fac":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"left-menu-box"}},[a("div",{staticClass:"nav-menu"},[a("div",{staticClass:"nav-menu-item",class:{selected:1==e.curNav},on:{click:function(t){return e.selectNav(1)}}},[e._v(" 数据列表 ")]),a("div",{staticClass:"nav-menu-item",class:{selected:2==e.curNav},on:{click:function(t){return e.selectNav(2)}}},[e._v(" 变量 ")])]),a("div",{attrs:{id:"table_head_box"}},[a("table",{attrs:{cellspacing:"0",id:"table_head"}},[e._m(0),a("thead",{attrs:{id:"thead"}},[a("tr",[a("td",[e._v(e._s(e.theadTitle[e.curNav][0]))]),a("td",[e._v(e._s(e.theadTitle[e.curNav][1]))])])])])]),a("div",{attrs:{id:"table_body_box"}},[a("table",{attrs:{cellspacing:"0",id:"table_body"}},[e._m(1),a("tbody",{directives:[{name:"show",rawName:"v-show",value:1===e.curNav,expression:"curNav === 1"}]},[e._l(e.listDataObj.Graph,(function(t,i){return a("tr",{key:i,staticClass:"table-item",class:{"edit-item":t.isEdit,selected:e.selection.some((function(e){return e.guid==t.guid}))},on:{click:function(a){return e.selectNodeEmit(t,"Graph",i)},dblclick:function(a){return e.showAttrEmit(t,i)}}},[a("td",[e._v(e._s(e.setIndex("Graph",i)))]),a("td",[e._v(e._s(e.setName(t)))])])})),e._m(2),e._l(e.listDataObj.FaceA,(function(t,i){return a("tr",{key:t.Face+t.id,staticClass:"table-item",class:{"edit-item":t.isEdit,selected:e.selection.some((function(e){return e.guid==t.guid}))},attrs:{id:t.id},on:{click:function(a){return e.selectNodeEmit(t,"FaceA",i)},dblclick:function(a){return e.showAttrEmit(t,i)},contextmenu:function(a){return e.showHoleOrCutEdit(a,t,i,"FaceA")}}},[a("td",[e._v(e._s(e.setIndex("FaceA",i)))]),a("td",[a("span",{class:{tdSpanClass:!0,errorTdClass:t.showError},attrs:{title:e.setName(t)}},[e._v(e._s(e.setName(t)))]),a("el-tooltip",{attrs:{effect:"light",placement:"right"}},[a("div",{staticClass:"errorTxt",attrs:{slot:"content"},slot:"content"},[e._v(e._s(t.errorTxt))]),t.showError?a("i",{staticClass:"el-icon-warning errorIcon"}):e._e()])],1)])})),e._m(3),e._l(e.listDataObj.FaceB,(function(t,i){return a("tr",{key:t.Face+t.id,staticClass:"table-item",class:{"edit-item":t.isEdit,selected:e.selection.some((function(e){return e.guid==t.guid}))},attrs:{id:t.id},on:{click:function(a){return e.selectNodeEmit(t,"FaceB",i)},dblclick:function(a){return e.showAttrEmit(t,i)},contextmenu:function(a){return e.showHoleOrCutEdit(a,t,i,"FaceB")}}},[a("td",[e._v(e._s(e.setIndex("FaceB",i)))]),a("td",[a("span",{class:{tdSpanClass:!0,errorTdClass:t.showError},attrs:{title:e.setName(t)}},[e._v(e._s(e.setName(t)))]),a("el-tooltip",{attrs:{effect:"light",placement:"right"}},[a("div",{staticClass:"errorTxt",attrs:{slot:"content"},slot:"content"},[e._v(e._s(t.errorTxt))]),t.showError?a("i",{staticClass:"el-icon-warning errorIcon"}):e._e()])],1)])})),e._m(4),e._l(e.listDataObj.FB||[],(function(t,i){return a("tr",{key:t.guid,staticClass:"table-item",class:{"edit-item":t.isEdit,selected:e.selection.some((function(e){return e.guid==t.guid}))},attrs:{id:t.id},on:{click:function(a){return e.selectNodeEmit(t,"FB",i)},dblclick:function(a){return e.showAttrEmit(t,i,!0)},contextmenu:function(a){return e.showHoleOrCutEdit(a,t,i,"FB")}}},[a("td",[e._v(e._s(e.setIndex("FB",i)))]),a("td",[a("span",{class:{tdSpanClass:!0,errorTdClass:t.showError},attrs:{title:e.setName(t)}},[e._v(e._s(e.setName(t)))]),a("el-tooltip",{attrs:{effect:"light",placement:"right"}},[a("div",{staticClass:"errorTxt",attrs:{slot:"content"},slot:"content"},[e._v(e._s(t.errorTxt))]),t.showError?a("i",{staticClass:"el-icon-warning errorIcon"}):e._e()])],1)])}))],2),a("tbody",{directives:[{name:"show",rawName:"v-show",value:2===e.curNav,expression:"curNav === 2"}]},e._l(e.keys,(function(t){return a("tr",{key:t,class:{readonly:e.isReadonly(t)}},[a("td",[e._v(e._s(t))]),a("td",{staticClass:"form-item"},[a("QdInput",{attrs:{banInput:e.isReadonly(t)},on:{change:function(a){return e.editBoardAttr(a,t)}},model:{value:e.attrs[t],callback:function(a){e.$set(e.attrs,t,a)},expression:"attrs[key]"}})],1)])})),0)])])])},n=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("colgroup",[a("col",{attrs:{width:"45"}}),a("col",{attrs:{width:"85"}})])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("colgroup",[a("col",{attrs:{width:"45"}}),a("col",{attrs:{width:"85"}})])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("tr",{staticClass:"bar"},[a("td",{attrs:{colspan:"2"}},[e._v("A 面")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("tr",{staticClass:"bar"},[a("td",{attrs:{colspan:"2"}},[e._v("B 面")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("tr",{staticClass:"bar"},[a("td",{attrs:{colspan:"2"}},[e._v("封边 面")])])}],s=(a("d3b7"),a("159b"),a("b0c0"),a("caad"),a("2532"),a("a434"),a("13d5"),a("4e82"),a("ad04")),o=a("e67d"),r=(a("18d2"),{props:["data","attrs","face_a","face_b","view","isFromHome"],data:function(){return{listDataObj:{Graph:[],FaceA:[],FaceB:[],FB:[]},curNav:1,keydown:{ctrl:!1},theadTitle:{1:["序号","图形名称"],2:["名称","值"]},defaultKeys:["L","W","CA","CB","CC","CD","CE","CF","CG","CH","CI","CJ","CK","CL","CM","CN","CO","CP"],selectedId:"",selectedNodesId:[],selectedNodes:[],selection:[],selectRow:null,selectRowHandleMethods:Object(o["a"])()}},components:{QdInput:s["a"]},computed:{keys:function(){var e=this,t=[];return this.attrs&&this.defaultKeys.forEach((function(a){e.attrs.hasOwnProperty(a)&&t.push(a)})),t}},watch:{face_a:function(e,t){this.emptySelected()},face_b:function(e,t){this.emptySelected()},data:function(e,t){this.listDataObj=e,this.listDataObj.FB=bdDecode.getFBCutDataUI(),console.log(this.listDataObj.FB)}},mounted:function(){var e=this;window.addEventListener("keyup",this.onWinKeyup,!1),this.$bus.$on("selectCanvasNode",(function(t){if(t){var a,i,n=null===t||void 0===t?void 0:t.split("-"),s=null!==(a=null===n||void 0===n?void 0:n[0])&&void 0!==a?a:"",o=null!==(i=null===n||void 0===n?void 0:n[1])&&void 0!==i?i:"",r=e.listDataObj[s][o];console.log(e.selection),e.selectRowHandleMethods(null,null,e.selection,r)}})),bdDecode.event.bitmapClick.replaceSubcribe((function(t){e.selectNode(t.node,t.type,t.index)}),"vueBitmapClick"),bdDecode.event.bitmapDbclick.replaceSubcribe((function(t){e.showAttr(t.attr,t.index,t.isFB)}),"vueBitmapDbclick")},beforeDestroy:function(){this.$bus.$off("selectCanvasNode")},methods:{onWinKeydown:function(e){switch(e.keyCode){case 17:break;case 18:break;default:this.keydown.ctrl=!1}},onWinKeyup:function(e){switch(e.keyCode){case 17:this.keydown.ctrl=!1;break}},selectNav:function(e){this.curNav=e},setIndex:function(e,t){return t++,"Graph"===e?t:(t+=this.data.Graph.length,"FaceA"===e?t:(t+=this.data.FaceA.length,"FaceB"===e?t:(t+=this.data.FaceB.length,"FB"===e?t:void 0)))},setName:function(e){var t=e.node;return"Point"===t?"点":"Arc"===t?"圆弧":"TArc"===t?"圆弧(弦高)":"BHole"===t?"大饼孔":"VHole"===t?"垂直孔":"Cut"===t?"开槽":"Path"===t?e.name||"图元":void 0},showAttrEmit:function(e,t,a){bdDecode.event.bitmapDbclick.emit({attr:e,index:t,isFB:a})},showAttr:function(e,t,a){if(1!==this.view){var i=e.node;this.isFromHome&&["Point","Arc","TArc"].includes(i)||this.$emit("show-attr",e,i,t)}},showHoleOrCutEdit:function(e,t,a,i){var n;if(e.preventDefault(),1!==this.view){null!==(n=this.selection)&&void 0!==n&&n.includes(t)||this.selectNodeEmit(t,i,a),this.$emit("show-menu",{x:e.clientX,y:e.clientY,ids:this.sortSelectIds(),selectRow:this.selectRow,selection:this.selection,face:i})}},editBoardAttr:function(e,t){this.$bus.$emit("editBoard",{key:t,newValue:e.newValue,oldValue:e.oldValue})},isReadonly:function(e){return 1===this.view},selectNodeEmit:function(e,t,a){bdDecode.event.bitmapClick.emit({node:e,type:t,index:a})},selectNode:function(e,t,a){var i,n;if(console.log(ObjUtil.JsonParse(e)),bdDecode.selectNodeUI(e,t),1!==this.view){var s=null!==(i=this.data[t])&&void 0!==i?i:[];null!==(n=this.selection)&&void 0!==n&&n.some((function(t){return(null===e||void 0===e?void 0:e.Face)&&t.Face==e.Face||(null===e||void 0===e?void 0:e.node)&&t.node==e.node}))?this.selectRowHandleMethods(event,s,this.selection,e):this.selectRowHandleMethods(null,null,this.selection,e),this.selectRow=e,!1!==e.isShow&&this.$emit("select-node",e)}},setClass:function(e,t,a){var i=a+"-"+t,n={selected:!1,"edit-item":!1};return e.isEdit&&(n["edit-item"]=!0),this.selectedNodesId.indexOf(i)>-1&&(n.selected=!0),this.selectedId===i&&(n.selected=!0),n},emptySelected:function(){var e=this.selectedNodesId,t=this.selectedNodes;e.splice(0,e.length),t.splice(0,t.length)},sortSelectIds:function(){var e,t=null===(e=this.selection)||void 0===e?void 0:e.reduce((function(e,t){var a=e["Face".concat(t.Face)];return a&&a.push(null===t||void 0===t?void 0:t.id),e}),{FaceA:[],FaceB:[]});return t.FaceA.sort(compareNumbers).reverse(),t.FaceB.sort(compareNumbers).reverse(),t}}}),c=r,l=(a("6c03"),a("2877")),d=Object(l["a"])(c,i,n,!1,null,"43926615",null);t["a"]=d.exports},a86e:function(e,t,a){"use strict";a("95a0")},ad04:function(e,t,a){"use strict";var i,n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"QdInput"},[1===e.editState?a("el-input",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.blurHandle,expression:"blurHandle"}],on:{input:e.limitNumber},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.blurHandle(t)}},model:{value:e.getValue,callback:function(t){e.getValue=t},expression:"getValue"}}):2===e.editState?a("el-select",{attrs:{placeholder:"请选择",size:"mini"},on:{input:e.limitNumber,change:e.selectChange},model:{value:e.getValue,callback:function(t){e.getValue=t},expression:"getValue"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):a("div",{staticClass:"Qd-edit__text",on:{click:function(t){return e.toggleHandle("click")},dblclick:function(t){return e.toggleHandle("dblclick")}}},[e._v(" "+e._s(e.getLabel)+" ")])],1)},s=[],o=a("b85c"),r=(a("a9e3"),a("ac1f"),a("5319"),a("d3b7"),a("a434"),a("2b0e")),c=a("26a1"),l=[],d="@@clickoutsideContext",u=0;function h(e,t,a){return function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!(a&&a.context&&i.target&&n.target)||e.contains(i.target)||e.contains(n.target)||e===i.target||a.context.popperElm&&(a.context.popperElm.contains(i.target)||a.context.popperElm.contains(n.target))||(t.expression&&e[d].methodName&&a.context[e[d].methodName]?a.context[e[d].methodName]():e[d].bindingFn&&e[d].bindingFn())}}!r["default"].prototype.$isServer&&Object(c["a"])(document,"mousedown",(function(e){return i=e})),!r["default"].prototype.$isServer&&Object(c["a"])(document,"mousedown",(function(e){l.forEach((function(t){return t[d].documentHandler(e,i)}))}));var p={bind:function(e,t,a){l.push(e);var i=u++;e[d]={id:i,documentHandler:h(e,t,a),methodName:t.expression,bindingFn:t.value}},update:function(e,t,a){e[d].documentHandler=h(e,t,a),e[d].methodName=t.expression,e[d].bindingFn=t.value},unbind:function(e){for(var t=l.length,a=0;a<t;a++)if(l[a][d].id===e[d].id){l.splice(a,1);break}delete e[d]}},f={name:"QdInput",props:{value:[String,Number],isNumber:{type:Boolean,default:!1},trigger:{type:String,default:"dblclick"},limitFn:{type:Function,default:null},banInput:{type:Boolean,default:!1},inputType:{type:String,default:"el-input"},options:{type:[Array]}},directives:{clickoutside:p},data:function(){return{initValue:"",editState:0,oldValue:"",changeSelect:!1}},methods:{selectChange:function(e){this.$emit("change",{oldValue:this.getValue,newValue:e}),this.editState=0,this.changeSelect=!0},toggleHandle:function(e){var t=this;this.banInput||(e===this.trigger&&(this.oldValue=this.getValue,this.setEditState(),this.$nextTick((function(){t.$el.querySelector(".el-input__inner").focus(),t.$el.querySelector(".el-input__inner").select()}))),this.$el.click())},blurHandle:function(){this.editState=0;var e=this.oldValue,t=this.getValue;e!==t&&this.$emit("change",{oldValue:e,newValue:t})},limitNumber:function(){if(this.isNumber){var e=this.$el.querySelector("input");e.value=e.value.replace(/[^(\-){1}\d.]/g,"").replace(/\.{2,}/g,".").replace(".","$#$").replace(/\./g,"").replace("$#$",".").replace(/\-{2,}/g,"-").replace("-","$#$").replace(/\-/g,"").replace("$#$","-"),this.getValue=e.value}},setEditState:function(){switch(this.inputType){case"el-input":this.editState=1;break;case"el-select":this.editState=2;break}}},computed:{getValue:{get:function(){return this.value},set:function(e){this.limitFn&&this.limitFn(e),this.$emit("input",e)}},getLabel:{get:function(){var e=String(this.value);if(this.options&&this.options.length>0){var t,a=Object(o["a"])(this.options);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(e===i.value)return i.label}}catch(n){a.e(n)}finally{a.f()}}return e}}}},m=f,v=(a("5f0f"),a("2877")),b=Object(v["a"])(m,n,s,!1,null,"17926022",null);t["a"]=b.exports},ad4b:function(e,t,a){"use strict";a("b87c")},af2d:function(e,t,a){"use strict";a("863d")},b87c:function(e,t,a){},b8e5:function(e,t,a){},b944:function(e,t,a){"use strict";a("94ab")},baa9:function(e,t,a){},bc4d:function(e,t,a){e.exports=a.p+"img/靠背对齐.jpg"},bc9c:function(e,t,a){"use strict";(function(e){var i,n,s=a("3835"),o=a("c7eb"),r=a("1da1"),c=a("53ca"),l=a("2909"),d=(a("a9e3"),a("b680"),a("b0c0"),a("ac1f"),a("5319"),a("d3b7"),a("99af"),a("4de4"),a("d81d"),a("159b"),a("caad"),a("13d5"),a("c740"),a("a434"),a("e9c4"),a("6062"),a("3ca3"),a("ddb0"),a("b64b"),a("2532"),a("5403")),u=a("0094"),h=a("9fac"),p=a("33c4"),f=a("0297"),m=a("3de3"),v=a("d98e"),b=a("8a9f"),g=a("db04"),y=a("16f4"),w=a("4f75"),x=a("ee37"),C=a("0ef8"),k=a("6821"),N=a.n(k),_=a("551b"),H=new Dxf,S={ctrl:!1};t["a"]={name:"AppRight",directives:{resize:d["a"]},props:{mode:Boolean},data:function(){return{isBanBtn:!1,dataType:"bd",blockGuid:"",isFromHome:!1,fromHomeFile:"",toHomeFileName:"",originFileName:"",fileId:"",loading:!1,isDraw:!1,boardAttr:{},dataList:{Graph:[],FaceA:[],FaceB:[],FaceL:[],FaceR:[],FaceU:[],FaceD:[],Attr:{}},tempDataList:null,graph:null,curFace:"",isMoving:!1,mousedownLoc:null,curEditType:null,curNode:null,showAttrEdit:!1,showMenu:{hc:!1,point:!1,holeGroup:!1,lineToTArc:!1,editAttr:!1},menuItemShow:{hc:{toFaceA:!1,toFaceB:!1}},showMenuItem:[],attreditTitle:"属性",handleType:"",selectedHC:{},selectedLinePoints:null,isMovingLine:!1,isBanPointMenu:!1,adjacent3Nodes:null,undoStack:[],redoStack:[],editHc:{value:0,direction:"",nodes:null},showEditInput:!1,isAddHC:!1,viewState:1,selectNodeOriginAttr:null,nocheckSelect:!1,selectedItem:null,rightSelectedItem:null,editInput:{edit1:{value:0,oldValue:0,node:null,show:!1},edit2:{value:0,oldValue:0,node:null,show:!1}},inputShow:!1,isDraging:!1,noClickFnBtn:!0,sName:"",ImgResourceState:!1,dialogType:"",currentX2dData:null,styleMode:"默认",holeSlotRuleState:!1,holeSlotRuleData:{},orginCncback:"",otherFrameBtn:void 0,dataFromMainApp:{},dialogFormVisible:!1,formType:"斜线",form:{radius:"30",width:"30",height:"30"},dialogVisible_line2arc:{LineToArc:!1,method:"转为圆弧",isBulge:null,chordH:null},rightPointMenuList:[{label:"属性编辑",method:this.ediltNodeAttr,args:[],show:!1},{label:"转为斜线",method:this.openTransformPointFrom,args:["斜线"],show:!1},{label:"转为直角",method:this.openTransformPointFrom,args:["直角"],show:!1},{label:"转为外凸弧",method:this.openTransformPointFrom,args:["外凸弧"],show:!1},{label:"转为内凹弧",method:this.openTransformPointFrom,args:["内凹弧"],show:!1},{label:"删除",method:this.deletePoint,args:[],show:!1}],errorobjs:null}},computed:{showEdit1Data:{get:function(){return Number(this.editInput.edit1.value.toFixed(1)||0)},set:function(e){this.editInput.edit1.value=Number(e||0)}},showEdit2Data:{get:function(){return Number(this.editInput.edit2.value.toFixed(1)||0)},set:function(e){this.editInput.edit2.value=Number(e||0)}},selection:function(){var e,t=this.$refs.left;return null!==(e=null===t||void 0===t?void 0:t.selection)&&void 0!==e?e:[]}},watch:{curFace:function(e){hcEditLabel.isShow=!1,this.draw()},viewState:function(e){this.isDraw?this.noClickFnBtn=1===e:this.noClickFnBtn=!0},boardAttr:{deep:!0,handler:function(e){this.$bus.$emit("boarAttr",e)}}},mounted:function(){var t=this,a=this;this.importDataStrEvent(),this.importDataEvent(),this.initEvent(),this.selectFaceEvent(),this.loadBDEvent(),this.loadXmlDataEvent(),this.loadX2dEvent(),this.saveToHomeEvent(),this.openFromMainAppEvent(),this.clearExitToHomeEvent();var i=!1;bdDecode.ui.getBdXml=function(){return t.getBdXml()},e.Qd_OpenBdEdit=function(e){t.$refs.topBar.isLocalFile=!1,t.dialogType="openBd",t.ImgResourceSuccess(e)},e.loadBD=function(e,i){var n,s,o,r=null!==(n=null===(s=window)||void 0===s||null===(o=s.opener)||void 0===o?void 0:o.name)&&void 0!==n?n:"",c={"tab_数据处理中心主页面_iframe":["源代码"],qd_window_bom:["源代码"],qd_window_bom3:["源代码"],kailiao:["源代码"]};t.otherFrameBtn=null===c||void 0===c?void 0:c[r],a.loadBd(e,i)};try{e.openFromMainApp=function(e,t){i=!0,bdDecode.event.openFromMainApp.emit({data:e,limitObj:t})}}catch(n){this.loading=!1,this.$message({type:"error",message:"获取BD失败"}),console.error("从主页打开时报错",n)}setTimeout((function(){var t,a,n;if(!i&&null!==(t=window)&&void 0!==t&&null!==(a=t.opener)&&void 0!==a&&null!==(n=a.UIAction)&&void 0!==n&&n.getBdEditorData){var s=window.opener.UIAction.getBdEditorData();e.openFromMainApp(s.modelData,s.other)}}),2e3),setTimeout((function(){t.loadBd(_["a"],"data.bd")}),1e3)},methods:{resizefn:function(){},initEvent:function(){this.initCanvasEvent(),this.initBusEvent()},initCanvasEvent:function(){var e=this;this.$bus.$on("canvasResize",(function(t){e.onWindowResize(t)})),canvas2d.canvas.addEventListener("mousedown",this.onMouseDown),canvas2d.canvas.addEventListener("mousemove",this.mousemove),canvas2d.canvas.addEventListener("mousewheel",this.mousewheel),canvas2d.canvas.addEventListener("contextmenu",this.onContextmenu,!1),canvas2d.canvas.addEventListener("click",this.onClick,!1),canvas2d.canvas.addEventListener("mouseup",this.mouseup),canvas2d.canvas.addEventListener("dblclick",this.dblclick),window.addEventListener("keydown",this.onWinKeydown,!1),window.addEventListener("keyup",this.onWinKeyup,!1),window.addEventListener("mousedown",this.onWinMousedown,!1)},initBusEvent:function(){var e=this,t=this;function a(e,a){t.$bus.$on(e,a)}a("setCurrent",this.setCurrent),a("selectFace",this.selectFace),a("btnClick",this.btnClick),a("cncback",this.cncbackChange),a("editBoard",this.updateAllNode),a("editXMLCode",this.editXMLCode),a("saveXMLCode",this.updateXML),a("createX2d",this.createX2d),a("saveAsPath",this.saveAsPath),a("pathManage",this.pathManage),a("importPathData",this.importPathData),a("changePlane",this.changePlane),a("leftMenuHandle",this.leftMenuHandle),a("saveX2d",this.saveX2d),a("showAttr",this.showAttr),a("exportPng",this.exportPng),a("openHoleSlotRule",this.openHoleSlotRule),a("isShowHoleInfo",this.isShowHoleInfo),a("resetRect",this.resetRect),a("addGroupHole",this.addGroupHole),a("keyboardHandle",this.keyboardHandle),a("loadXmlData",this.loadXmlData),a("lineToArc",(function(){e.handleType="lineToArc"})),a("clickApp",(function(t){"lineToArc"!==e.handleType&&e.hideMenu(t)})),a("selectCanvasNode",(function(t){!t&&e.curNode&&(e.curNode.color="#fff",e.curNode=null)})),a("getCurrentX2d",(function(t){t(e.getX2d())})),a("loadBd",(function(t){t&&e.loadBd(t)}))},openFromMainAppEvent:function(){var e,t=this;null!==(e=window.opener)&&void 0!==e&&e.gMainApp&&(this.loading=!0);try{bdDecode.event.openFromMainApp.replaceSubcribe((function(e){var a,i;t.isBanBtn=void 0!==(null===(a=e.limitObj)||void 0===a?void 0:a.isCanAllEdit)&&!(null!==(i=e.limitObj)&&void 0!==i&&i.isCanAllEdit);var n=t;t.fromHomeFile=t.toHomeFileName=e.data.BasicGraphic,t.isFromHome=!0,t.$vuex.parentpagename="home",t.blockGuid=e.data.guid;var s=window.opener&&window.opener.gMainApp?window.opener.gMainApp:null;if(!s)return t.loading=!1,void console.error("window.opener.gMainApp不存在");s.GetBlockHolesInfo(e.data.guid,(function(a){var i=a?ObjUtil.JsonParse(a):void 0;HgServiceTool.getBdXmlFromMainApp(s,e.data,(function(i){if(0===i.result)n.$message({type:"error",message:i.message});else{var s=i.bdJson,o=i.fileName,r=i.name,c=(i.type,i.bomName,i.label,i.xml,i.errorobjs);if(n.toHomeFileName=o,n.orginCncback=s.attr.CncBack,n.errorobjs=c,s.attr.CncBack=0,n.dataFromMainApp=i,bdDecode.holeInfo=void 0,a)for(var l in a){var d,u;if(null!==a&&void 0!==a&&null!==(d=a[l])&&void 0!==d&&null!==(u=d.holeinfo)&&void 0!==u&&u[e.data.guid]){bdDecode.holeInfo=a[l].holeinfo[e.data.guid];break}}console.log(ObjUtil.JsonParse(s)),n.updateBdJson(s,r);var h=n.getBdXml();bdDecode.originAppBD=h,bdDecode.originBlock=e.data,n.loading=!1,setTimeout((function(){t.cncbackChange({CncBack:0,degree:0})}),500)}}),{defHoleInfo:i})}))}),"AppRight")}catch(a){console.log(a),this.loading=!1}},updateXML:function(e,t){var a=this;BDUtils.initData({xml:e,fileName:t},(function(e){a.afterInitBdData(t,e)}))},updateBdJson:function(e,t){var a=this;BDUtils.initData({data:e,fileName:t,isJson:!0},(function(e){a.afterInitBdData(t,e)}))},afterInitBdData:function(e,t){var a=this;if(a.reset(),hcEditLabel.init(),e&&(a.sName=e.replace(/\.bd/,"")||""),t){a.boardAttr=bdDecode.boardAttr=BDUtils.getBoardAttr(),this.isFromHome&&(this.originFileName=a.boardAttr.originFileName||"");var s=a.getSize(),o=s.bl,r=s.bw,c=s.bh;transform2d.init({bl:o,bw:r,rotation:cncbacks[a.boardAttr.CncBack]}),bdDecode.jGraph=a.graph=new JGraph(canvas2d.ctx,BDUtils.getGraphData(),a.boardAttr),graphUtil.init(a.graph,o,r,c),this.initDataList(),hcEditLabel.setBound(a.graph.getBound()),i=new PreviewLabel(o,r,c),n=new FbViewLabel(canvas2d.ctx,{bl:o,bw:r,bh:c}),bdDecode.jFbViewLabel=n,i.setPreviewData(this.dataList),n.setPreviewData(a.graph.nodes,this.dataList.FaceA,this.dataList.FaceB),this.updateHCErrorobj(),this.isDraw=!0,this.draw()}},setCurrent:function(e){if(!e)return this.currentX2dData=null;this.sName="",this.currentX2dData=e,this.updateXML(e.data,e.sName)},reset:function(){this.boardAttr=bdDecode.boardAttr={},this.dataList.Graph=[],this.dataList.FaceA=[],this.dataList.FaceB=[],this.isDraw=!1,this.tempDataList=null,this.graph=null,this.undoStack=[],this.redoStack=[],transform2d.reset(),canvas2d.clear()},onWindowResize:function(e){var t=this.mode?window.innerWidth-e.w-140:window.innerWidth-e.w,a=window.innerHeight-70;canvas2d.setSize(t,a),bdDecode.jcanvas.resize(t,a),this.draw()},initDataList:function(){var e=this,t=BDUtils.getFaceData("hole",e.graph.getLines()),a=BDUtils.getFaceData("cut"),i=BDUtils.getFaceData("path");e.dataList={Graph:[],FaceA:[],FaceB:[]},this.dataList.Graph=BDUtils.getGraphData().children;var n=["A","B"];n.forEach((function(n){for(var s=[].concat(Object(l["a"])(t[n]),Object(l["a"])(a[n]),Object(l["a"])(i[n])),o=0;o<s.length;o++)e.dataList["Face"+n].push(s[o])})),e.setOhterFaceHoles()},setOhterFaceHoles:function(){var e=this,t=this,a=[].concat(Object(l["a"])(this.dataList.FaceA),Object(l["a"])(this.dataList.FaceB)).filter((function(e){return"BHole"===e.node})),i=a.map((function(t){return t.getVHoleByBHole({BH:e.boardAttr.BH})})).filter((function(e){return e}));i.forEach((function(e){var a="Face".concat(e.Face),i=t.dataList[a];i||(t.dataList[a]=[]),t.dataList[a].push(e)}))},onMouseDown:function(e){if(this.isDraw)switch(e.preventDefault(),e.button){case 0:this.mouseLeft(e);break;case 1:this.mouseMid(e);break}},mouseLeft:function(e){if(this.isDraw){var t=this;t.mousedownLoc={x:mouse.pos.x,y:mouse.pos.y},t.handleType||(t.isMoving=!0),t.mousedownSelect(e);var a=this.selectedItem&&"Line"===this.selectedItem.type;switch(a&&!t.handleType&&(0==this.boardAttr.CncBack?this.isMovingLine=!0:this.$message({type:"info",message:"请先切换到下靠挡再移动边"})),t.handleType){case"addCut":t.addNewNode("cut");break;case"editHC":t.editHC();break;case"addGroupHole":a&&t.openAddholeDialog();break;case"lineToArc":a&&(this.showLine2ArcDialog(),this.cancelSelectSide());break;default:if(1===t.viewState)return;t.showSelectHCLabel()}t.addHCToDataList()}},mouseMid:function(e){this.isDraw&&2===e.detail&&this.resetView()},mousemove:function(e){if(this.isDraw&&!this.inputShow)if(canvas2d.setCursor("default"),this.isMoving)0===this.viewState&&1===hcEditLabel.selectedType?(this.moveSelectHC(this.curNode),this.isDraging=!0):S.ctrl&&0===this.viewState?(hcEditLabel.setDragBox(this.mousedownLoc,mouse.pos),this.draw()):2===hcEditLabel.selectedType?this.moveHoleGroup():this.moveCvs(),canvas2d.setCursor("pointer");else if(this.isAddHC)this.moveSelectHC(hcEditLabel.tempHC,this.isAddHC);else{if(this.nocheckSelect){var t=graphUtil.isIn();this.changeOutlineStyleAndCursorStyle(t),t.isIn&&("Point"===t.item.type?(canvas2d.setCursor("pointer"),this.selectedItem=t.item):this.selectedItem&&"Point"===this.selectedItem.type&&(this.selectedItem=null))}if(this.selectedItem&&!this.handleType){var a=this.selectedItem.type;"Line"===a&&this.isMovingLine&&(this.moveLine(this.selectedItem.node),this.isDraging=!0)}switch(this.handleType){case"editHC":this.changeSelectHCColor(e),this.draw(),canvas2d.drawCursorText(mouse.pos.x,mouse.pos.y,"选择孔槽");break;case"":if(1===this.viewState)return;this.changeSelectHCColor(e),this.checkHcEditLabel();break}this.draw()}},mouseup:function(e){this.isDraw&&(canvas2d.setCursor("default"),transform2d.resetTempMatrix(),this.dragSelectHole(),this.draw(),this.isDraging&&(graphUtil.setGraphChild(),this.dataList.Graph=graphUtil.graph.children,this.tempDataList&&(this.addUndo(this.tempDataList),this.tempDataList=null)),0===this.viewState&&(this.nocheckSelect=!0),hcEditLabel.tempHC||(this.isAddHC=!1),this.isMoving=!1,this.isMovingLine=!1,this.selectNodeOriginAttr=null)},mousewheel:function(e){if(this.isDraw&&!this.inputShow){e.preventDefault();var t=e.deltaY||-e.wheelDeltaY;transform2d.zoomCanvas(t),this.draw()}},dblclick:function(e){this.isDraw&&this.showHcEditLabelInput()},onContextmenu:function(e){var t=this;e.preventDefault(),this.cancelSelectSide(),this.isDraw&&(this.mousedownSelect(e),this.rightSelectedItem||this.selectHC(mouse.pos.x,mouse.pos.y,(function(e,a){t.rightSelectedItem={node:e,index:a,type:e.node}})),hcEditLabel.clearTempHC(),this.handleType="",this.canvasRightMenu(e),this.draw())},onClick:function(e){this.isDraw&&(1===this.viewState||this.isDraging?this.isDraging=!1:this.selectedItem&&!this.handleType&&(this.setNodeColor(this.selectedItem),this.draw(),this.showGraphEditInput(this.selectedItem),graphUtil.setGraphChild(),this.dataList.Graph=graphUtil.graph.children,graphUtil.tempChilds=null))},onWinKeydown:function(e){switch(e.keyCode){case 17:break;case 18:break;case 67:this.copyHCToHcEditLabel();break;case 37:this.moveByKeyBoard(-1,0);break;case 38:this.moveByKeyBoard(0,1);break;case 39:this.moveByKeyBoard(1,0);break;case 40:this.moveByKeyBoard(0,-1);break}},onWinKeyup:function(e){switch(e.keyCode){case 46:this.deleteHC(-1);break;case 17:S.ctrl=!1;break;case 86:this.stick();break;case 90:S.ctrl&&this.revoke();break}},onWinMousedown:function(e){var t=e.target;"exportX2d"===t.id||t.classList.contains("select-dropdown-item")||changeDisplay("exportX2d-dropdown","none"),t.classList.contains("input-item")||this.inputShow&&this.hideInput()},mousedownSelect:function(e){if(this.nocheckSelect){this.selectedItem=null,this.rightSelectedItem=null;var t=graphUtil.isIn();if(t.isIn){var a=t.item.type;["addGroupHole","lineToArc"].includes(this.handleType)&&"Line"===a?this.selectedItem=t.item:("Point"===a?this.selectedItem=t.item:"Line"===a?t.item.isInCenter?"contextmenu"===e.type?this.selectedItem=t.item:(this.isMoving=!1,this.splitLine(t.item.node)):"contextmenu"===e.type||(this.isMoving=!1,this.nocheckSelect=!1,this.selectedLinePoints={p1:getPoint(t.item.node.p1),p2:getPoint(t.item.node.p2)},this.tempDataList=copyObject(this.dataList),this.selectedItem=graphUtil.preMoveLine(t.item)):"Arc"===a&&("contextmenu"===e.type||(t.item.node.isSelected=!0,this.selectedItem=t.item)),"Point"!==a&&"Arc"!==a&&"TArc"!==a||("contextmenu"===e.type&&(this.rightSelectedItem=t.item),this.$bus.$emit("selectCanvasNode","Graph-".concat(t.item.index))))}}},draw:function(e){if(this.isDraw&&canvas2d.isDisplay&&transform2d){e=e||transform2d.matrix,canvas2dAction.fbView=n,canvas2dAction.curFace=this.curFace,canvas2d.clear();var t=Number(this.boardAttr.CncBack);0===this.viewState&&(["L","R","U","D"].includes(this.curFace)?(canvas2d.drawAxis(),canvas2dAction.drawFbView(e)):(canvas2d.drawAxis(t),this.drawEditView(e))),1===this.viewState&&(canvas2d.drawAxis(t),this.drawPreView(e))}},drawEditView:function(e){this.drawGraph(e),this.drawFBLabel(),canvas2dAction.drawDirectLabel()},drawPreView:function(e){var t=this.dataList.FaceA.length,a=this.dataList.FaceB.length,n=canvas2d.canvas,s=n.clientWidth,o=n.clientHeight,r=i.getFacePreviewData("A"),c=i.getFacePreviewData("B"),l=1,d={LR:{origin:{A:[0,0],B:[s/2,0]},viewSize:[s/2,o]},UD:{origin:{A:[0,o/2],B:[0,0]},viewSize:[s,o/2]}},u=r.direct;if(90!==transform2d.rotation&&270!==transform2d.rotation||(u="LR"===u?"UD":"LR"),t>0&&a>0&&(l=2),"默认"===this.styleMode&&this.drawFBLabel(),1===l)0===a?this.drawPreViewLabel("A",r,e):this.drawPreViewLabel("B",c,e);else{var h=d[u],p=h.origin["A"],f=h.origin["B"],m=.8*transform2d.getScale(r.width,r.height,h.viewSize[0],h.viewSize[1]),v=.8*transform2d.getScale(c.width,c.height,h.viewSize[0],h.viewSize[1]),b=m<v?m:v;this.drawPreViewLabel("A",r,e,p,h.viewSize,b),this.drawPreViewLabel("B",c,e,f,h.viewSize,b)}},drawPreViewLabel:function(e,t,a,n,s,o){var r=transform2d.getViewMatrix(a,t.width,t.height,n,s,o);this.graph.draw(r),this.graph.drawGrain(r,BDUtils.getBdGrainAngle(this.boardAttr.DI,this.boardAttr.CncBack,this.boardAttr.CncBack1)),this.dataList["Face"+e].forEach((function(e){e.draw(r),e.drawLabel(r)})),i.drawHoleLabel(t,r)},drawFBLabel:function(){var e=canvas2d.canvas,t=e.clientWidth,a=e.clientHeight,i=this.getFBsByCncback(),n=20,s=[{x:t/2,y:n},{x:t/2,y:a-n-10},{x:n,y:a/2},{x:t-n-65,y:a/2}];s.forEach((function(e,t){canvas2d.drawTriangle({x:e.x,y:e.y,text:i[t][0],isUp:i[t][1]})}))},drawGraph:function(e){var t=this,a=transform2d.getViewMatrix(e),i=t.dataList["Face"+t.curFace];t.graph.draw(a,t.curFace),i&&i.forEach((function(e){e.draw(a)})),hcEditLabel.draw(a,t.curFace),this.drawOther(a)},drawOther:function(e){this.selectedItem&&"Point"===this.selectedItem.type&&canvas2dAction.drawPoint(this.selectedItem.node,e)},moveCvs:function(){canvas2d.setCursor("move"),transform2d.moveCanvas(this.mousedownLoc,mouse.pos),this.draw(transform2d.tempMatrix)},showAttr:function(e,t,a){this.selectedHC={},this.curEditType=t,this.curNode=e,this.showAttrEdit=!0,this.handleType="editNodeAttr"},showHoleCutMenu:function(e){var t=this.menuItemShow.hc;"FaceA"===e.face?(t.toFaceA=!1,t.toFaceB=!0):(t.toFaceA=!0,t.toFaceB=!1),this.selectedHC=e.ids,this.showRightMenu("hcMenu","hc",e.x,e.y)},hideAttr:function(e){this.showAttrEdit=!1,this.attreditTitle="属性",this.editAttr(e),this.handleType=""},editAttr:function(e){if(this.curNode)switch(this.handleType){case"editNodeAttr":this.updateNodeAttr(e);break}else{var t;if(!e)return;"VHole"!==e.node&&"BHole"!==e.node||(t="hole"),"Cut"===e.node&&(t="cut"),t&&(hcEditLabel.addTempHC(t,e,this.graph.getLines()),this.isAddHC=!0)}this.draw(),this.handleType=""},updateNodeAttr:function(e){if(this.addUndo(),this.curNode.Face)e&&this.curNode.Face!==e.Face&&this.moveToOtherFace(e.Face),this.curNode instanceof Hole&&this.curNode.update(e),this.curNode instanceof Cut&&this.curNode.update(e),"Path"===this.curNode.node&&this.curNode.update(e);else{for(var t in e)this.curNode.attr[t]=e[t];this.graph.update(this.curNode)}this.updateFbViewData()},seletcNode:function(e){hcEditLabel.isShow=!1,["VHole","BHole","Cut","Path"].includes(e.node)&&e.Face===this.curFace&&this.showHCEditLabel(e),this.selectedItem=null,this.setNodeColor(e),this.draw()},showHCEditLabel:function(e){hcEditLabel.checkBound([e],this.curFace),hcEditLabel.isShow=!0,hcEditLabel.selectedType=1,this.editHc.nodes=[e]},setNodeColor:function(e){this.resetAllNodeColor(),graphUtil.checkPointAndArc(e)||(e.color="red",this.curNode=e)},resetAllNodeColor:function(){var e=[].concat(Object(l["a"])(this.dataList["FaceA"]),Object(l["a"])(this.dataList["FaceB"]));e.forEach((function(e){e.reColor()}))},updateAllNode:function(e){var t=this,a=copyObject(this.boardAttr);a[e.key]=e.oldValue,this.addUndo(void 0,a),e&&e.key&&(this.boardAttr[e.key]=e.newValue),this.dataList.Graph.forEach((function(e){var a=e.attr;for(var i in a)if("object"===Object(c["a"])(a[i])){var n=a[i]?a[i].formula:"";void 0!==n&&(a[i].value=calcFormula(a[i].formula,t.boardAttr))}})),this.graph.update();var i=this.getSize(),n=i.bl,s=i.bw,o=i.bh;graphUtil.setSize(n,s,o);var r=[].concat(Object(l["a"])(this.dataList.FaceA),Object(l["a"])(this.dataList.FaceB));r.forEach((function(e){for(var a in e)if("HDirect"!==a&&"object"===Object(c["a"])(e[a])){var i=e[a]?e[a].formula:"";void 0!==i&&(e[a].value=calcFormula(i,t.boardAttr))}"Path"===e.node?e.update():e instanceof Hole&&(e.update(t.graph.getLines()),e.isEdit=!1)})),this.updateAllHoleByHoleRule(),this.updateFbViewData(),this.draw()},selectFaceEvent:function(){var e=this;bdDecode.event.selectFace.replaceSubcribe((function(t){canvas2dAction.setCurFace(t),e.resetView(),"0"===t?e.changeViewState():(e.curFace=t,e.viewState=0,e.nocheckSelect=!0,canvas2d.isDisplay&&e.draw(),bdDecode.jcanvas.isDisplay&&bdDecode.jcanvas.bitmapUpdate())}),"AppRight")},selectFace:function(e){bdDecode.event.selectFace.emit(e)},hideMenu:function(e){var t=!!hasClass(e.target,"hole-cut-menu")||hasClass(e.target.parentNode,"hole-cut-menu");t||this.hideRightMenu()},moveToFaceA:function(){this.addUndo(),this.moveToOtherFace("A")},moveToFaceB:function(){this.addUndo(),this.moveToOtherFace("B")},moveToOtherFace:function(e){var t,a="A"===e?"FaceB":"FaceA",i="Face"+e,n=this.dataList,s=n[a],o=n[i],r=null!==(t=null===this||void 0===this?void 0:this.selection)&&void 0!==t?t:[];o.push.apply(o,Object(l["a"])(null===r||void 0===r?void 0:r.reduce((function(t,a){var i=s.findIndex((function(e){return(null===e||void 0===e?void 0:e.id)==(null===a||void 0===a?void 0:a.id)}));return-1!=i&&(a.Face=e,t=t.concat(s.splice(i,1))),t}),[]))),this.hideRightMenu(),this.updateFbViewData(),this.draw(),this.selectedHC={}},copyToOtherFace:function(){var e,t=null!==(e=this.selection)&&void 0!==e?e:[],a=this.menuItemShow.hc.toFaceB?"A":"B",i="B"==a?"A":"B",n=this.dataList["Face".concat(i)];this.addUndo(),t.forEach((function(e){var t,a=copyObject(e);a.Face=i,e instanceof Hole&&(t=new Hole(a,a.node,BDUtils),t.setNotAuto(1),delete t.Rule),e instanceof Cut&&(t=new Cut(a),t.setNotAuto(1)),n.push(t)})),this.hideRightMenu(),this.updateFbViewData(),this.draw(),this.selectedHC={}},moveInFace:function(e){var t=this.selectedHC["FaceA"],a=this.selectedHC["FaceB"];if(t.length+a.length>1)this.$message({type:"info",message:"只支持移动单个",duration:2e3});else{var i=Number(t[0]||-1),n=Number(a[0]||-1),s=t.length>0?"FaceA":a.length>0?"FaceB":"",o="FaceA"===s?i:n,r=this.dataList[s],c=this.dataList[s][o];if("up"===e&&0!==o){this.addUndo();var l=r[o-1];r.splice(o,1,l),r.splice(o-1,1,c)}else if("down"===e&&o!==r.length-1){this.addUndo();var d=r[o+1];r.splice(o,1,d),r.splice(o+1,1,c)}this.updateFbViewData(),this.draw()}},deleteHC:function(e){if(-1===e){var t;this.addUndo();var a=null!==(t=this.selection)&&void 0!==t?t:[],i="Face".concat(this.menuItemShow.hc.toFaceB?"A":"B"),n=this.dataList[i];a.forEach((function(e){var t,a=n.findIndex((function(t){return t==e}));-1!=a&&(n.splice(a,1),null===e||void 0===e||null===(t=e.delete)||void 0===t||t.call(e))}))}else{var s="Face"+this.curNode.Face,o=this.dataList[s][e];o.color="#fff",this.addUndo(),this.dataList[s].splice(e,1)}hcEditLabel.closeHoleGroup(),this.hideRightMenu(),this.updateFbViewData(),this.draw()},addNewNode:function(e,t){"cut"===e&&(this.showAttrEdit=!0,this.attreditTitle="增加槽",this.curEditType="Cut",this.curNode=null),"hole"===e&&(this.showAttrEdit=!0,this.attreditTitle=t?"增加大饼孔":"增加垂直孔",this.curEditType=t?"BHole":"VHole",this.curNode=null)},changeHandleType:function(e){this.handleType=e},changeSelectHCColor:function(e){var t=this;this.selectHC(mouse.pos.x,mouse.pos.y,(function(e){e.color="red",canvas2d.setCursor("pointer")}),(function(e){e!==t.curNode&&e.reColor()}))},selectHC:function(e,t,a,i){for(var n=transform2d.getViewMatrix(),s=this.dataList["Face"+this.curFace]||[],o=0;o<s.length;o++)s[o].isPointInPath(n,e,t)?a&&a(s[o],o):i&&i(s[o],o)},editHC:function(){var e=this;this.selectHC(mouse.pos.x,mouse.pos.y,(function(t,a){e.showAttr(t,t.node,a),t.reColor()}))},splitLine:function(e){var t=this;this.$prompt("等分数量","",{inputPattern:/^[0-9]*$/,inputErrorMessage:"请输入数字,且为整数",showClose:!1}).then((function(a){var i=a.value;if(isNumber(i)){var n=parseInt(i),s={x:e.x1,y:e.y1},o={x:e.x2,y:e.y2},r=t.dataList.Graph.indexOf(e.p2),c=math2d.getLineEqualPoints(s,o,n);t.addMorePoint(c,r,"insert"),t.graph.update(),t.draw()}}))},deletePoint:function(){if(this.adjacent3Nodes&&!this.isBanPointMenu){var e=this.adjacent3Nodes.center,t=this.graph.children.indexOf(e);this.addUndo(),this.graph.children.splice(t,1),this.graph.update(),this.updateFbViewData(),this.draw(),this.selectedItem=null}},ediltNodeAttr:function(){if(this.rightSelectedItem){var e=this.rightSelectedItem.node;"TArc"!==e.node&&"Arc"!==e.node||(e=e.arc);var t=this.graph.children.indexOf(e);-1===t&&(t=this.rightSelectedItem.index),this.$bus.$emit("showAttr",e,e.node,t)}this.rightSelectedItem=null},moveLine:function(e){if(this.selectedLinePoints){var t=this.selectedLinePoints.p1,a=this.selectedLinePoints.p2,i=getMoveD(this.mousedownLoc);graphUtil.moveLine(e,t,a,i)}},showRightMenu:function(e,t,a,i){this.hideRightMenu();var n=document.getElementById(e);n.style.left=a+10+"px",n.style.top=i+"px",this.showMenu[t]=!0},hideRightMenu:function(){for(var e in this.showMenu)this.showMenu[e]=!1},canvasRightMenu:function(e){if(this.selectedItem)"Point"===this.selectedItem.type?(this.setAdjacentPoints(),this.showRightMenu("pointMenu","point",e.x,e.y)):"Line"===this.selectedItem.type&&this.showLine2ArcDialog();else if(this.rightSelectedItem){var t=this.rightSelectedItem.node;if("Arc"===t.node)return;if("TArc"===t.node){var a=t.attr.IsBulge.value,i=t.attr.ChordH.value;this.showLine2ArcDialog(!0,"设置属性",a,i)}else this.showRightMenu("editAttr","editAttr",e.x,e.y)}else hcEditLabel.setSelectedToCurGroup()?this.showRightMenu("holeGroup","holeGroup",e.x,e.y):this.hideRightMenu()},setAdjacentPoints:function(){var e=this.selectedItem.index,t=this.dataList.Graph.length,a=0===e?t-1:e-1,i=e===t-1?0:e+1,n=this.dataList.Graph[a],s=this.dataList.Graph[i];if("Point"===n.node&&"Point"===s.node){var o=[getPoint(n),getPoint(this.selectedItem.node),getPoint(s)],r=o[0],c=o[1],l=o[2],d=math2d.threePointsClockwise(r,c,l);0===d?this.updateRightPointMenu("水平点"):this.updateRightPointMenu("转折点"),this.isBanPointMenu=!1,this.adjacent3Nodes={last:n,center:this.selectedItem.node,next:s}}else this.isBanPointMenu=!0},point2Angle:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30;if(this.adjacent3Nodes&&!this.isBanPointMenu){var i="rightAngle"===e?3:2,n=this.adjacent3Nodes,s=[getPoint(n.last),getPoint(n.center),getPoint(n.next)],o=s[0],r=s[1],c=s[2],l=c.x-o.x,d=c.y-o.y,u=math2d.threePointsClockwise(o,r,c);if(u<0&&(l>0&&d>0||l<0&&d<0)||u>0&&(l<0&&d>0||l>0&&d<0)){var h=[a,t];t=h[0],a=h[1]}var p=this.graph.children.indexOf(n.center),f=math2d.getPointsIn2Line(n,i,t,a);this.addMorePoint(f,p),this.graph.update(),this.draw(),this.selectedItem=null}},point2Arc:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"外凸",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;if(this.adjacent3Nodes&&!this.isBanPointMenu){var i=this.adjacent3Nodes,n=math2d.getPointsIn2Line(i,2,a,a),s=n[0],o=getCoordinate(i.center),r=n[1],c=graphUtil.isClockwise(s,o,r);if(0!==c){var l,d=math2d.getAngleBy3Points(s,o,r),u=Math.tan(math2d.toRads(d/2)),h=math2d.round(u*a),p=math2d.getCircleCenter(s,r,h),f=p[0],m=p[1],v=180-d,b=math2d.lineAngle(s.x,s.y,f.x,f.y),g=math2d.lineAngle(s.x,s.y,m.x,m.y);0!==b&&180!==b&&(b=-b),0!==g&&180!==g&&(g=-g);var y=math2d.getLineLength(f.x,f.y,o.x,o.y),w=math2d.getLineLength(m.x,m.y,o.x,o.y);c>0&&(t="外凸"===t?"内凹":"外凸");var x="外凸"===t?1:-1,C=c>0?1:-1,k=y>w?1:-1,N=x*C*k;l=N<0?b:g,"内凹"===t&&(v*=-1),l=math2d.round(l);var _={node:"Point",attr:{X:{formula:s.x,value:s.x},Y:{formula:s.y,value:s.y},Hotspot:{formula:"1",value:"1"},IsDim:{formula:"0",value:"0"}}},H={node:"Point",attr:{X:{formula:r.x,value:r.x},Y:{formula:r.y,value:r.y},Hotspot:{formula:"1",value:"1"},IsDim:{formula:"0",value:"0"}}},S={node:"Arc",attr:{X:{formula:s.x,value:s.x},Y:{formula:s.y,value:s.y},R:{formula:h,value:h},StartAngle:{formula:l,value:l},Angle:{formula:v,value:v},Hotspot:{formula:"0",value:"0"},IsDim:{formula:"0",value:"0"}}},A=[_,S,H],B=this.graph.children.indexOf(i.center);this.addUndo(),(e=this.graph.children).splice.apply(e,[B,1].concat(A)),this.graph.update(),this.updateFbViewData(),this.draw(),this.selectedItem=null}}},addPoint:function(e,t,a){var i={node:"Point",attr:{X:{formula:e,value:e},Y:{formula:t,value:t},Hotspot:{formula:"1",value:"1"},IsDim:{formula:"0",value:"0"}}};this.addUndo(),this.dataList.Graph.splice(a,0,i),this.updateFbViewData()},addMorePoint:function(e,t){var a,i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"replace",s=[];(e.forEach((function(e){var t=math2d.round(e.x,4),a=math2d.round(e.y,4);s.push({node:"Point",attr:{X:{formula:t,value:t},Y:{formula:a,value:a},Hotspot:{formula:"1",value:"1"},IsDim:{formula:"0",value:"0"}},guid:ObjUtil.guid})})),this.addUndo(),"replace"===n)&&(a=this.graph.children).splice.apply(a,[t,1].concat(s));"insert"===n&&(i=this.graph.children).splice.apply(i,[t,0].concat(s));this.updateFbViewData()},importDataStrEvent:function(){var e=this;bdDecode.event.bdStrImport.replaceSubcribe((function(t){if("x2d"===t.fileType)e.loadX2d(t.str,t.fileName);else if("dxf"===t.fileType)if(t.cfg&&t.cfg.isToPath){var a=H.dxfToPath(t.str);a.attr.name=t.fileName.replace(".dxf",""),e.importPathData(a)}else{var i=H.dxfToBd(t.str);if(t.cfg.onlySetGraph){var n=e.getSize(),s=n.bl,o=n.bw,r=i.attr.L,c=i.attr.W;if(i.errorMsg)return void e.$message({type:"info",message:i.errorMsg});if(s!==r||o!==c)return void e.$message({type:"info",message:"导入图形尺寸为".concat(r,"*").concat(c,"(显示参考").concat(s,"*").concat(o,"),与BD不一致")});e.addUndo()}BDUtils.changeData(i,t.cfg.onlySetGraph),e.resetData()}else if("path"===t.fileType){var l=XmlUtil.toJson(t.str)[0];e.importPathData(l)}else"bd"===t.fileType&&e.loadBd(t.str,t.fileName)}),"AppRight")},importDataEvent:function(){bdDecode.event.bdImport.replaceSubcribe((function(e){var t=readFile(e.fileType),a="";t.then((function(e){var t=e.files[0];return a=t.name,decodeFile(t,"text","utf-8")})).then((function(t){bdDecode.event.bdStrImport.emit({str:t,fileName:a,fileType:e.fileType,cfg:e.cfg})}))}),"AppRight")},importData:function(e,t){bdDecode.event.bdImport.emit({fileType:e,cfg:t})},importPathData:function(e){var t=this;"string"===typeof e&&(e=XmlUtil.toJson(e)[0]),this.$bus.$emit("openDialog",{type:"editAttr",target:e.attr,editKeys:["L","W"],callback:function(a){e.attr.L=a.L,e.attr.W=a.W,hcEditLabel.addTempHC("path",e.attr),hcEditLabel.tempHC.Face=t.curFace,t.isAddHC=!0}})},loadXmlDataEvent:function(){var e=this;bdDecode.event.loadXmlData.replaceSubcribe((function(t){"bd"===t.dataType?e.loadBd(t.data,t.fileName):"x2d"===t.dataType&&e.loadX2d(t.data,t.fileName,t.di)}),"AppRight")},loadXmlData:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"bd",i=arguments.length>3?arguments[3]:void 0;bdDecode.event.loadXmlData.emit({data:e,fileName:t,dataType:a,di:i})},loadX2dEvent:function(){var e=this;bdDecode.event.loadX2d.replaceSubcribe((function(t){var a=XmlUtil.toJson(t.x2dXml)[0],i=BDUtils.x2dToBd(a),n=t.filename.replace(/\.x2d/,"")||"";e.updateBdJson(i,n),e.$bus.$emit("addHCBtnState",{isBanBtn:!1,message:""})}),"AppRight")},loadX2d:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0";bdDecode.event.loadX2d.emit({x2dXml:e,filename:t,di:a})},loadBDEvent:function(){var e=this;bdDecode.event.loadBD.replaceSubcribe((function(t){var a=UnlockBdXML(t.data);e.updateXML(a,t.fileName),e.$bus.$emit("addHCBtnState",{isBanBtn:!1,message:""})}),"AppRight")},loadBd:function(e,t){bdDecode.event.loadBD.emit({data:e,fileName:t})},resetView:function(){transform2d.reset(),transform2d.rotation=cncbacks[this.boardAttr.CncBack],canvas2d.isDisplay&&this.draw()},resetData:function(){this.boardAttr=bdDecode.boardAttr=BDUtils.getBoardAttr(),bdDecode.jGraph=this.graph=new JGraph(canvas2d.ctx,BDUtils.getGraphData(),this.boardAttr),graphUtil.init(this.graph),this.initDataList(),this.resetView()},graphObjToBdJson:function(e){var t=bdDecode.graphObjToBdJson(this.dataList,this.boardAttr,e);return t},editXMLCode:function(){this.$bus.$emit("openXMLCode",this.getBdXml())},getX2d:function(e){if(BDUtils.hasData){var t=this.graphObjToBdJson(),a=BDUtils.bdToX2d(t,e),i=XmlUtil.toXml(a);return i}return""},getBdXml:function(e){if(BDUtils.hasData){var t=this.graphObjToBdJson(e);this.isFromHome&&(t.attr.CncBack=this.orginCncback||t.attr.CncBack);var a=bdDecode.getBDXml(t);return a}return""},changePlane:function(e){var t=this.getX2d(e);this.updateXML(t,this.sName),this.$message({type:"success",message:"平面已转换为".concat(e.toUpperCase(),"平面"),duration:2e3}),this.$bus.$emit("x2dchange",!0)},exportX2d:function(e){var t=BDUtils.saveFile("x2d",this.getX2d(e),this.sName);t&&this.$message({type:"success",message:"导出x2d结束(".concat(e,"平面)"),duration:2e3})},exportBd:function(){var e=this.graphObjToBdJson(),t=XmlUtil.toXml(BDUtils.setBdAttr(e)),a=BDUtils.saveFile("bd",t,this.sName);a&&this.$message({type:"success",message:"导出bd结束",duration:2e3})},exportDxf:function(){var e=[].concat(Object(l["a"])(this.graph.nodes),Object(l["a"])(this.dataList["Face"+this.curFace]||[])),t=BDUtils.exportDxf(H,e,this.sName);t&&this.$message({type:"success",message:"导出dxf结束",duration:2e3})},revoke:function(){var e=this.undoStack.pop();if(e){var t=copyObject(this.dataList);t.Attr=copyObject(this.boardAttr),this.redoStack.push(t),this.loadData(e)}},recover:function(){var e=this.redoStack.pop();if(e){var t=copyObject(this.dataList);this.undoStack.push(t),this.loadData(e)}},cncbackChange:function(e){console.log(ObjUtil.JsonParse(e)),this.boardAttr.CncBack=e.CncBack,0==this.boardAttr.CncBack?this.$bus.$emit("addHCBtnState",{isBanBtn:!1,message:""}):this.$bus.$emit("addHCBtnState",{isBanBtn:!0,message:"请先切换到下靠挡"}),this.setRotation(e.degree)},setRotation:function(e){var t=this;this.graph&&(transform2d.rotation=e,this.graph.nodes.forEach((function(e){"Arc"===e.node&&e.updateAttr()})),["FaceA","FaceB"].forEach((function(e){var a=t.dataList[e].filter((function(e){return"Path"===e.node}));a.forEach((function(e){return e.update()}))})),this.draw())},saveXml:function(){var e=this;return Object(r["a"])(Object(o["a"])().mark((function t(){var a,i,n;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.getBdXml({isClearOutKC:!0}),'<?xml version="1.0" encoding="utf-8"?>'!=a){t.next=4;break}return e.$message({type:"error",message:"请先打开Bd文件",duration:2e3}),t.abrupt("return");case 4:return e.loading=!0,i=new Blob([a],{type:"application/xml"}),t.next=8,Object(x["f"])({id:e.fileId,upload:i,icon:""});case 8:n=t.sent,1==n.state?e.$message({type:"success",message:"保存成功",duration:1e3}):e.$message({type:"error",message:"保存失败",duration:1e3}),e.loading=!1;case 11:case"end":return t.stop()}}),t)})))()},saveAsXml:function(){var e=this.getBdXml({isClearOutKC:!0});'<?xml version="1.0" encoding="utf-8"?>'!=e?(this.ImgResourceState=!0,this.dialogType="saveAsBd"):this.$message({type:"error",message:"请先打开Bd文件",duration:2e3})},saveBdXml:function(e){var t=this;return Object(r["a"])(Object(o["a"])().mark((function a(){var i;return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.loading=!0,e=e||t.getBdXml({isClearOutKC:!0}),e){a.next=5;break}return t.$message({type:"error",message:"xml为空，保存失败",duration:1e3}),a.abrupt("return");case 5:i=LockBdXML(e,""),exportRaw(t.sName+".bd",i),t.loading=!1;case 8:case"end":return a.stop()}}),a)})))()},saveX2d:function(e){var t=this;return Object(r["a"])(Object(o["a"])().mark((function a(){var i,n,s,r;return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.loading=!0,e=e||t.getX2d(),e){a.next=5;break}return t.$message({type:"error",message:"xml为空，保存失败",duration:1e3}),a.abrupt("return");case 5:return i=t.currentX2dData&&t.currentX2dData.groupName||"",n=t.toImgUrl(),s=[{key:t.sName+".x2d",data:e},{key:t.sName+".png",data:n||"",dataType:"png",groupName:i}],a.next=10,Object(g["a"])({data:JSON.stringify(s)});case 10:r=a.sent,1===r.state||1===r.result?t.$message({type:"success",message:"保存成功",duration:1e3}):t.$message({type:"error",message:"保存失败",duration:1e3}),t.$nextTick((function(){t.loading=!1,t.$bus.$emit("x2dchange",!1)}));case 13:case"end":return a.stop()}}),a)})))()},checkHcEditLabel:function(){if(["A","B"].includes(this.curFace)){var e=hcEditLabel.isPointInText(mouse.pos.x,mouse.pos.y);e.isInHLabel?hcEditLabel.hLabel.textSize=16:hcEditLabel.hLabel.textSize=12,e.isInVLabel?hcEditLabel.vLabel.textSize=16:hcEditLabel.vLabel.textSize=12}},showHcEditLabelInput:function(){if(["A","B"].includes(this.curFace)){var e,t,a,i,n=hcEditLabel.isPointInText(mouse.pos.x,mouse.pos.y);if(n.isInHLabel&&(e=hcEditLabel.hLabel.len,t=hcEditLabel.hLabel.textX,a=hcEditLabel.hLabel.textY,i="h"),n.isInVLabel&&(e=hcEditLabel.vLabel.len,t=hcEditLabel.vLabel.textX,a=hcEditLabel.vLabel.textY,i="v"),n.isInHLabel||n.isInVLabel){var s=document.getElementById("setInput"),o=document.getElementsByClassName("input-item")[0];this.editHc.value=e,this.showEditInput=!0,this.inputShow=!0,this.inputFocus(o),this.editHc.direction=i,setDomPosition(s,t,a)}}},setInputValue:function(){var e=this;if(this.showEditInput=!1,this.inputShow=!1,"string"===typeof this.editHc.value&&isNumber(this.editHc.value)){this.addUndo();var t=Number(this.editHc.value||0);isNaN(t)&&(t=0),t%1!=0&&(t=Number(t.toFixed(1)));var a=this.editHc.nodes,i=this.editHc.direction;a.forEach((function(a){var n=hcEditLabel.hLabel.len,s=t-n,o=hcEditLabel.vLabel.len,r=t-o;hcEditLabel.hDist>0&&(s*=-1),hcEditLabel.vDist>0&&(r*=-1),a instanceof Hole&&("h"===i&&(a.X.value+=s,a.X.formula=a.X.value),"v"===i&&(a.Y.value+=r,a.Y.formula=a.Y.value),a.update(e.graph.getLines())),a instanceof Cut&&("h"===i&&(a.X.value+=s,a.X1.value+=s,a.X.formula=a.X.value,a.X1.formula=a.X1.value),"v"===i&&(a.Y.value+=r,a.Y1.value+=r,a.Y.formula=a.Y.value,a.Y1.formula=a.Y1.value))})),hcEditLabel.checkBound(a,this.curFace),this.updateFbViewData(),this.draw()}},setInputValue2:function(e){var t=this.editInput[e],a=t.value-t.oldValue,i=!0;if(0!==a){var n=!1;if(this.addUndo(),"Line"===t.type&&(graphUtil.setLineLen(t),n=!0),"Point"===t.type&&(graphUtil.setLineLenByPoint(t),n=!0),"Arc"===t.type&&(0===parseInt(t.value)?(graphUtil.arcToRightAngle(t.node),n=!0):(i=graphUtil.setArcR(t),n=!0)),n){var s=graphUtil.checkRangeAbnormal();s?this.revoke():(graphUtil.updateGraph(),this.updateFbViewData(),this.draw())}}i&&this.hideInput()},showSelectHCLabel:function(){var e=this,t=this,a=!1,i=hcEditLabel.setSelectedToCurGroup();if(i)hcEditLabel.isShow=!0,hcEditLabel.selectedType=2,this.editHc.nodes=hcEditLabel.curGroup.holes,hcEditLabel.checkBound(this.editHc.nodes,this.curFace),this.tempDataList=copyObject(this.dataList),this.draw();else if(t.selectHC(mouse.pos.x,mouse.pos.y,(function(i,n){var s="Face"+t.curFace;i.isShowLabel=!0,i.isShowCoordinate=!0,t.curNode=i,e.$bus.$emit("selectCanvasNode","Face".concat(e.curFace,"-").concat(n)),e.showHCEditLabel(i),a=!0,t.tempDataList=copyObject(t.dataList),t.selectNodeOriginAttr=t.addNodeAttrCache(i),t.selectedHC={},t.selectedHC[s]=[n]}),(function(e,t){e.isShowLabel=!1,e.isShowCoordinate=!1})),!a){var n=hcEditLabel.isPointInText(mouse.pos.x,mouse.pos.y);n.isInHLabel||n.isInVLabel?hcEditLabel.isShow=!0:hcEditLabel.closeHoleGroup()}},moveSelectHC:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!1!==["A","B"].includes(e.Face)){var a=transform2d.getViewMatrix(),i=mat2d.transformCoord(mouse.pos,mat2d.invert(a));t&&"BHole"===e.node?this.moveAddBhole(e,i):"VHole"!==e.node&&"BHole"!==e.node||this.moveSelectHole(e,i),"Cut"===e.node&&this.moveSelectCut(e,i,a),"Path"===e.node&&this.movePath(e,i,t,a),hcEditLabel.selectedType=1,hcEditLabel.checkBound([e],this.curFace),this.draw()}},moveAddBhole:function(e,t){var a=graphUtil.getAddBholeXY(e,t);e.X.value=e.X.formula=a.x,e.Y.value=e.Y.formula=a.y,e.update()},movePath:function(e,t,a,i){if(a)e.X.value=e.X.formula=math2d.round(t.x),e.Y.value=e.Y.formula=math2d.round(t.y);else{var n=this.getMouseMoveDiff(t,i),s=n.dx,o=n.dy,r=this.selectNodeOriginAttr.X,c=this.selectNodeOriginAttr.Y;e.X.value=e.X.formula=math2d.round(r+s),e.Y.value=e.Y.formula=math2d.round(c+o)}},getMouseMoveDiff:function(e,t){var a=0,i=0;if(this.mousedownLoc){var n=mat2d.transformCoord(this.mousedownLoc,mat2d.invert(t));a=math2d.round(e.x)-n.x,i=math2d.round(e.y)-n.y}return{dx:a,dy:i}},moveSelectHole:function(e,t){if(!e.isSetHoleRange){var a=e.HDirect.formula,i=e.Hole_D?parseInt(e.Hole_D.value):29,n=e.R.value/2;if("VHole"===e.node)e.X.value=e.X.formula=math2d.round(t.x),e.Y.value=e.Y.formula=math2d.round(t.y);else{var s={x:e.X.value,y:e.Y.value},o=graphUtil.getMoveBHoleRange(a,s,n,i);if(o.isAttachLine)"L"!==a&&"R"!==a||t.y>=o.bound.miny&&t.y<=o.bound.maxy&&(e.Y.value=e.Y.formula=math2d.round(t.y)),"U"!==a&&"D"!==a||t.x>=o.bound.minx&&t.x<=o.bound.maxx&&(e.X.value=e.X.formula=math2d.round(t.x));else{var r=graphUtil.getAddBholeXY(e,t);e.X.value=e.X.formula=math2d.round(r.x),e.Y.value=e.Y.formula=math2d.round(r.y)}}e.update()}},moveSelectCut:function(e,t,a){var i,n,s=transform2d.rotation;if(e.CDirect&&(i=e.CDirect.formula),e.Cut_L&&(n=parseInt(e.Cut_L.value)),this.mousedownLoc&&this.selectNodeOriginAttr){var o=this.getMouseMoveDiff(t,a),r=o.dx,c=o.dy,l=this.selectNodeOriginAttr.X,d=this.selectNodeOriginAttr.Y,u=this.selectNodeOriginAttr.X1,h=this.selectNodeOriginAttr.Y1;e.X.value=e.X.formula=math2d.round(l+r),e.Y.value=e.Y.formula=math2d.round(d+c),e.X1.value=e.X1.formula=math2d.round(u+r),e.Y1.value=e.Y1.formula=math2d.round(h+c)}else{var p=e.X.value,f=e.Y.value,m=e.X1.value,v=e.Y1.value,b=!1;e.X.value=e.X.formula=math2d.round(t.x),e.Y.value=e.Y.formula=math2d.round(t.y),i?("水平"!==i||s%360!==0&&180!==s)&&("垂直"!==i||90!==s&&270!==s)||(b=!0):p!==m&&f===v&&(b=!0),b?(e.X1.value=e.X1.formula=e.X.value+n,e.Y1.value=e.Y1.formula=e.Y.value):(e.X1.value=e.X1.formula=e.X.value,e.Y1.value=e.Y1.formula=e.Y.value+n)}e.isEdit=!0},moveHoleGroup:function(){var e=hcEditLabel.curGroup.holes,t=hcEditLabel.tempGroup.holes,a=transform2d.getViewMatrix(),i=mat2d.transformCoord(this.mousedownLoc,mat2d.invert(a)),n=mat2d.transformCoord(mouse.pos,mat2d.invert(a)),s=n.x-i.x,o=n.y-i.y,r=this.graph.getLines();e.forEach((function(e,a){var i=t[a].X.value+s,n=t[a].Y.value+o;e.X.value=e.X.formula=math2d.round(i),e.Y.value=e.Y.formula=math2d.round(n),e.update(r)})),hcEditLabel.checkBound(e,this.curFace),hcEditLabel.setHoleGroupBound(s,o),this.draw()},addHCToDataList:function(){var e=hcEditLabel.tempHC;if(e){var t="Face"+e.Face;this.addUndo(),e.BDUtils=BDUtils,this.dataList[t].push(e),hcEditLabel.clearTempHC(),this.updateFbViewData()}this.isAddHC=!1},copyHCToHcEditLabel:function(){var e=this;if(S.ctrl&&e.curNode)if(hcEditLabel.curGroup){var t=hcEditLabel.curGroup.holes,a=[];t.forEach((function(e){var a=copyObject(e),i=new Hole(a,a.node,BDUtils);i.setNotAuto(1),t.push(i)})),hcEditLabel.curGroup.holes=a}else{var i=copyObject(e.curNode),n="Cut"===i.node?"cut":"hole";hcEditLabel.addTempHC(n,i,e.graph.getLines()),e.isAddHC=!0}},dragSelectHole:function(){if(hcEditLabel.dragging){var e=this.dataList["Face"+this.curFace];hcEditLabel.selectHoleInRect(e,this.curFace)}},addUndo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.dataList,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.boardAttr;function a(e){return"[object Object]"===toString.call(e)}function i(e,t){t=t||new Set;var s=[];return e.forEach((function(e){a(e)?s.push(n(e,t)):Array.isArray(e)?s.push(i(e,t)):s.push(e)})),s}function n(e,t){if(t=t||new Set,t.has(e))return e;if(a(e)){var s=Object.create(null);return Object.keys(e).forEach((function(o){var r=e[o];a(r)?(s[o]=n(r,t),t.add(r)):Array.isArray(r)?(s[o]=i(r,t),t.add(r)):s[o]=r})),s}return Array.isArray(e)?i(e):void 0}e.Attr=n(t);var s=n(e);this.undoStack.push(s),this.redoStack=[],this.$bus.$emit("x2dchange",!0)},loadData:function(e){if(e){var t=this,a=[].concat(Object(l["a"])(e.FaceA),Object(l["a"])(e.FaceB));t.dataList.Graph=e.Graph,t.dataList.FaceA=[],t.dataList.FaceB=[],t.dataList.Attr=t.dataList.Attr||{},t.graph.reset(e.Graph);var i=e.Attr||{};for(var n in i)t.dataList.Attr[n]=i[n],t.boardAttr[n]=i[n];a.forEach((function(e){if("VHole"===e.node||"BHole"===e.node){var a=new Hole(e,e.node,BDUtils);"A"===e.Face?t.dataList.FaceA.push(a):t.dataList.FaceB.push(a)}if("Cut"===e.node){var i=new Cut(e);"A"===e.Face?t.dataList.FaceA.push(i):t.dataList.FaceB.push(i)}if("Path"===e.node){var n=new Path2DX(e);"A"===e.Face?t.dataList.FaceA.push(n):t.dataList.FaceB.push(n)}})),t.updateFbViewData(),hcEditLabel.isShow=!1,t.draw()}},changeViewState:function(){if(this.viewState=1,this.curFace="",this.handleType="",this.nocheckSelect=!1,this.isDraw){var e=this.getSize();i.setPreviewData(this.dataList,e),this.draw()}},btnClick:function(e){switch(e.type){case"增加开槽":this.addNewNode("cut");break;case"增加垂直孔":this.addNewNode("hole",0);break;case"增加大饼孔":this.addNewNode("hole",1);break;case"撤销":this.revoke();break;case"恢复":this.recover();break;case"保存":this.saveXml();break;case"另存为":this.saveAsXml();break;case"保存到主页":this.saveToHome();break;case"清除还原回到主页":this.clearExitToHome();break;case"导出bd":this.exportBd();break;case 8:this.restoreQuit();break;case"导出dxf":this.exportDxf();break;case"导出x2d":this.exportX2d(e.plane);break;case"导入":this.importData(e.fileType,e);break;case"反向排序":this.reverseGraphList();break}},saveToHomeEvent:function(){var e=this;bdDecode.event.saveToHome.replaceSubcribe(Object(r["a"])(Object(o["a"])().mark((function t(){var a,i,n,s,r,c,l,d;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.getBdXml({isClearOutKC:!0}),a){t.next=4;break}return e.$message({type:"warn",message:"数据未加载完，不能保存!"}),t.abrupt("return");case 4:return i=N()(a)+".bd",n={md5:i,data:a,bomName:e.dataFromMainApp.bomName,label:e.dataFromMainApp.label},t.prev=6,t.next=9,HgServiceTool.saveBDToCache(n);case 9:s=t.sent,console.log("缓存BD结果",s,n),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](6),console.log("保存bd到缓存失败",t.t0);case 16:return r=new Blob([a],{type:"text/html"}),t.next=19,Object(x["e"])({upload:r,dirName:"@USER_DATA",fileName:i,icon:"",type:"BD",bomName:n.bomName,label:n.label});case 19:if(c=t.sent,1!=c.state){t.next=31;break}if(l=bdDecode.isSameSize(a),l){t.next=25;break}return e.$message.error("整体尺寸已经不一样,请恢复原来的尺寸"),t.abrupt("return");case 25:d=bdDecode.checkAppBDUI(e.getBdXml()),window.opener.UIAction.SetDataFromBD({name:i,guid:e.blockGuid,checkData:d}),window.opener.gBomWorker&&(console.log("gBomWorker",e.$gData.qdsoftId),window.opener.gBomWorker.postMessage({method:"UpdateBD",qdsoftid:e.$gData.qdsoftId,data:a,fileName:i,path:"@USER_DATA//"+i})),window.close(),t.next=32;break;case 31:e.$message.error("保存失败，请重试");case 32:case"end":return t.stop()}}),t,null,[[6,13]])}))),"AppRight")},saveToHome:function(){return Object(r["a"])(Object(o["a"])().mark((function e(){return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,bdDecode.event.saveToHome.asyncEmit();case 2:return e.abrupt("return");case 3:case"end":return e.stop()}}),e)})))()},clearExitToHomeEvent:function(){var e=this;bdDecode.event.clearExitToHome.replaceSubcribe(Object(r["a"])(Object(o["a"])().mark((function t(){var a;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=bdDecode.getClearCheckAppBDUI(),window.opener.UIAction.SetDataFromBD({name:e.originFileName,guid:e.blockGuid,checkData:a}),window.close();case 3:case"end":return t.stop()}}),t)}))),"AppRight")},clearExitToHome:function(){var e=this;return Object(r["a"])(Object(o["a"])().mark((function t(){return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:console.log("清除还原:","保存的名称："+e.originFileName,e.blockGuid),e.$confirm("确定是否清除还原?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(r["a"])(Object(o["a"])().mark((function e(){return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,bdDecode.event.clearExitToHome.asyncEmit();case 2:return e.abrupt("return");case 3:case"end":return e.stop()}}),e)})))).catch((function(){}));case 2:case"end":return t.stop()}}),t)})))()},moveByKeyBoard:function(e,t){1===hcEditLabel.selectedType?this.moveHoleByKeyBoard(this.curNode,e,t):2===hcEditLabel.selectedType&&this.moveHolesBykeyBoard(e,t)},moveHoleByKeyBoard:function(e,t,a){if("VHole"===e.node)e.X.value+=t,e.Y.value+=a;else{if("BHole"!==e.node)return;var i=e.HDirect.formula;"L"!==i&&"R"!==i||(e.Y.value+=a),"U"!==i&&"D"!==i||(e.X.value+=t)}e.X.formula=e.X.value,e.Y.formula=e.Y.value,e.update(this.graph.getLines()),hcEditLabel.checkBound([e],this.curFace),this.draw()},moveHolesBykeyBoard:function(e,t){var a=hcEditLabel.curGroup.holes,i=this.graph.getLines();a.forEach((function(a){a.X.value+=e,a.Y.value+=t,a.X.formula=a.X.value,a.Y.formula=a.Y.value,a.update(i)})),hcEditLabel.checkBound(a,this.curFace),hcEditLabel.setHoleGroupBound2(e,t),this.draw()},holeGroupRightMenu:function(e){switch(e){case"copy":hcEditLabel.copyCurGroup(this.graph.getLines());break;case"stick":this.stickHoleGroup();break;case"group":case"ungroup":hcEditLabel.setGroup(e);break;case"delete":this.deleteHolegroup();break}},stickHoleGroup:function(){var e,t=hcEditLabel.copyHoleGroup.holes,a=[];t.forEach((function(e){var t=new Hole(e,e.node,BDUtils);t.setNotAuto(1),a.push(t)})),this.addUndo(),hcEditLabel.addHoleGroup(this.curFace,a),(e=this.dataList["Face"+this.curFace]).push.apply(e,a),this.updateFbViewData(),this.draw()},deleteHolegroup:function(){for(var e=hcEditLabel.getGroupHoleId(),t=this.dataList["Face"+this.curFace],a=0;a<t.length;a++){var i=t[a].id;e.indexOf(i)>-1&&(t.splice(a,1),a--)}hcEditLabel.deleteHoleGroup(),hcEditLabel.closeHoleGroup()},addNodeAttrCache:function(e){var t=e.node,a={Cut:["X","Y","X1","Y1"],Path:["X","Y"]},i={type:t},n=a[t];return n&&n.forEach((function(t){var a=e[t].value;i[t]=a})),i},stick:function(){},showGraphEditInput:function(e){var t=e.type;if("Line"===t){var a=e.node,i=graphUtil.getNearNode(a),n=i.pre,s=i.next;if("Arc"===n.type||"Arc"===s.type)return;this.showLineInput("edit1","Line",n.node,a,"pre"),this.showLineInput("edit2","Line",s.node,a,"next")}else"Arc"===t?this.showArcInput(e.node):"Point"===t&&this.showPointInput(e.node)},showLineInput:function(e,t,a,i,n){if("Line"===t){var s=a.lineType();if("斜"!==s){var o=a.label.getTextRect(),r=document.getElementById(e),c=this.editInput[e];c.lineType=a.lineType(),c.value=a.len,c.oldValue=a.len,c.show=!0,c.selectNode=i,c.node=a,c.type="Line",c.position=n,setDomPosition(r,o.x,o.y)}}this.inputShow=!0},showPointInput:function(e){var t=graphUtil.getLine(e,"p2");if(t){var a=graphUtil.getNearNode(t).next.node,i=t.lineType();if("斜"!==i&&"Line"===a.node){var n=t.label.getTextRect(),s=document.getElementById("edit1"),o=this.editInput["edit1"];o.value=t.len,o.oldValue=t.len,o.type="Point",o.node=t,o.show=!0,o.lineType=t.lineType(),setDomPosition(s,n.x,n.y),this.inputShow=!0,this.inputFocus(s)}}},showArcInput:function(e){var t=graphUtil.arcNearLineType(e);if(1===t.type){var a=e.rLabel.getTextRect(),i=document.getElementById("edit1"),n=this.editInput["edit1"],s=math2d.round(e.r);e.isSelected=!0,n.value=s,n.oldValue=s,n.type="Arc",n.node=e,n.show=!0,setDomPosition(i,a.x,a.y),this.inputShow=!0,this.inputFocus(i),this.draw()}},hideInput:function(){this.showEditInput=!1,this.editInput.edit1.show=!1,this.editInput.edit2.show=!1,this.inputShow=!1},inputFocus:function(e){this.$nextTick((function(){e.select(),e.focus()}))},reverseGraphList:function(){var e=this;this.$confirm("是否对当前所有点进行反向排序?","",{type:"warning",showClose:!1}).then(Object(r["a"])(Object(o["a"])().mark((function t(){return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.addUndo(),reverse(e.graph.children),e.graph.update(),e.draw();case 4:case"end":return t.stop()}}),t)})))).catch((function(){}))},createX2d:function(e){var t=this;this.$confirm("是否覆盖源代码?","",{type:"warning",showClose:!1}).then(Object(r["a"])(Object(o["a"])().mark((function a(){return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.updateXML(e),t.$bus.$emit("x2dchange",!0);case 2:case"end":return a.stop()}}),a)}))))},saveAsPath:function(){if(this.sName){var e=w["b"](this.getX2d(),this.sName);exportRaw(this.sName+".path",e)}},lineToTArc:function(e){var t=this;this.$prompt("设置弦高","",{inputPattern:/^[1-9][0-9]*$/,inputErrorMessage:"请输入大于0的整数",showClose:!1}).then((function(a){var i=a.value,n=Number(i);isNaN(n)?console.error("弦高的值输入格式有误"):t.transformSelectLineToTArc(n,e)}))},transformSelectLineToTArc:function(e,t,a){if(e=Number(e),this.addUndo(),"设置属性"===a){var i=this.rightSelectedItem.node,n=i.attr;n.IsBulge.formula=n.IsBulge.value=t,n.ChordH.formula=n.ChordH.value=e,this.graph.update(i)}else{var s=this.selectedItem.node,o={node:"TArc",attr:{X:s.p1.attr.X,Y:s.p1.attr.Y,X2:s.p2.attr.X,Y2:s.p2.attr.Y,ChordH:{formula:e,value:e},IsBulge:{formula:t,value:t},Hotspot:{formula:"0",value:"0"},IsDim:{formula:"0",value:"0"}}},r=this.graph.children.indexOf(this.selectedItem.node.p2);this.graph.children.splice(r,0,o),this.graph.update()}this.updateFbViewData(),this.draw()},pathManage:function(){this.ImgResourceState=!0},ImgResourceClose:function(){this.ImgResourceState=!1},ImgResourceSuccess:function(e,t,a){var i=this;return Object(r["a"])(Object(o["a"])().mark((function n(){var s,r,c,l,d;return Object(o["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i.loading=!0,"openBd"!=i.dialogType){n.next=9;break}return n.next=4,Object(x["b"])({id:e.id});case 4:s=n.sent,i.fileId=e.id,i.loadBd(s),n.next=19;break;case 9:if("saveAsBd"!=i.dialogType){n.next=19;break}if(c=i.getBdXml(),c){n.next=14;break}return i.$message({type:"warn",message:"数据未加载完，不能保存!"}),n.abrupt("return");case 14:return l=new Blob([c],{type:"text/html"}),n.next=17,Object(x["d"])({upload:l,dirId:t.dirId,fileName:a+".bd",icon:null!==(r=null===e||void 0===e?void 0:e.icon)&&void 0!==r?r:"",type:"BD"});case 17:d=n.sent,1==d.state?i.$message({type:"success",message:"保存成功",duration:1e3}):i.$message({type:"error",message:"保存失败",duration:1e3});case 19:i.ImgResourceClose(),i.loading=!1;case 21:case"end":return n.stop()}}),n)})))()},leftMenuHandle:function(e){"x2d重命名"===e.type&&e.oldName===this.sName&&(this.sName=e.newName)},toImgUrl:function(){if(BDUtils.hasData){var e=canvas2d.canvas2.clientWidth||canvas2d.canvas2.width,t=canvas2d.canvas2.clientHeight||canvas2d.canvas2.height,a=this.getSize(),i=a.bl,n=a.bw,s=.7*transform2d.getScale(i,n,e,t,0),o=transform2d.getMatrix({h:t});o=transform2d.getViewMatrix(o,i,n,[0,0],[e,t],s);var r=[].concat(Object(l["a"])(this.dataList["FaceA"]),Object(l["a"])(this.dataList["FaceB"]));canvas2d.clear2(),this.graph.draw2(canvas2d.ctx2,o),r.forEach((function(e){"Path"===e.node&&e.draw2(canvas2d.ctx2,o)}));var c=canvas2d.toDataUrl();return c}},getFBsByCncback:function(){var e=Number(this.boardAttr.LFB||0),t=Number(this.boardAttr.RFB||0),a=Number(this.boardAttr.UFB||0),i=Number(this.boardAttr.DFB||0),n=BDUtils.transformFbByCncback([a,i,e,t],this.boardAttr.CncBack);return n.map((function(e){return[e,!0]}))},exportPng:function(){var e=[].concat(Object(l["a"])(this.dataList["FaceA"]),Object(l["a"])(this.dataList["FaceB"])),t={textBgColor:"",textColor:"#000",color:"#000"};this.styleMode="导出png",canvas2d.isHideAxis=!0,e.forEach((function(e){e.color="#000",e.setLabelStyle(t)})),this.graph.color="#000",this.graph.setLabelStyle(t),i.setLabelStyle(t),this.draw();var a=canvas2d.canvas.toDataURL("image/png");DomUtil.saveBase64File(a,"".concat(this.sName||"bd",".png")),this.styleMode="默认",canvas2d.isHideAxis=!1,e.forEach((function(e){e.color="#fff",e.setLabelStyle()})),this.graph.color="#fff",this.graph.setLabelStyle(),i.setLabelStyle(),this.draw()},openHoleSlotRule:function(){this.holeSlotRuleState=!0},saveHoleSlotRule:function(){this.holeSlotRuleState=!1},isShowHoleInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;bdDecode.jcanvas.showHoleInfo(e);var a=["A","B"];a.forEach((function(a){var i=t.dataList["Face"+a];i&&i.forEach((function(t){t.isShowInfo=e}))})),n.isShowHoleInfo(e),i.isShowInfo=e,this.draw()},resetBdAttr:function(e,t){Object.assign(e.attr,t);var a=["CA","CB","CC","CD","CE","CF","CG","CH","CI","CJ","CK","CL","CM","CN","CO","CP"];a.forEach((function(a){void 0!==e.attr[a]&&void 0===t[a]&&(e.attr[a]=0)})),console.log(e,t)},resetRect:function(){this.addUndo(),BDUtils.resetRect(this.graph),this.graph.update(),this.updateFbViewData(),this.draw()},addHoleCfg:function(e){BDUtils.addHoleCfgs(e,this.curFace),this.addUndo(),this.updateAllHoleByHoleRule(),this.updateFbViewData(),this.draw()},updateAllHoleByHoleRule:function(){var e,t,a=BDUtils.getHoleShapeDataByHoleRule();function i(e){for(var t=e.length-1;t>0;t--){var a=e[t];2===a.holeType&&e.splice(t,1)}}i(this.dataList["FaceA"]),i(this.dataList["FaceB"]),(e=this.dataList["FaceA"]).push.apply(e,Object(l["a"])(a["A"])),(t=this.dataList["FaceB"]).push.apply(t,Object(l["a"])(a["B"]))},changeOutlineStyleAndCursorStyle:function(e){if(e.isIn){var t=e.item;if("Point"===t.type);else if("Line"===t.type&&(t.node.changeLineStyle(!0),!["addGroupHole","lineToArc"].includes(this.handleType)))if(e.isInLineCenter)canvas2d.setCursor("pointer"),t.node.changeCenterStyle(!0,!0);else{var a=t.node.lineType();t.node.changeCenterStyle(!0,!1),"竖"===a?canvas2d.setCursor("col-resize"):"横"===a&&canvas2d.setCursor("row-resize")}}else canvas2d.setCursor("default")},addGroupHole:function(e,t){var a=this;if("selectSlide"===e)this.handleType="addGroupHole";else if("addHolesByCfg"===e){var i=this.selectedItem.node,n=BDUtils.getHolesByHoleRule(i.len,i.getBox(),t.holeInfo,t.ruleInfoCfg);return this.addUndo(),void n.forEach((function(e){var t=a.curFace;e.Face=t,e["X"].value=calcFormula(e["X"].formula,a.boardAttr),e["Y"].value=calcFormula(e["Y"].formula,a.boardAttr),e.update(),a.dataList["Face"+t].push(e)}))}},openAddholeDialog:function(){this.selectedItem&&this.$bus.$emit("addGroupHole","openAddholeDialog",{direct:this.selectedItem.node.lineType()})},cancelSelectSide:function(){this.handleType="",this.$bus.$emit("closeSelectSlide")},openTransformPointFrom:function(e){this.formType=e,this.form.radius="30",this.form.width="30",this.form.height="30",this.dialogFormVisible=!0},transformPoint:function(){this.dialogFormVisible=!1;var e=Number(this.form.radius||0),t=Number(this.form.width||0),a=Number(this.form.height||0);switch(this.formType){case"斜线":this.point2Angle("line",t,a);break;case"直角":this.point2Angle("rightAngle",t,a);break;case"外凸弧":this.point2Arc("外凸",e);break;case"内凹弧":this.point2Arc("内凹",e);break}},keyboardHandle:function(e){switch(e){case"cancel":this.revoke();break;case"recover":this.recover();break}},showLine2ArcDialog:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"转为圆弧",a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,n=this.dialogVisible_line2arc;e?(n.method=t,n.isBulge=a,n.chordH=i,n.LineToArc=!0):n.LineToArc=!1},updateRightPointMenu:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"所有",t={"所有":[0,1,2,3,4,5],"水平点":[5],"转折点":[1,2,3,4]},a=t[e]||[];this.rightPointMenuList.forEach((function(e,t){a.includes(t)?e.show=!0:e.show=!1})),this.isFromHome&&(this.rightPointMenuList[0].show=!1)},calcFaceCenterMatrix:function(e){var t=this.getSize(),a=t.bl,i=t.bw,n=canvas2d.canvas,s=n.clientWidth,o=n.clientHeight,r=this.curFace,c={L:[s/2,0],R:[s/2,0],U:[0,o/2],D:[0,o/2]},l=c[r]||[0,0];return transform2d.getViewMatrix(e,a,i,l)},getSize:function(){var e=this.boardAttr,t=e.L,a=void 0===t?0:t,i=e.W,n=void 0===i?0:i,s=e.BH,o=void 0===s?0:s;return a=Number(a),n=Number(n),o=Number(o),{bl:a,bw:n,bh:o}},updateFbViewData:function(){if(n){var e=this.getSize(),t=this.dataList,a=t.FaceA,i=t.FaceB;n.setSize(e),n.setPreviewData(this.graph.nodes,a,i)}},updateHCErrorobj:function(){var e=this.errorobjs;if(e){var t=function(e,t,i){if(i){var n=i.Face,o=i.Type,r=i.X,c=i.Y;if(e.Face===n){var l=e.get(["X","Y"]),d=Object(s["a"])(l,2),u=d[0],h=d[1],p=!1;("Hole"===o&&a.includes(e.node)||"Cut"===o&&"Cut"===e.node)&&(p=!0),p&&u===r&&h===c&&e.addErrortag(t)}}},a=["BHole","VHole"],i=[].concat(Object(l["a"])(this.dataList.FaceA),Object(l["a"])(this.dataList.FaceB));e.forEach((function(e){var a=e.errortag,n=e.obj1,s=e.obj2;i.forEach((function(e){t(e,a,n),t(e,a,s)}))}))}}},components:{TopBar:u["a"],LeftMenu:h["a"],Right:p["a"],Attredit:f["a"],XmlCode:m["a"],Dialog:v["a"],imgSource:y["a"],QdInput:C["a"],LineToArc:b["a"]}}}).call(this,a("c8ba"))},c32a:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));a("a9e3");var i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ascending";return function(a,i){var n=a[e]||"",s=i[e]||"";return isNaN(Number(n))||isNaN(Number(s))?"ascending"==t?n.localeCompare(s,"zh-Hans-CN",{sensitivity:"accent"}):s.localeCompare(n,"zh-Hans-CN",{sensitivity:"accent"}):Number(n)==Number(s)?n.length<s.length&&"ascending"==t||n.length>s.length&&"descending"==t?-1:n.length>s.length&&"ascending"==t||n.length<s.length&&"descending"==t?1:0:(n=Number(n),s=Number(s),n<s&&"ascending"==t||n>s&&"descending"==t?-1:n>s&&"ascending"==t||n<s&&"descending"==t?1:0)}}},c967:function(e,t,a){},d287:function(e,t,a){},d320:function(e,t,a){"use strict";a("384e")},d490:function(e,t,a){"use strict";a("91a8")},d804:function(e,t,a){"use strict";a("dd21")},d898:function(e,t,a){e.exports=a.p+"img/中心孔.jpg"},d98e:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dialog-wrap"},[a("el-dialog",{attrs:{title:"修改属性",visible:e.dialogVisibles.editAttr},on:{"update:visible":function(t){return e.$set(e.dialogVisibles,"editAttr",t)}}},[a("div",{staticClass:"edit-input-box"},e._l(e.editAttrs,(function(t,i){return a("div",{key:i,staticClass:"edit-input"},[a("span",{staticClass:"attr-name"},[e._v(e._s(t.label))]),a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1)})),0),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.close}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.configrue}},[e._v("确 定")])],1)])],1)},n=[],s=(a("d3b7"),a("159b"),{props:["Dialog"],data:function(){return{dialogVisibles:{editAttr:!1},labels:{L:"宽",W:"高"},editAttrs:[],targetData:null}},created:function(){this.$bus.$on("openDialog",this.openDialog)},methods:{openDialog:function(e){switch(this.targetData=e,this.targetData.callback=e.callback||function(){},e.type){case"editAttr":this.initEditAttr();break}},initEditAttr:function(){var e=this,t=this.targetData,a=t.editKeys,i=t.target;this.editAttrs=[],a.forEach((function(t){var a=i[t],n=e.labels[t]||t;e.editAttrs.push({label:n,key:t,value:a}),e.dialogVisibles.editAttr=!0}))},configrue:function(){var e={};this.editAttrs.forEach((function(t){e[t.key]=t.value})),this.targetData.callback(e),this.close()},close:function(){for(var e in this.dialogVisibles)this.dialogVisibles[e]=!1;this.targetData=null}}}),o=s,r=(a("8da3"),a("2877")),c=Object(r["a"])(o,i,n,!1,null,null,null);t["a"]=c.exports},dac6:function(e,t,a){"use strict";a.d(t,"c",(function(){return u})),a.d(t,"a",(function(){return h})),a.d(t,"b",(function(){return g}));var i=a("5530"),n=(a("d3b7"),a("bc3a")),s=a.n(n),o=a("4328"),r=a.n(o),c=a("323e"),l=a.n(c),d=(a("a5d8"),a("fa7d"));l.a.configure({ease:"ease",speed:500,showSpinner:!1});var u=!1,h="".concat(location.origin);console.log(h);var p=Object(d["b"])(),f=localStorage.getItem("loginId")||"",m=localStorage.getItem("logName"),v={baseURL:"".concat(location.origin,"/hgsoft_base/BaseGraph"),timeout:6e4,transformRequest:[function(e){return void 0!==e&&"[object FormData]"===[].toString.apply(e)?e:r.a.stringify(e)}]},b=s.a.create(v);b.interceptors.request.use((function(e){return l.a.start(),e}),(function(e){return Promise.reject(e)})),b.interceptors.response.use((function(e){return l.a.done(),{data:e.data,status:e.status}}),(function(e){return l.a.done(),Promise.reject(e)}));function g(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"post";return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0,o=Object(i["a"])(Object(i["a"])({},n),{},{group:"qd_textdata_list_head",qdsoft:p,loginId:f,logName:m});if(t){var r=new FormData;for(var c in o)r.append(c,o[c]);o=r}return b({method:a,url:e,data:o}).then((function(e){return s&&s(e.data),e.data})).catch((function(){return s&&s({result:-1}),{result:-1}}))}}},db04:function(e,t,a){"use strict";a.d(t,"f",(function(){return n})),a.d(t,"e",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"d",(function(){return r})),a.d(t,"c",(function(){return c})),a.d(t,"h",(function(){return l})),a.d(t,"a",(function(){return d})),a.d(t,"g",(function(){return u}));var i=a("dac6"),n=Object(i["b"])("/GetTextKeyList/"),s=Object(i["b"])("/GetTextData/"),o=Object(i["b"])("/SetTextData/"),r=(Object(i["b"])("/SetTextData/"),Object(i["b"])("/DeleteTextKey/")),c=Object(i["b"])("/UpdateTextKey/"),l=Object(i["b"])("/updateBatch/"),d=Object(i["b"])("/addBatch/"),u=Object(i["b"])("/getGroupName/")},dd21:function(e,t,a){},dd71:function(e,t,a){"use strict";a("93e7")},dd7e:function(e,t,a){"use strict";a("d3b7"),a("a434");var i,n=a("2b0e"),s=a("26a1"),o=[],r="@@clickoutsideContext",c=0;function l(e,t,a){return function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!(a&&a.context&&i.target&&n.target)||e.contains(i.target)||e.contains(n.target)||e===i.target||a.context.popperElm&&(a.context.popperElm.contains(i.target)||a.context.popperElm.contains(n.target))||(t.expression&&e[r].methodName&&a.context[e[r].methodName]?a.context[e[r].methodName]():e[r].bindingFn&&e[r].bindingFn())}}!n["default"].prototype.$isServer&&Object(s["a"])(document,"mousedown",(function(e){return i=e})),!n["default"].prototype.$isServer&&Object(s["a"])(document,"mouseup",(function(e){o.forEach((function(t){return t[r].documentHandler(e,i)}))})),t["a"]={bind:function(e,t,a){o.push(e);var i=c++;e[r]={id:i,documentHandler:l(e,t,a),methodName:t.expression,bindingFn:t.value}},update:function(e,t,a){e[r].documentHandler=l(e,t,a),e[r].methodName=t.expression,e[r].bindingFn=t.value},unbind:function(e){for(var t=o.length,a=0;a<t;a++)if(o[a][r].id===e[r].id){o.splice(a,1);break}delete e[r]}}},e19c:function(e,t,a){},e286:function(e,t,a){},e3ac:function(e,t,a){"use strict";a("2acc")},e67d:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var i=a("2909");a("c740"),a("a434"),a("4de4"),a("d3b7");function n(){var e=-1;return function(t,a,n,s){try{if(t&&t.ctrlKey&&n.length>0){var o=n.findIndex((function(e){return e==s}));-1!==o?n.splice(o,1):n.push(s)}else if(t&&t.shiftKey&&n.length>0){var r=a.findIndex((function(t){return t==e})),c=a.findIndex((function(e){return e==s})),l=[Math.min(r,c),Math.max(r,c)];r=l[0],c=l[1],n.splice(0),n.push.apply(n,Object(i["a"])(a.filter((function(e,t){return t>=r&&t<=c}))))}else n.splice(0),n.push(s),e=s}catch(d){}}}},eaa8:function(e,t,a){"use strict";a("c967")},eb89:function(e,t,a){},ec51:function(e,t,a){},ee37:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"b",(function(){return r})),a.d(t,"f",(function(){return c})),a.d(t,"e",(function(){return l})),a.d(t,"d",(function(){return d}));var i=a("dac6"),n="".concat(i["a"],"/hgsoft_base/fileSource/"),s=Object(i["b"])("".concat(n,"getDirData.action")),o=Object(i["b"])("".concat(n,"getResources.action")),r=(Object(i["b"])("".concat(n,"getResourceData.action")),Object(i["b"])("".concat(n,"getResourceDataStr.action"))),c=Object(i["b"])("".concat(n,"saveResourceData.action"),!0),l=Object(i["b"])("".concat(n,"SaveResources.action"),!0),d=Object(i["b"])("".concat(n,"saveResourceAs.action"),!0);Object(i["b"])("".concat(n,"delResource.action"),!0)},ee87:function(e,t,a){e.exports=a.p+"img/default.png"},f48e:function(e,t,a){"use strict";a("baa9")},fa7d:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return n}));a("d3b7"),a("25f0");function i(e){var t=document.createElement("textarea");t.innerHTML=e.toString(),document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}function n(){var e;try{e=window.opener&&window.opener.gMainApp?window.opener.gMainApp:null}catch(n){console.log("获取不到主页传来的gMainApp",n),e=null}var t=JSON.parse(localStorage.getItem("loginCorpInfo")),a=t?t.qdSoftId:"",i=e?e.mQdSoftid:"";return a||i||"009_qdsoft"}},fabb:function(e,t,a){}});