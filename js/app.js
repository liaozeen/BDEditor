(function(e){function t(t){for(var n,s,r=t[0],l=t[1],c=t[2],d=0,h=[];d<r.length;d++)s=r[d],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&h.push(i[s][0]),i[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);u&&u(t);while(h.length)h.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],n=!0,r=1;r<a.length;r++){var l=a[r];0!==i[l]&&(n=!1)}n&&(o.splice(t--,1),e=s(s.s=a[0]))}return e}var n={},i={app:0},o=[];function s(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=n,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(a,n,function(t){return e[t]}.bind(null,n));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var u=l;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0094":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"top-bar-box"}},[e.mode?a("div",e._l(e.getBtnList,(function(t,n){return a("div",{key:n,staticClass:"btnItem"},[a("BtnTips",{attrs:{itemData:t,disabled:t.disabled&&e.isBanBtn}})],1)})),0):a("div",{staticClass:"topDivBox"},[a("div",{staticClass:"topDiv1"},[a("el-tooltip",{attrs:{content:e.filePath,placement:"bottom",effect:"light",disabled:!e.filePath}},[a("el-input",{attrs:{placeholder:"请选择文件夹",size:"mini",disabled:""},model:{value:e.filePath,callback:function(t){e.filePath=t},expression:"filePath"}},[a("template",{slot:"prepend"},[e._v("路径")]),a("el-button",{attrs:{slot:"append",icon:"el-icon-folder-opened"},on:{click:e.selectFolder},slot:"append"})],2)],1)],1),a("div",{staticClass:"topDiv2"},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入文件名",size:"mini",clearable:""},on:{change:function(t){e.nameUpdated=!0}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitPath(t)}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}),e._v(" "+e._s("当前BD文件："+e.curBDName)+" ")],1)])])},i=[],o=(a("4de4"),a("c975"),a("d81d"),a("b0c0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"btnTips-box"},["button"===e.itemData.type?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.itemData.tip||e.itemData.content,placement:"bottom"}},[a("div",{on:{click:function(t){return e.runCallback()}}},[a("el-button",{attrs:{type:"primary",size:"mini",disabled:e.disabled}},[e._v(e._s(e.itemData.content))])],1)]):e._e(),"dropdown"===e.itemData.type?a("el-dropdown",[a("span",{staticClass:"el-dropdown-link"},[e._v(" "+e._s(e.itemData.content)),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.itemData.children,(function(t){return a("el-dropdown-item",{key:t.value},[a("div",{on:{click:function(a){return e.runCallback(t.value)}}},[e._v(" "+e._s(t.content))])])})),1)],1):e._e()],1)}),s=[],r={props:["itemData","disabled"],methods:{runCallback:function(e){this.disabled||this.itemData.method(e)}}},l=r,c=(a("01d3"),a("2877")),u=Object(c["a"])(l,o,s,!1,null,"40e13943",null),d=u.exports;function h(e){if(window["ReadStringFromFile"]){var t=QDLocalApi.ReadStringFromFile(e);if(t)return window.UIAction.loadBd(t),!0}return!1}var p=a("1d74"),m={props:["sName","mode","isFromHome","fromHomeFile","originFileName","otherFrameBtn","isBanBtn"],data:function(){return{btnList:[{type:"button",content:"导入",method:this.importFile},{type:"button",content:"源代码",method:this.openXMLCode},{type:"button",content:"撤销",tip:"撤销(Ctrl + Z)",method:this.revoke},{type:"button",content:"恢复",tip:"恢复(Ctrl + Y)",method:this.recover},{type:"button",content:"导出bd",method:this.exportBd},{type:"button",content:"导出png",method:this.exportPng},{type:"button",content:"导出dxf",method:this.exportDxf},{type:"button",content:"清除退出",method:this.clearExit,disabled:!0},{type:"button",content:"重置为矩形",method:this.resetRect},{type:"button",content:"导入Dxf",method:this.importDxfSetRect,disabled:!0}],rootPath:"",filePath:"",curBDName:"",inputValue:"",nameUpdated:!1,isLocalFile:!1}},computed:{getBtnList:function(){var e=this,t=Object(p["a"])();if(1==(null===t||void 0===t?void 0:t.mode))return this.btnList.filter((function(e){return"源代码"==e.content}));if(this.isFromHome){var a=["保存","清除退出","撤销","恢复","导入Dxf"],n=this.btnList.filter((function(t){var n=a.indexOf(t.content)>-1;return e.isBanBtn&&t.disabled&&(n=!1),n}));return n}return this.otherFrameBtn?this.btnList.filter((function(t){return e.otherFrameBtn.indexOf(t.content)>-1})):this.btnList.filter((function(e){return"清除退出"!=e.content}))}},created:function(){this.filePath=localStorage.getItem("bdPath")||""},methods:{clearExit:function(){this.isFromHome&&this.$bus.$emit("btnClick",{type:"清除还原回到主页"})},save:function(){this.isFromHome?this.$bus.$emit("btnClick",{type:"保存到主页"}):this.$bus.$emit("btnClick",{type:this.isLocalFile?"另存为":"保存"})},saveAs:function(){this.$bus.$emit("btnClick",{type:"另存为"})},openXMLCode:function(){this.$bus.$emit("editXMLCode")},revoke:function(){this.$bus.$emit("btnClick",{type:"撤销"})},recover:function(){this.$bus.$emit("btnClick",{type:"恢复"})},importFile:function(){this.isLocalFile=!0,this.$bus.$emit("btnClick",{type:"导入",fileType:"bd"})},openFile:function(){this.isLocalFile=!1,this.$parent.ImgResourceState=!0,this.$parent.dialogType="openBd"},selectFolder:function(){if(this.rootPath){var e=QDLocalApi.ShowFileDialog("dir",this.rootPath);this.filePath=e||this.filePath,localStorage.setItem("bdPath",this.filePath)}else this.$message({message:"请在QD浏览器打开本页面",type:"warning",duration:1500})},submitPath:function(){if(this.filePath)if(this.inputValue){var e=this.filePath+"\\"+this.inputValue+".bd";"0"==QDLocalApi.FileExists(e)?this.$message({message:"当前文件夹下无此BD文件",type:"info",duration:1500}):this.nameUpdated&&h(e)&&(this.curBDName=this.inputValue,this.inputValue="",this.nameUpdated=!1)}else this.$message({message:"请填写文件名",type:"info",duration:1500});else this.$message({message:"请选择文件夹",type:"info",duration:1500})},exportPng:function(){this.$bus.$emit("exportPng")},exportBd:function(){this.$bus.$emit("btnClick",{type:"导出bd"})},exportDxf:function(){this.$bus.$emit("btnClick",{type:"导出dxf"})},importBds:function(e){readTextFiles({fileType:"bd",encoding:"utf-8"}).then((function(t){var a=t.map((function(e){return{content:UnlockBdXML(e.value),filename:e.name}}));"dxf"===e?bdToDxfs(a):"img"===e?bdToImgs(a):"oldBd"===e&&oldBdToNews(a)}))},bdToDxfs:function(){this.importBds("dxf")},bdToImgs:function(){this.importBds("img")},oldToNews:function(){readTextFiles({fileType:"bd",encoding:"gb2312"}).then((function(e){var t=e.map((function(e){return{content:UnlockBdXML(e.value),filename:e.name}}));oldBdToNews(t)}))},openHoleSlotRule:function(){this.$bus.$emit("openHoleSlotRule")},resetRect:function(){this.$bus.$emit("resetRect")},importDxfSetRect:function(){this.$bus.$emit("btnClick",{type:"导入",fileType:"dxf",onlySetGraph:!0})}},components:{BtnTips:d}},f=m,v=(a("e551"),Object(c["a"])(f,n,i,!1,null,null,null));t["a"]=v.exports},"01d3":function(e,t,a){"use strict";var n=a("e58f"),i=a.n(n);i.a},"0297":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"attr-edit-box-cover"},[a("div",{directives:[{name:"drag",rawName:"v-drag",value:{dom:".header",right:-9999,bottom:-9999},expression:"{ dom: '.header', right: -9999, bottom: -9999 }"}],staticClass:"attr-edit-box"},[a("div",{staticClass:"attr-edit-box-main",attrs:{id:"attredit-box"}},[a("div",{staticClass:"header"},[a("span",{staticClass:"title"},[e._v(e._s(e.title))]),a("span",{staticClass:"close",on:{click:e.cancel}},[a("i",{staticClass:"el-icon-close"})])]),a("div",{staticClass:"box-outer"},[a("div",{staticClass:"left-box"},[e._m(0),a("div",{attrs:{id:"table_body_box"}},[a("table",{attrs:{cellspacing:"0",id:"table_body"}},[e._m(1),a("tbody",e._l(e.attrList,(function(t,n){return a("tr",{key:"attr"+n},[a("td",{staticClass:"bgGray"},[e._v(e._s(t[1]))]),a("td",{staticClass:"form-item bgGray"},[a("span",[e._v(e._s(e.getValueOrFormula(t[0],"value")))])]),a("td",{staticClass:"form-item"},[a("div",{staticStyle:{width:"130px"}},[a("QdInput",{class:e.setClass("formula",t[0]),attrs:{inputType:e.getInputType(t[0]),banInput:e.isReadonly(t[0])||e.datas&&e.datas.rangeKeyNames&&e.datas.rangeKeyNames.includes(t[0]),options:e.getInputOpts(t[0])},on:{change:function(a){return e.editAttr(a,t[0],"formula")}},model:{value:e.nodeData[t[0]]["formula"],callback:function(a){e.$set(e.nodeData[t[0]],"formula",a)},expression:"nodeData[item[0]]['formula']"}})],1)])])})),0)])]),a("footer",["Point"!=e.type&&"属性"==e.title?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.openHoleSection}},[e._v(" 孔位区间")]):e._e(),a("el-button",{staticStyle:{float:"right","margin-left":"10px"},attrs:{type:"primary",size:"small"},on:{click:e.comfirm}},[e._v("确定 ")]),a("el-button",{staticStyle:{float:"right"},attrs:{size:"small"},on:{click:e.cancel}},[e._v("取消")]),e.showFaceRadio?a("div",{staticClass:"selectFace"},[a("div",{staticClass:"radio-box"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.nodeData.Face,expression:"nodeData.Face"}],attrs:{type:"radio",id:"radio-faceA",value:"A"},domProps:{checked:e._q(e.nodeData.Face,"A")},on:{change:function(t){return e.$set(e.nodeData,"Face","A")}}}),a("label",{attrs:{for:"radio-faceA"}},[e._v("A")])]),a("div",{staticClass:"radio-box"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.nodeData.Face,expression:"nodeData.Face"}],attrs:{type:"radio",id:"radio-faceB",value:"B"},domProps:{checked:e._q(e.nodeData.Face,"B")},on:{change:function(t){return e.$set(e.nodeData,"Face","B")}}}),a("label",{attrs:{for:"radio-faceB"}},[e._v("B")])])]):e._e()],1)])])]),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isExpand,expression:"!isExpand"}],staticClass:"variableDiv"},[e._m(2),a("div",{staticClass:"variableBody"},e._l(e.keys,(function(t){return a("span",{key:t,staticClass:"variableSpan"},[e._v(e._s(t+"： "+e.attrs[t]))])})),0)]),a("div",{class:[e.isExpand?"shrink_icon1":"expand_btn1"],on:{click:e.expandHandle}},[a("i",{class:[e.isExpand?"el-icon-arrow-right":"el-icon-arrow-left"]})])]),e.holeSectionState?a("holeSection",{attrs:{type:e.holeSectionType,data:e.holeSectionData},on:{close:e.saveHoleSection}}):e._e()],1)},i=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"table_head_box"}},[a("table",{attrs:{cellspacing:"0",id:"table_head"}},[a("colgroup",[a("col",{attrs:{width:"130",name:"项"}}),a("col",{attrs:{width:"130",name:"值"}}),a("col",{attrs:{width:"130",name:"公式"}})]),a("thead",{attrs:{id:"thead"}},[a("tr",[a("td",[e._v("项")]),a("td",[e._v("值")]),a("td",[e._v("公式")])])])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("colgroup",[a("col",{attrs:{width:"130",name:"项"}}),a("col",{attrs:{width:"130",name:"值"}}),a("col",{attrs:{width:"130",name:"公式"}})])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"variableTop"},[a("span",{staticClass:"title"},[e._v("变量")])])}],o=(a("4de4"),a("4160"),a("caad"),a("c975"),a("a9e3"),a("b680"),a("2532"),a("159b"),a("ad04")),s=(a("ac1f"),a("5319"),"@@dragContext"),r=function(){return window.document.currentStyle?function(e,t){return e.currentStyle[t]}:function(e,t){return getComputedStyle(e,!1)[t]}}(),l=function(e){var t=this,a=this[s],n=e.clientX-a.dx,i=e.clientY-a.dy,o=document.body.clientWidth,r=document.body.clientHeight,l=this.offsetWidth,c=this.offsetHeight;if(0===a.type)n<a.left?n=a.left:n+l+a.right>o&&(n=o-l-a.right),i<a.top?i=a.top:i+c+a.bottom>r&&(i=r-c-a.bottom);else{var u=o-(a.marginL+l+a.right),d=r-(a.marginT+c+a.bottom);n<-a.marginL+a.left?n=-a.marginL+a.left:n>u&&(n=u),i<-a.marginT+a.top?i=-a.marginT+a.top:i>d&&(i=d)}window.requestAnimationFrame((function(){t.style.left="".concat(n,"px"),t.style.top="".concat(i,"px")}))},c=function(){var e=this[s];document.removeEventListener("mousemove",e.mousemoveEvent,!0),document.removeEventListener("mouseup",e.mouseupEvent,!0)},u=function(e){var t=r(e,"left"),a=r(e,"top");return t.includes("%")?(t=+document.body.clientWidth*(+t.replace(/\%/g,"")/100),a=+document.body.clientHeight*(+a.replace(/\%/g,"")/100)):(t=+t.replace(/\px/g,""),a=+a.replace(/\px/g,"")),{left:t,top:a}},d=function(e){var t=e||event,a=this[s],n=0===a.type?this.offsetLeft:u(this).left,i=0===a.type?this.offsetTop:u(this).top;a.dx=t.clientX-n,a.dy=t.clientY-i,document.addEventListener("mousemove",a.mousemoveEvent,!0),document.addEventListener("mouseup",a.mouseupEvent,!0)},h={bind:function(e,t,a){e[s]={type:0,dx:0,dy:0,top:0,left:0,right:0,bottom:0,marginL:0,marginT:0,mousedownEvent:d.bind(e),mousemoveEvent:l.bind(e),mouseupEvent:c.bind(e),windowResizeEvent:function(){var t=u(e),a=t.left,n=t.top;e[s].marginL=e.offsetLeft-a,e[s].marginT=e.offsetTop-n}};var n=a.context,i=null;n.$nextTick((function(){t.value&&(i=n.$el.querySelector(t.value.dom),t.value.top&&(e[s].top=t.value.top),t.value.left&&(e[s].left=t.value.left),t.value.right&&(e[s].right=t.value.right),t.value.bottom&&(e[s].bottom=t.value.bottom),1===t.value.type&&(e[s].type=1)),1==e[s].type&&(e[s].windowResizeEvent(),window.addEventListener("resize",e[s].windowResizeEvent)),i=i||e,i.style.cursor="move",i.addEventListener("mousedown",e[s].mousedownEvent,!0)}))},unbind:function(e,t,a){var n=a.context;if(t.value){var i=n.$el.querySelector(t.value.dom);i&&i.removeEventListener("mousedown",e[s].mousedownEvent,!0)}window.removeEventListener("resize",e[s].windowResizeEvent),delete e[s]}},p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"holeSection",on:{click:function(t){e.menu.state=!1}}},[a("el-dialog",{attrs:{title:"孔位区间",visible:e.$parent.holeSectionState,width:"80%","close-on-click-modal":!1,"modal-append-to-body":!1,"custom-class":"dialogStyle"},on:{"update:visible":function(t){return e.$set(e.$parent,"holeSectionState",t)}}},[a("div",{on:{contextmenu:function(t){return e.openContextmenu(null,null,t)}}},[a("el-table",{ref:"holeSection",staticStyle:{width:"100%"},attrs:{data:e.tableData,height:"400",border:"","highlight-current-row":""},on:{"row-click":e.setCurrentRow,"row-contextmenu":e.openContextmenu}},e._l(e.tableColumn,(function(t){return a("el-table-column",{key:t.prop,attrs:{prop:t.prop,label:t.label,"min-width":t.minWidth,align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(n){return[t.options?a("QdSelect",{attrs:{options:t.options,optionKey:"value",optionLabel:"label"},model:{value:n.row[t.prop],callback:function(a){e.$set(n.row,t.prop,a)},expression:"scope.row[item.prop]"}}):a("QdInput",{attrs:{isNumber:t.isNumber},model:{value:n.row[t.prop],callback:function(a){e.$set(n.row,t.prop,a)},expression:"scope.row[item.prop]"}})]}}],null,!0)})})),1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.$parent.holeSectionState=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveHoleSection}},[e._v("确 定")])],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.menu.state,expression:"menu.state"}],ref:"contextMenu",style:{top:e.menu.top+"px",left:e.menu.left+"px"},attrs:{id:"qd_contextMenu"}},[a("p",{on:{click:e.tableAdd}},[e._v("添加")]),a("p",{on:{click:e.tableDel}},[e._v("删除")]),a("p",{on:{click:e.tableCopy}},[e._v("复制")]),a("p",{on:{click:e.tablePaste}},[e._v("粘贴")])])],1)},m=[],f=(a("45fc"),a("b64b"),a("b85c")),v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"QdSelect"},[a("div",{staticStyle:{width:"100%",height:"100%"}},[e._v(" "+e._s(e.getLabel())+" ")]),a("div",{ref:"iconBox",staticClass:"iconBox",on:{click:e.showSelectHandle}},[a("i",{staticClass:"el-icon-caret-bottom"})]),a("transition",{attrs:{name:"el-zoom-in-top"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.editState,expression:"editState"},{name:"clickoutside",rawName:"v-clickoutside",value:e.blurHandle,expression:"blurHandle"}],ref:"QdSelect",staticClass:"QdSelect_ul",style:e.getStyle,on:{mousewheel:function(e){e.stopPropagation()}}},[0==e.options.length?a("div",{staticClass:"QdSelect_ul_box"},[a("p",{staticClass:"QdSelect_ul_box__empty"},[e._v("无数据")])]):e._e(),a("ul",{staticClass:"QdSelect_ul_box"},e._l(e.getOptions,(function(t,n){return a("li",{key:n,class:{selectClass:(e.optionKey?t[e.optionKey]:t)==e.getValue},attrs:{title:e.getOptionsLabel(t)},on:{click:function(a){return e.clickHandle(t)}}},[e._v(" "+e._s(e.getOptionsLabel(t))+" ")])})),0)])])],1)},g=[],b=(a("7db0"),a("13d5"),a("dd7e")),y={name:"QdSelect",props:{isShowInput:Boolean,row:Object,readonly:Boolean,value:[Number,String],options:{type:Array,default:function(){return[]}},optionKey:"",optionLabel:"",isNumber:{type:Boolean,default:!1},limit:Array,appendToBody:{type:Boolean,default:!1}},data:function(){return{editState:!1,popperElm:null,top:0,left:0,width:100}},methods:{getLabel:function(){var e=this;if(this.optionKey){var t=this.options.find((function(t){return t[e.optionKey]==e.getValue}));return t?t[this.optionLabel]:this.getValue}return this.getValue},getOptionsLabel:function(e){return this.optionLabel?e[this.optionLabel]:e},blurHandle:function(){this.editState=!1},showSelectHandle:function(){this.editState=!this.editState},clickHandle:function(e){var t=this;this.getValue=this.optionKey?e[this.optionKey]:e,this.blurHandle(),this.$nextTick((function(){t.changeHandle()}))},resizeHandle:function(){var e=this.$el.getBoundingClientRect();this.width=e.width,this.left=e.left;var t=this.$refs.QdSelect.clientHeight,a=e.top+e.height;this.top=a+t>document.body.clientHeight?e.top-t:a},changeHandle:function(){this.$emit("change",this.row,this.getValue)}},directives:{clickoutside:b["a"]},watch:{editState:function(e){var t=this;e?(window.addEventListener("resize",this.resizeHandle),document.addEventListener("mousewheel",this.blurHandle),this.$nextTick((function(){t.appendToBody&&t.$el.querySelector(".QdSelect_ul")&&document.body.appendChild(t.$el.querySelector(".QdSelect_ul")),t.resizeHandle()}))):(window.removeEventListener("resize",this.resizeHandle),document.removeEventListener("mousewheel",this.blurHandle))}},components:{QdInput:o["a"]},computed:{getOptions:function(){var e=this;return this.optionLabel?this.options.reduce((function(t,a){return t.some((function(t){return t[e.optionLabel]==a[e.optionLabel]}))||t.push(a),t}),[]):this.options},getValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}},getStyle:function(){return{top:"".concat(this.top,"px"),left:"".concat(this.left,"px"),width:"".concat(this.width,"px")}}},mounted:function(){this.popperElm=this.$refs.iconBox},beforeDestroy:function(){this.appendToBody&&this.$refs.QdSelect&&this.$refs.QdSelect.remove()},destroyed:function(){}},w=y,H=(a("172a"),a("2877")),x=Object(H["a"])(w,v,g,!1,null,"c243354c",null),C=x.exports,_={props:["type","data"],data:function(){return{menu:{state:!1,top:0,left:0},currentRow:null,tableColumn:[],tableData:[],copyData:null}},components:{QdInput:o["a"],QdSelect:C},watch:{},computed:{},created:function(){var e=this;"BHole"==this.type?this.tableColumn=[{label:"区间最小值≥",prop:"Min",isNumber:!0,minWidth:"120"},{label:"区间最大值≤",prop:"Max",isNumber:!0,minWidth:"120"},{label:"孔位方向",prop:"HoleAlign",options:[{label:"L",value:"L"},{label:"W",value:"W"}],default:"L",minWidth:"100"},{label:"X坐标",prop:"X",minWidth:"80"},{label:"Y坐标",prop:"Y",minWidth:"80"},{label:"大饼孔直径",prop:"R",isNumber:!0,minWidth:"100"},{label:"大饼孔深度",prop:"Rdepth",isNumber:!0,minWidth:"100"},{label:"水平孔直径",prop:"Rb",isNumber:!0,minWidth:"100"},{label:"水平孔边距",prop:"Hole_Z",isNumber:!0,minWidth:"100"},{label:"水平孔深度",prop:"Hole_D",isNumber:!0,minWidth:"100"},{label:"水平孔朝向",prop:"HDirect",options:[{label:"左",value:"L"},{label:"右",value:"R"},{label:"上",value:"U"},{label:"下",value:"D"}],minWidth:"100"},{label:"X方向孔间距",prop:"Hole_Xcap",minWidth:"120"},{label:"X方向孔数量",prop:"Holenum_X",isNumber:!0,minWidth:"120"},{label:"Y方向孔间距",prop:"Hole_Ycap",minWidth:"120"},{label:"Y方向孔数量",prop:"Holenum_Y",isNumber:!0,minWidth:"120"},{label:"标识",prop:"Rtype",minWidth:"100"}]:this.tableColumn=[{label:"区间最小值≥",prop:"Min",isNumber:!0,minWidth:"120"},{label:"区间最大值≤",prop:"Max",isNumber:!0,minWidth:"120"},{label:"孔位方向",prop:"HoleAlign",options:[{label:"L",value:"L"},{label:"W",value:"W"}],default:"L",minWidth:"100"},{label:"X坐标",prop:"X",minWidth:"80"},{label:"Y坐标",prop:"Y",minWidth:"80"},{label:"垂直孔直径",prop:"R",isNumber:!0,minWidth:"120"},{label:"垂直孔深度",prop:"Rdepth",isNumber:!0,minWidth:"120"},{label:"X方向孔间距",prop:"Hole_Xcap",minWidth:"120"},{label:"X方向孔数量",prop:"Holenum_X",isNumber:!0,minWidth:"120"},{label:"Y方向孔间距",prop:"Hole_Ycap",minWidth:"120"},{label:"Y方向孔数量",prop:"Holenum_Y",isNumber:!0,minWidth:"120"},{label:"标识",prop:"Rtype",minWidth:"100"}],this.data.forEach((function(t){var a={};e.tableColumn.forEach((function(e){a[e.prop]=t[e.prop]||""})),e.tableData.push(a)}))},methods:{setCurrentRow:function(e,t,a){this.currentRow=e},openContextmenu:function(e,t,a){var n=this;a.stopPropagation(),a.preventDefault(),e&&(this.$refs.holeSection.setCurrentRow(e),this.setCurrentRow(e)),this.menu.event=a,this.menu.state=!0,this.$nextTick((function(){if(null!=n.menu.event){var e=n.$refs.contextMenu,t=document.body.clientHeight,a=document.body.clientWidth,i=e.offsetHeight,o=e.offsetWidth,s=n.menu.event.pageX,r=n.menu.event.pageY;n.menu.top=i+r>t?r-i:r,n.menu.left=o+s>a?s-o:s}}))},tableAdd:function(){var e,t={},a=Object(f["a"])(this.tableColumn);try{for(a.s();!(e=a.n()).done;){var n=e.value;t[n.prop]=n.default||""}}catch(i){a.e(i)}finally{a.f()}this.tableData.push(t)},tableDel:function(){var e=this;this.currentRow&&(this.tableData=this.tableData.filter((function(t){return t!=e.currentRow})))},tableCopy:function(){this.currentRow?this.copyData=JSON.parse(JSON.stringify(this.currentRow)):this.$message({type:"error",message:"请选择复制的行",duration:1e3})},tablePaste:function(){var e=this;this.currentRow?this.copyData?this.tableData.forEach((function(t){return t==e.currentRow&&Object.keys(t).forEach((function(a){return t[a]=e.copyData[a]}))})):this.$message({type:"error",message:"请选择复制的行",duration:1e3}):this.$message({type:"error",message:"请选择粘贴的行",duration:1e3})},saveHoleSection:function(){var e=this;if(this.tableData.some((function(e){return""==e.Min||""==e.Max})))this.$message({type:"warning",message:"区间范围不能为空",duration:1e3});else{var t=JSON.parse(JSON.stringify(this.tableData));t.forEach((function(t){e.tableColumn.forEach((function(e){return e.isNumber&&t[e.prop]&&(t[e.prop]=Number(t[e.prop]))}))})),this.$emit("close",t)}}},mounted:function(){}},k=_,D=(a("5bae"),Object(H["a"])(k,p,m,!1,null,null,null)),N=D.exports,A={props:["datas","type","attrs","title","face"],directives:{drag:h},data:function(){return{nodeData:null,showFaceRadio:!1,showHDirect:!1,showCutDirect:!1,node:nodeAttr,inputOptions:{HDirect:[{label:"左",value:"L"},{label:"右",value:"R"},{label:"上",value:"U"},{label:"下",value:"D"}],CDirect:[{label:"水平",value:"水平"},{label:"垂直",value:"垂直"}],Hotspot:[{label:"是",value:"1"},{label:"否",value:"0"}],IsDim:[{label:"是",value:"1"},{label:"否",value:"0"}],IsBulge:[{label:"是",value:"1"},{label:"否",value:"0"}],IsFill:[{label:"是",value:"1"},{label:"否",value:"0"}]},curInput:null,HDirect:"",CDirect:"",curHcConfigName:"",cutWidth:400,isEdit:!1,unEditKeysByEditAttr:{BHole:["Hole_D"],VHole:[],Point:[],Arc:["StartAngle","Angle"]},unEditKeys:{VHole:[],Point:[],Cut:[]},isExpand:!1,defaultKeys:["L","W","CA","CB","CC","CD","CE","CF","CG","CH","CI","CJ","CK","CL","CM","CN","CO","CP"],holeSectionState:!1,holeSectionType:"",holeSectionData:[]}},components:{QdInput:o["a"],holeSection:N},watch:{HDirect:function(e,t){if(t){this.showHDirect=!1,this.nodeData.HDirect={value:e,formula:e};var a=document.getElementById("HDirect").parentNode.childNodes[0];a.innerHTML=e,this.isEdit=!0}},CDirect:function(e,t){t&&(this.showCutDirect=!1,this.nodeData.CDirect={value:e,formula:e},this.isEdit=!0)}},computed:{handleValidate:function(){console.log(888)},attrList:function(){var e=this,t=this.node[this.type];return"属性"===this.title?"Cut"===this.type?t.filter((function(e){var t=e[0];return"CDirect"!==t&&"Cut_L"!==t})):t:t.filter((function(t){var a=t[0];return"BHole"===e.type?"X"!==a&&"Y"!==a&&"Y1"!==a:"X"!==a&&"Y"!==a&&"X1"!==a&&"Y1"!==a}))},keys:function(){var e=this,t=[];return this.attrs&&this.defaultKeys.forEach((function(a){e.attrs.hasOwnProperty(a)&&t.push(a)})),t}},created:function(){if("属性"===this.title){var e=this.datas.node;"Point"===e||"Arc"===e||"TArc"===e?(this.addLoseAttr(this.datas.attr,e),this.nodeData=copyObject(this.datas.attr)):(this.addLoseAttr(this.datas,e),this.nodeData=copyObject(this.datas)),this.showFaceRadio=!!this.nodeData.Face}else this.nodeData=this.addHoleOrCut(),this.showFaceRadio=!1,this.isEdit=!0},methods:{getValueOrFormula:function(e,t){return this.nodeData[e]||(this.nodeData[e]={value:"",formula:""}),this.nodeData[e][t]},comfirm:function(){var e,t;(this.datas&&this.datas.Face!==this.nodeData.Face&&(this.isEdit=!0),this.isEdit)?("FB"==(null===this||void 0===this||null===(e=this.datas)||void 0===e?void 0:e.Face)?bdDecode.changeFBCutData(this.nodeData):this.nodeData.BDUtils&&(this.nodeData.BDUtils=BDUtils),"FB"==(null===this||void 0===this||null===(t=this.datas)||void 0===t?void 0:t.Face)?this.$emit("close"):this.$emit("close",this.nodeData)):this.$emit("close")},cancel:function(){this.$emit("close")},editAttr:function(e,t,a){if("formula"===a){var n,i,o=null===(n=event)||void 0===n||null===(i=n.currentTarget)||void 0===i?void 0:i.querySelector(".el-input__inner");if(o&&(e.newValue=o.value=ghgjUtil.hgSubZeroFromFormula(e.newValue)),"HDirect"===t||"CDirect"===t)return this.isEdit=!0,void this.setAttr(t,e.newValue,e.newValue);if(""===e.newValue)return this.nodeData[t].formula=0,this.nodeData[t].value=0,void(this.isEdit=!0);var s=this.calculateValue(e.newValue,t);if("number"===typeof s&&(s=Number(s.toFixed(4))),!1!==s&&this.nodeData[t].formula!==s){var r=this.nodeData[t].value;this.isEdit=!0,this.setAttr(t,s,e.newValue),this.editNewAttr(t,r,s)}else this.nodeData[t].formula===s&&(this.isEdit=!0,this.nodeData[t].formula=s,this.nodeData[t].value=s)}},hideSelect:function(){this.showHDirect=!1,this.showCutDirect=!1},calculateValue:function(e,t){var a,n=["HDirect","CutName","Cutter","Rtype"],i=["R","Rb","Holenum_X","Holenum_Y","Cut_L","Hole_Z","Cut_Z"];if(t&&n.indexOf(t)>-1)a=e;else try{a=calcFormula(e,[this.attrs,BDUtils.planeAttr])}catch(o){return this.$message({type:"info",message:"输入值错误，请重新输入",duration:2e3}),!1}if(t&&i.indexOf(t)>-1&&a<0)return this.$message({type:"info",message:"输入值不能为负值，请重新输入",duration:2e3}),!1;try{return null==a?"":a}catch(o){return!1}},addHoleOrCut:function(){var e=this.type,t=this.node[e],a={Face:this.face,node:e};return t.forEach((function(e){a[e[0]]={value:e[2],formula:e[2]}})),"VHole"!==e&&"BHOle"!==e||(a.HDirect={value:"",formula:""}),a},setClass:function(e,t){var a,n,i={selected:!1,bgGray:!1};if("hcConfig"===e&&this.curHcConfigName===t&&(i.selected=!0),"formula"===e){var o=this.getUnEditKeys(this.type);o.indexOf(t)>-1&&(i.bgGray=!0)}return(null===(a=this.datas)||void 0===a?void 0:a.rangeKeyNames)&&(null===(n=this.datas)||void 0===n?void 0:n.rangeKeyNames.includes(t))&&(i.bgGray=!0),i},isReadonly:function(e){var t=this.getUnEditKeys(this.type);return t.indexOf(e)>-1},getUnEditKeys:function(e){var t="属性"===this.title?this.unEditKeysByEditAttr:this.unEditKeys,a=t[e];return a||[]},editNewAttr:function(e,t,a){var n=this.type,i=this.nodeData;if("Cut"===n){var o=a-parseInt(t);if("Cut_L"===e){var s=i["X"].value,r=i["Y"].value,l=i["X1"].value,c=i["Y1"].value;s===l&&r!==c&&(c+=o,i["Y1"].value=c,i["Y1"].formula=c),s!==l&&r===c&&(l+=o,i["X1"].value=l,i["X1"].formula=l)}}if("BHole"===n&&"属性"===this.title){var u=a-parseInt(t);if("Hole_D"===e){var d=i["HDirect"].value,h=0,p=0;"L"===d&&(h=u),"R"===d&&(h=-u),"D"===d&&(p=u),"U"===d&&(p=-u),i["X"].value+=h,i["Y"].value+=p,i["X"].formula=i["X"].value,i["Y"].formula=i["Y"].value}}},setAttr:function(e,t,a){var n=this.nodeData;n[e].value=t,n[e].formula=a,this.updateOtherAttr(e)},updateOtherAttr:function(e){var t=this.nodeData;if("BHole"===t.node&&"属性"===this.title&&("X"===e||"Y"===e||"HDirect"===e)){var a=t["Hole_D"].value,n=t.X.value,i=t.Y.value,o=Number(this.attrs.L)||0,s=Number(this.attrs.W)||0;switch(t.HDirect.value){case"L":a=n;break;case"R":a=o-n;break;case"U":a=s-i;break;case"D":a=i}t["Hole_D"].value=a,t["Hole_D"].formula=a}},getInputType:function(e){switch(e){case"HDirect":case"CDirect":case"Hotspot":case"IsDim":case"IsBulge":case"IsFill":return"el-select"}return"el-input"},getInputOpts:function(e){return this.inputOptions[e]||[]},expandHandle:function(){this.isExpand=!this.isExpand},openHoleSection:function(){var e;this.holeSectionType=this.datas.node,this.holeSectionData=(null===(e=this.datas)||void 0===e?void 0:e.getHoleRanges())||[],this.holeSectionState=!0},saveHoleSection:function(e){this.datas.setHoleRanges(e),this.holeSectionState=!1},addLoseAttr:function(e,t){var a=this.node[t];a&&a.forEach((function(t){var a=t[0],n=t[2]||0;void 0===e[a]&&(e[a]={formula:n,value:n})}))}},mounted:function(){}},S=A,B=(a("0494"),Object(H["a"])(S,n,i,!1,null,"d476b4f8",null));t["a"]=B.exports},"0494":function(e,t,a){"use strict";var n=a("61d8"),i=a.n(n);i.a},"072b":function(e,t,a){},"0c8f":function(e,t,a){},"0ef8":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"QdInput",class:[e.readonly?"unInput_item":""]},[e.editState?a("el-input",{ref:"input",attrs:{readonly:e.readonly,maxlength:e.maxlength},on:{input:e.limitNumber,focus:e.focusHandle,blur:e.blurHandle,change:e.changeHandle},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}):a("div",{staticClass:"Qd-edit__text",on:{click:function(t){return e.toggleHandle("click")},dblclick:function(t){return e.toggleHandle("dblclick")}}},[e.readonly?a("i",{staticClass:"el-readonly el-icon-lock"}):e._e(),e.$slots.default?e._t("default"):a("div",[e._v(e._s(e.getValue))])],2)],1)},i=[],o=(a("a9e3"),a("4d63"),a("ac1f"),a("25f0"),a("5319"),a("3835"));a("c975"),a("b64b"),a("d3b7"),a("466d");var s=function(e){if(null==e)return!0;if("boolean"===typeof e)return!1;if("number"===typeof e)return isNaN(e);if(e instanceof Error)return""===e.message;switch(Object.prototype.toString.call(e)){case"[object String]":case"[object Array]":return!e.length;case"[object File]":case"[object Map]":case"[object Set]":return!e.size;case"[object Object]":return!Object.keys(e).length}return!1};var r={name:"QdInput",props:{isShowInput:Boolean,isFocus:Boolean,readonly:Boolean,value:[String,Number],isNumber:{type:Boolean,default:!1},limit:Array,trigger:{type:String,default:"dblclick"},maxlength:Number,rule:RegExp,emptyDefault:{type:String}},data:function(){return{inputValue:"",editState:!1}},methods:{focusHandle:function(){this.$emit("focus")},toggleHandle:function(e){var t=this;this.readonly||e==this.trigger&&(this.inputValue=this.getValue,this.editState=!0,this.$nextTick((function(){t.$el.querySelector(".el-input__inner")&&t.$el.querySelector(".el-input__inner").focus()})))},blurHandle:function(){if(this.isNumber&&Array.isArray(this.limit)&&this.limit.length>1){var e=Object(o["a"])(this.limit,2),t=e[0],a=e[1];void 0!=a&&this.inputValue>a&&(this.inputValue=a,this.$message({type:"info",message:"最大值是: ".concat(a),duration:1500,customClass:"qd-input-message"})),void 0!=t&&this.inputValue<t&&(this.inputValue=t,this.$message({type:"info",message:"最小值是: ".concat(t),duration:1500,customClass:"qd-input-message"}))}void 0!=this.emptyDefault&&s(this.inputValue)&&(this.inputValue=this.emptyDefault),this.rule&&!this.rule.test(this.inputValue)?this.$message({type:"info",message:"填写规则不符合",duration:1e3,customClass:"qd-input-message"}):this.getValue=this.inputValue,!this.isShowInput&&(this.editState=!1),this.$emit("blur",this.getValue),this.changeHandle(this.getValue)},changeHandle:function(e){this.$emit("change",e)},limitNumber:function(){if(this.isNumber){var e=this.$el.querySelector("input");e.value=e.value.replace(/[^(\-){1}\d.]/g,"").replace(/\.{2,}/g,".").replace(".","$#$").replace(/\./g,"").replace("$#$",".").replace(/\-{2,}/g,"-").replace(/(\d)-/g,"$1").replace("-","$#$").replace(/\-/g,"").replace("$#$","-"),this.getValue=this.inputValue=e.value}}},computed:{getValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},watch:{getValue:{immediate:!0,handler:function(e){this.inputValue=e}}},mounted:function(){var e=this;this.editState=this.isShowInput,this.$nextTick((function(){var t=e.$refs["input"];t&&e.isShowInput&&e.isFocus&&(t.focus(),t.select())}))}},l=r,c=(a("54e7"),a("bd00"),a("2877")),u=Object(c["a"])(l,n,i,!1,null,"7ce184c2",null);t["a"]=u.exports},"0f16":function(e,t,a){},1176:function(e,t,a){},"132f":function(e,t,a){"use strict";var n=a("7413"),i=a.n(n);i.a},"15b6":function(e,t,a){"use strict";var n=a("d2c8"),i=a.n(n);i.a},"16f4":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"imgSource"},[n("div",{directives:[{name:"drag",rawName:"v-drag",value:{dom:".content_header",type:1},expression:"{dom:'.content_header',type:1}"}],staticClass:"imgSrc_content"},[n("div",{staticClass:"content_header"},[n("span",{staticClass:"header_title"},[e._v(e._s(e.getTitle))]),n("i",{staticClass:"el-icon-close",on:{click:e.closeHandle}})]),n("div",{staticClass:"content_main"},[n("div",{staticClass:"main_left"},[n("div",{staticClass:"main_left--header"},[n("el-input",{attrs:{placeholder:"请输入目录",size:"mini"},model:{value:e.seachListText,callback:function(t){e.seachListText=t},expression:"seachListText"}},[n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),n("el-scrollbar",{staticStyle:{height:"100%"},attrs:{"wrap-class":"scrollbar-wrapper"}},[n("div",{staticClass:"main_left--tree"},[n("el-tree",{ref:"tree",attrs:{data:e.tree.data,"node-key":"sName",props:e.tree.defaultProps,"highlight-current":!0,accordion:"","expand-on-click-node":!1,"filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.node;return n("span",{staticClass:"custom-tree-node"},[n("span",[n("i",{staticClass:"el-icon-folder-opened"}),e._v(" "+e._s(a.label)+" ")])])}}])})],1)])],1),n("div",{staticClass:"main_right"},[n("div",{staticClass:"main_right--header"},[n("el-input",{attrs:{placeholder:"请输入文件名",size:"mini"},model:{value:e.seachImgText,callback:function(t){e.seachImgText=t},expression:"seachImgText"}},[n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),n("div",{staticClass:"main_right--body"},[n("el-scrollbar",{staticStyle:{height:"100%"}},e._l(e.getListData,(function(t){return n("div",{key:t.id,class:["imgItem",e.currentImgName==t.sName?"select_img":""],on:{click:function(a){return a.stopPropagation(),e.imgClickHandle(t)}}},[n("el-image",{attrs:{src:t.icon,lazy:""}},[n("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[n("img",{attrs:{src:a("ee87")}})])]),n("div",{staticClass:"imgTitle",attrs:{title:t.sName}},[e._v(e._s(t.sName))]),n("el-popover",{attrs:{placement:"bottom-start",width:"350",trigger:"hover","visible-arrow":!1,"popper-class":"ImgInfo_popper"}},[n("el-image",{attrs:{src:t.icon}},[n("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[n("img",{attrs:{src:a("ee87")}})])]),n("div",{staticClass:"popper_title"},[e._v("名称: "+e._s(t.sName))]),n("i",{staticClass:"el-icon-info img_info",attrs:{slot:"reference"},slot:"reference"})],1)],1)})),0)],1)])]),n("div",{staticClass:"content_footer"},[e.isShowSaveAs?n("el-row",{staticClass:"saveAs_class",attrs:{gutter:10}},[n("el-col",{attrs:{span:10}},[e._v("另存为文件名:")]),n("el-col",{attrs:{span:14}},[n("el-input",{attrs:{size:"mini"},model:{value:e.saveAsText,callback:function(t){e.saveAsText=t},expression:"saveAsText"}})],1)],1):e._e(),n("el-button",{attrs:{size:"mini"},on:{click:e.closeHandle}},[e._v("关闭")]),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.confirmHandle}},[e._v("确认")])],1)])])},i=[],o=(a("4de4"),a("caad"),a("c975"),a("d81d"),a("2532"),a("96cf"),a("1da1")),s=a("32e0"),r=a("ee37"),l={name:"imgSource",data:function(){return{seachListText:"",seachImgText:"",saveAsText:"",currentImgName:"",tree:{query:"",data:[],selectNode:null,defaultProps:{children:"children",label:"sName"}},list:{data:[],query:"",selectArray:[]}}},props:{type:String},watch:{seachListText:function(e){this.$refs.tree.filter(e)}},computed:{getTitle:function(){var e={openBd:"选择文件",saveBd:"保存",saveAsBd:"另存为"};return e[this.type]},isShowSaveAs:function(){return"saveAsBd"==this.type},getListData:function(){var e=this;return this.list.data.filter((function(t){return t.sName.includes(e.seachImgText)||""==e.seachImgText}))}},directives:{drag:s["a"]},methods:{handleInit:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("openBd"!=e.type&&"saveAsBd"!=e.type){t.next=8;break}return t.next=3,Object(r["a"])({type:"BD"});case 3:a=t.sent,1==a.state&&(e.tree.data=a.dataList.map((function(e){return{sName:e.dirName,type:"group",dirId:e.id}}))),e.handleNodeClick(e.tree.data[0]),t.next=9;break;case 8:e.type;case 9:case"end":return t.stop()}}),t)})))()},handleNodeClick:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.seachListText=t.seachImgText="",t.tree.selectNode=e,"openBd"!=t.type&&"saveAsBd"!=t.type){a.next=7;break}return a.next=5,Object(r["c"])({type:"BD",dirId:e.dirId});case 5:n=a.sent,1==n.state?t.list.data=n.dataList.map((function(e){return{sName:e.fileName,id:e.id,dirId:e.dir,icon:e.icon}})):t.$message({type:"error",message:"获取数据失败",duration:1e3,customClass:"messageClass"});case 7:case"end":return a.stop()}}),a)})))()},imgClickHandle:function(e){this.currentImgName=e.sName,this.list.selectArray=[e],this.isShowSaveAs&&(this.saveAsText=e.sName.substring(0,e.sName.indexOf(".")))},confirmHandle:function(){if(this.isShowSaveAs&&""==this.saveAsText)this.$message({type:"error",message:"另存为文件名不能为空",duration:1e3});else{var e=this.list.selectArray[0],t=this.tree.selectNode;this.$emit("onSuccess",e,t,this.saveAsText)}},closeHandle:function(){this.$emit("onClose")},filterNode:function(e,t){return!e||-1!==t.sName.indexOf(e)}},mounted:function(){this.handleInit()}},c=l,u=(a("1a02"),a("29b7"),a("2877")),d=Object(u["a"])(c,n,i,!1,null,"cf2797ac",null);t["a"]=d.exports},"172a":function(e,t,a){"use strict";var n=a("9665"),i=a.n(n);i.a},"1a02":function(e,t,a){"use strict";var n=a("37bf"),i=a.n(n);i.a},"1b88":function(e,t,a){},"1d74":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("ac1f"),a("841c"),a("1276");function n(){var e=location.search.length>0?location.search.substring(1):"",t={},a=e.length?e.split("&"):[],n=null,i=null,o=null,s=0,r=a.length;for(s=0;s<r;s++)n=a[s].split("="),i=decodeURIComponent(n[0]),o=decodeURIComponent(n[1]),i.length&&(t[i]=o);return t}},"20ca":function(e,t,a){"use strict";function n(e,t){var a,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=function(){for(var i=this,o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];if(a&&clearTimeout(a),n){var l=!a;a=setTimeout((function(){a=null}),t),l&&e.apply(this,s)}else a=setTimeout((function(){return e.apply(i,s)}),t)};return i.cancel=function(){clearTimeout(a)},i}a.d(t,"a",(function(){return n}))},2378:function(e,t,a){},"26a1":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));a("c975"),a("a9e3"),a("ac1f"),a("5319"),a("1276");var n=a("2b0e"),i=n["default"].prototype.$isServer,o=(i||Number(document.documentMode),function(){return!i&&document.addEventListener?function(e,t,a){e&&t&&a&&e.addEventListener(t,a,!1)}:function(e,t,a){e&&t&&a&&e.attachEvent("on"+t,a)}}());(function(){!i&&document.removeEventListener})()},"29b7":function(e,t,a){"use strict";var n=a("2378"),i=a.n(n);i.a},"2d1e":function(e,t,a){var n={"./1.jpg":"38f3","./中心孔.jpg":"d898","./前后端等距.jpg":"6161","./均分孔.jpg":"9be2","./靠前对齐.jpg":"3aa0","./靠背对齐.jpg":"bc4d"};function i(e){var t=o(e);return a(t)}function o(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=o,e.exports=i,i.id="2d1e"},"2f03":function(e,t,a){"use strict";var n=a("1b88"),i=a.n(n);i.a},"32e0":function(e,t,a){"use strict";a("caad"),a("ac1f"),a("2532"),a("5319");var n="@@dragContext",i=function(){return window.document.currentStyle?function(e,t){return e.currentStyle[t]}:function(e,t){return getComputedStyle(e,!1)[t]}}(),o=function(e){var t=this,a=this[n],i=e.clientX-a.dx,o=e.clientY-a.dy,s=document.body.clientWidth,r=document.body.clientHeight,l=this.offsetWidth,c=this.offsetHeight;if(0==a.type)i<a.left?i=a.left:i+l+a.right>s&&(i=s-l-a.right),o<a.top?o=a.top:o+c+a.bottom>r&&(o=r-c-a.bottom);else{var u=s-(a.marginL+l+a.right),d=r-(a.marginT+c+a.bottom);i<-a.marginL+a.left?i=-a.marginL+a.left:i>u&&(i=u),o<-a.marginT+a.top?o=-a.marginT+a.top:o>d&&(o=d)}window.requestAnimationFrame((function(){t.style.left="".concat(i,"px"),t.style.top="".concat(o,"px")}))},s=function(){var e=this[n];document.removeEventListener("mousemove",e.mousemoveEvent,!0),document.removeEventListener("mouseup",e.mouseupEvent,!0)},r=function(e){var t=i(e,"left"),a=i(e,"top");return t.includes("%")?(t=+document.body.clientWidth*(+t.replace(/\%/g,"")/100),a=+document.body.clientHeight*(+a.replace(/\%/g,"")/100)):(t=+t.replace(/\px/g,""),a=+a.replace(/\px/g,"")),{left:t,top:a}},l=function(e){var t=e||event,a=this[n],i=0==a.type?this.offsetLeft:r(this).left,o=0==a.type?this.offsetTop:r(this).top;a.dx=t.clientX-i,a.dy=t.clientY-o,document.addEventListener("mousemove",a.mousemoveEvent,!0),document.addEventListener("mouseup",a.mouseupEvent,!0)};t["a"]={bind:function(e,t,a){e[n]={type:0,dx:0,dy:0,top:0,left:0,right:0,bottom:0,marginL:0,marginT:0,mousedownEvent:l.bind(e),mousemoveEvent:o.bind(e),mouseupEvent:s.bind(e),windowResizeEvent:function(){var t=r(e),a=t.left,i=t.top;e[n].marginL=e.offsetLeft-a,e[n].marginT=e.offsetTop-i}};var i=a.context,c=null;i.$nextTick((function(){t.value&&(c=i.$el.querySelector(t.value.dom),t.value.top&&(e[n].top=t.value.top),t.value.left&&(e[n].left=t.value.left),t.value.right&&(e[n].right=t.value.right),t.value.bottom&&(e[n].bottom=t.value.bottom),1==t.value.type&&(e[n].type=1)),1==e[n].type&&(e[n].windowResizeEvent(),window.addEventListener("resize",e[n].windowResizeEvent)),c=c||e,c.style.cursor="move",c.addEventListener("mousedown",e[n].mousedownEvent,!0)}))},unbind:function(e,t,a){var i=a.context;if(t.value){var o=i.$el.querySelector(t.value.dom);o&&o.removeEventListener("mousedown",e[n].mousedownEvent,!0)}window.removeEventListener("resize",e[n].windowResizeEvent),delete e[n]}}},"33c4":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:{"is-viewer":!e.mode},attrs:{id:"right-part-box"}},[a("Canvas2d",{staticClass:"main",attrs:{mode:e.mode}}),a("RightBottomBar",{staticClass:"bottom",attrs:{mode:e.mode}})],1)},i=[],o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"right-bottom-box"},[a("qd-arrow",{attrs:{padding:10,step:300,size:"small"}},[a("div",{staticClass:"btn-area"},[a("div",{staticClass:"btn-area-item"},[a("el-checkbox",{model:{value:e.isShowHoleInfo,callback:function(t){e.isShowHoleInfo=t},expression:"isShowHoleInfo"}},[e._v("显示孔位信息")])],1),a("div",{staticClass:"btn-area-item"},[a("b",[e._v("长度")]),e._v("："+e._s(e.attrs.L||0))]),a("div",{staticClass:"btn-area-item"},[a("b",[e._v("宽度")]),e._v("："+e._s(e.attrs.W||0))]),a("div",{staticClass:"btn-area-item"},[a("b",[e._v("厚度")]),e._v("："+e._s(e.attrs.BH||0))]),a("div",{staticClass:"btn-area-item flex-center"},[a("b",[e._v("靠挡")]),e._v("： "),e.mode?a("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.gearTips,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):a("div",[e._v(" "+e._s(e.gearTips.filter((function(t){return t.value==e.value}))[0].label)+" ")])],1),e._l(e.fbs,(function(t){return a("div",{key:t.key,staticClass:"btn-area-item flex-center"},[a("b",[e._v(e._s(t.label))]),e._v("： "),a("el-input",{attrs:{size:"mini",readonly:!e.mode},nativeOn:{input:function(a){return function(n){return e.eidtBdAttr(a,e.attrs,t.key)}()}},model:{value:e.attrs[t.key],callback:function(a){e.$set(e.attrs,t.key,a)},expression:"attrs[item.key]"}})],1)})),a("div",{staticClass:"btn-area-item"},[a("b",[e._v("备注")]),e._v("： "),a("el-input",{staticStyle:{width:"100px"},attrs:{size:"mini",disabled:""},nativeOn:{input:function(t){return function(a){return e.eidtBdAttr(t,e.attrs,"MEMO",!1)}()}},model:{value:e.attrs.MEMO,callback:function(t){e.$set(e.attrs,"MEMO",t)},expression:"attrs.MEMO"}})],1)],2)]),a("div",{staticClass:"info-box",style:{right:e.isExpand?"-300px":"0"}},[a("div",{staticClass:"expand_btn1",on:{click:e.expandHandle}},[e._v(" 订单信息 "),a("i",{class:e.isExpand?"el-icon-caret-left":"el-icon-caret-right"})]),a("div",{staticClass:"info-main"},[a("el-scrollbar",{staticStyle:{height:"100%"}},e._l(e.showAttrKeys,(function(t){return a("div",{key:t[0],staticClass:"info-item"},[a("div",{staticClass:"label"},[e._v(e._s(t[1]+"："))]),a("el-tooltip",{attrs:{content:e.attrs[t[0]],placement:"bottom",effect:"light","open-delay":500}},[a("div",{staticClass:"value"},[e._v(e._s(e.attrs[t[0]]))])])],1)})),0)],1)])],1)},s=[],r=(a("99af"),a("b64b"),a("ac1f"),a("5319"),a("ad04")),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"resize",rawName:"v-resize",value:e.handleResize,expression:"handleResize"}],class:{QdArrow:!0,"qd-arrow-mini":"mini"==e.size,"qd-arrow-small":"small"==e.size,"qd-arrow-medium":"medium"==e.size},on:{mouseenter:function(t){return e.handleShowArrow(!0)},mouseleave:function(t){return e.handleShowArrow(!1)},mousewheel:e.handleMousewheel}},[a("div",{ref:"main",staticClass:"QdArrow-main",style:e.getMainStyle},[a("div",{directives:[{name:"resize",rawName:"v-resize",value:e.handleResize,expression:"handleResize"}],ref:"container",staticClass:"QdArrow-container",style:e.getStyle},[e._t("default")],2)]),e.isOverFlow?[a("transition",{attrs:{name:e.transition}},[a("button",{directives:[{name:"show",rawName:"v-show",value:e.arrowState,expression:"arrowState"}],staticClass:"QdArrow-button QdArrow-button-left",on:{click:function(t){return e.handleArrow(1)}}},[a("i",{staticClass:"el-icon-arrow-left"})])]),a("transition",{attrs:{name:e.transition}},[a("button",{directives:[{name:"show",rawName:"v-show",value:e.arrowState,expression:"arrowState"}],staticClass:"QdArrow-button QdArrow-button-right",on:{click:function(t){return e.handleArrow(-1)}}},[a("i",{staticClass:"el-icon-arrow-right"})])])]:e._e()],2)},c=[],u=(a("a9e3"),a("20ca")),d=a("eec4"),h=a.n(d),p=function(e,t){var a=300,n=function(){console.log("没有执行方法")};t.value&&(n="function"==typeof t.value?t.value:"function"==typeof t.value.handler?t.value.handler:n,a=parseFloat(t.value.delay)>0?t.value.delay:a),e._v_delay=a,e._v_resize=n},m={bind:function(e,t){p(e,t),e._v_resize_detector=e._v_resize_detector||h()({strategy:"scroll"}),e._v_resize_detector.listenTo(e,Object(u["a"])((function(t){e._v_resize(e)}),e._v_delay))},update:function(e,t){t.value!==t.oldValue&&(delete e._v_resize,p(e,t))},unbind:function(e,t){e._v_resize_detector.uninstall(e),delete e._v_resize_detector,delete e._v_resize,delete e._v_delay}},f={name:"QdArrow",props:{step:{type:Number,default:150},size:{type:String},padding:{type:Number,default:30},transition:{type:String,default:"el-zoom-in-top"}},data:function(){return{isOverFlow:!1,arrowState:!1,moveX:0}},directives:{resize:m},methods:{handleArrow:function(e,t){var a,n,i,o=this.moveX,s=(null!==t&&void 0!==t?t:this.step)*e,r=null===(a=this.$refs.container)||void 0===a?void 0:a.clientWidth,l=null===(n=this.$refs)||void 0===n||null===(i=n.main)||void 0===i?void 0:i.clientWidth;s=-1==e?l-r>s+o?l-r:s+o:o+s>0?0:o+s,this.moveX=s},handleResize:function(){var e,t,a,n=null===(e=this.$refs.container)||void 0===e?void 0:e.clientWidth,i=null===(t=this.$refs)||void 0===t||null===(a=t.main)||void 0===a?void 0:a.clientWidth;this.isOverFlow=i<n,this.isOverFlow?this.moveX<i-n&&(this.moveX=i-n):this.moveX=0},handleShowArrow:function(e){this.arrowState=e},handleMousewheel:function(){if(this.isOverFlow){var e=event.wheelDelta>0?-1:1;this.handleArrow(e,50)}}},computed:{getMainStyle:function(){return{margin:"0 ".concat(this.padding,"px")}},getStyle:function(){return{transform:"translateX(".concat(this.moveX,"px)")}}},mounted:function(){}},v=f,g=(a("ad14"),a("2877")),b=Object(g["a"])(v,l,c,!1,null,"475b992c",null),y=b.exports,w={props:["data","mode"],data:function(){return{curFace:"0",attrs:{},isExpand:!0,isShowHoleInfo:!1,gearTips:[{label:"下靠档(初始状态)",value:0},{label:"上靠档(旋转180度)",value:180},{label:"左靠档(旋转90度)",value:90},{label:"右靠档(旋转270度)",value:270}],planes:[{label:"层板类(XY平面)",value:"XY"},{label:"侧板类(YZ平面)",value:"YZ"},{label:"背板类(XZ平面)",value:"XZ"}],value:0,planeType:"",byParam:{},memo:"",fbs:[{label:"左封边",key:"LFB"},{label:"右封边",key:"RFB"},{label:"上封边",key:"UFB"},{label:"下封边",key:"DFB"},{label:"异形封边",key:"FB"}],showAttrKeys:[["ORDER","订单号"],["GNO","产品号"],["NAME","板件名称"],["Mat","板件材料"],["Color","板件颜色"],["MEMO","备注"],["成品尺寸","成品尺寸"],["Size","开料尺寸"],["TIME","订单日期"],["OrderType","订单类型"],["JXS","经销商"],["JXSADDR","经销商地址"],["JXSPHONE","经销商电话"],["CLIENT","客户名称"],["ProductLevel","产品难度"],["TYPE","板件类型"],["KcFlag","开槽备注"],["Classifyl","分类标签1"],["Classifyl2","分类标签2"],["Classifyl3","分类标签3"],["Classifyl4","分类标签4"],["Classifyl5","分类标签5"],["HoleStr","打孔备注"]]}},components:{QdInput:r["a"],QdArrow:y},created:function(){var e=this;this.attrs=BdAttrs,bdDecode.event.selectFace.replaceSubcribe((function(t){e.curFace!==t&&(e.curFace=t)}),"rightBottomBar")},mounted:function(){var e=this;this.$bus.$on("boarAttr",this.update),this.handleEdit=Object(u["a"])((function(t,a){e.$bus.$emit("editBoard",{key:a,newValue:t[a],oldValue:""})}),500)},watch:{value:function(e,t){this.attrs&&this.$bus.$emit("cncback",{CncBack:cncbacks[this.value],degree:this.value})},isShowHoleInfo:function(){this.$bus.$emit("isShowHoleInfo",this.isShowHoleInfo)}},methods:{update:function(e){var t,a;for(var n in this.memo=null!==(t=null===e||void 0===e?void 0:e.MEMO)&&void 0!==t?t:"",this.planeType=e.planeType?e.planeType.replace(/Plane/,""):"",this.value=cncbacks[e.CncBack],"百叶"===e.type?this.setBYParam(e.Param):this.byParam={},e)this.attrs[n]=e[n];!(null===(a=this.attrs)||void 0===a?void 0:a.MEMO)&&this.$set(this.attrs,"MEMO",""),this.attrs["成品尺寸"]=this.getProductSize(e.L,e.W,e.BH)},changePlane:function(){this.$bus.$emit("changePlane",this.planeType.toLowerCase())},setBYParam:function(e){if(e){var t=parseObjectString(e,/\^/g);this.byParam=t||{},this.byParam.BarH=this.byParam.BarH||""}},changeBYBarH:function(){for(var e="",t=Object.keys(this.byParam),a=0;a<t.length;a++){var n=t[a];e+="^".concat(n,"^:^").concat(this.byParam[n]||"","^"),a!==t.length-1&&(e+=",")}this.attrs["Param"]=e},eidtBdAttr:function(e,t,a){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=e.target;n&&(i.value=i.value.replace(/[^(\-){1}\d.]/g,"").replace(/\.{2,}/g,".").replace(".","$#$").replace(/\./g,"").replace("$#$",".").replace(/\-{2,}/g,"-").replace("-","$#$").replace(/\-/g,"").replace("$#$","-"),t[a]=i.value),this.handleEdit(t,a)},getProductSize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return"".concat(e,"*").concat(t,"*").concat(a)},expandHandle:function(){this.isExpand=!this.isExpand}}},H=w,x=(a("91e5"),Object(g["a"])(H,o,s,!1,null,"08e84ee4",null)),C=x.exports,_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"canvas-box"},on:{dragenter:e.dragenter,dragleave:e.dragleave,dragover:e.dragover,drop:e.fileDrop}},[a("canvas",{ref:"canvas",attrs:{id:"canvas",tabindex:"-1"}}),a("div",{ref:"jcanvas",attrs:{tabindex:"-1"}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.mode,expression:"mode"}],staticClass:"face-select"},[e._l(e.faces,(function(t){return a("div",{staticClass:"face-item",class:{selected:e.state===t},on:{click:function(a){return e.selectFace(t)}}},[e._v(" "+e._s(t)+"面 ")])})),a("div",{staticClass:"face-item",class:{selected:"0"===e.state},on:{click:function(t){return e.selectFace("0")}}},[e._v(" 预览 ")])],2),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowAddBtns,expression:"isShowAddBtns"}],staticClass:"addHC-box"},[e._l(e.btnList,(function(t){return a("el-tooltip",{key:t.content,attrs:{effect:"light",content:t.tip,placement:"left"}},[a("div",{staticClass:"addHC-item",on:{click:function(a){return e.addHC(t.content)}}},[a("i",[e._v(e._s(t.content))])])])})),a("el-tooltip",{attrs:{effect:"light",content:"组合孔",placement:"left"}},[a("div",{staticClass:"addHC-item",on:{click:e.holeCfgHandle}},[a("i",[e._v("孔")])])]),a("el-tooltip",{attrs:{effect:"light",content:"线转圆弧",placement:"left"}},[a("div",{staticClass:"addHC-item",on:{click:e.lineToArcHandle}},[a("i",[e._v("弧")])])])],2),e.holeCfg.state?a("holeCfg",{attrs:{direct:e.direct},on:{close:function(t){e.holeCfg.state=!1}}}):e._e(),e.floatPanel.state?a("div",{staticClass:"panelInfo"},[a("i",{staticClass:"el-icon-info"}),e._v(" "+e._s(e.floatPanel.info)+" ")]):e._e(),e.ImgResourceState?a("ImgResource",{attrs:{"on-close":e.ImgResourceClose,"on-success":e.ImgResourceSuccess,type:"import"}}):e._e()],1)},k=[],D=(a("caad"),a("b0c0"),a("96cf"),a("1da1")),N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"holeCfg",attrs:{loading:e.loading}},[a("div",{directives:[{name:"drag",rawName:"v-drag",value:{dom:"header",type:1},expression:"{dom:'header',type:1}"}],staticClass:"holeCfg_content"},[a("header",[a("span",{staticClass:"header_title"},[e._v("新增组合孔")]),a("i",{staticClass:"el-icon-close",on:{click:e.closeHandle}})]),a("main",[a("el-row",{staticClass:"row_item",attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-row",[a("el-col",{attrs:{span:10}},[e._v("孔位类型:")]),a("el-col",{attrs:{span:14}},[a("el-radio-group",{on:{change:e.holeTypeChange},model:{value:e.holeType,callback:function(t){e.holeType=t},expression:"holeType"}},[a("el-radio",{attrs:{label:"大饼孔"}},[e._v("大饼孔")]),a("el-radio",{attrs:{label:"垂直孔"}},[e._v("垂直孔")])],1)],1)],1)],1)],1),a("el-row",{staticClass:"row_item",attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-row",[a("el-col",{attrs:{span:10}},[e._v("孔位朝向:")]),a("el-col",{attrs:{span:14}},[a("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:e.holeFB.value,callback:function(t){e.$set(e.holeFB,"value",t)},expression:"holeFB.value"}},e._l(e.holeFB.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-row",[a("el-col",{attrs:{span:10}},[e._v("垂直孔边距:")]),a("el-col",{attrs:{span:14}},[a("el-input",{attrs:{placeholder:"请输入内容",size:"mini",disabled:e.getSiteDisable},model:{value:e.holeSite.value,callback:function(t){e.$set(e.holeSite,"value",t)},expression:"holeSite.value"}})],1)],1)],1)],1),a("el-row",{staticClass:"row_item",attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-row",[a("el-col",{attrs:{span:10}},[e._v("孔位信息:")]),a("el-col",{attrs:{span:14}},[a("el-select",{attrs:{placeholder:"请选择",size:"mini"},on:{change:e.holeInfoChange},model:{value:e.holeInfo.value,callback:function(t){e.$set(e.holeInfo,"value",t)},expression:"holeInfo.value"}},e._l(e.getHoleInfoOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1)],1),a("el-row",{staticClass:"row_item",attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-row",[a("el-col",{attrs:{span:10}},[e._v("计算方式")]),a("el-col",{attrs:{span:14}},[a("el-select",{attrs:{size:"mini"},on:{change:e.computeStyleChange},model:{value:e.computeStyle.value,callback:function(t){e.$set(e.computeStyle,"value",t)},expression:"computeStyle.value"}},e._l(e.computeStyle.options,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-row",[a("el-col",{attrs:{span:10}},[e._v("孔位计算规则:")]),a("el-col",{attrs:{span:14}},[a("el-select",{attrs:{placeholder:"请选择",size:"mini",disabled:""==e.computeStyle.value},model:{value:e.holeRule.value,callback:function(t){e.$set(e.holeRule,"value",t)},expression:"holeRule.value"}},e._l(e.getHoleRuleOptions,(function(t){return a("el-popover",{key:t.value,attrs:{placement:"right","open-delay":300,width:"500",trigger:"hover"}},[a("el-image",{attrs:{src:e.getImage(t)}}),a("el-option",{attrs:{slot:"reference",label:t.label,value:t.value},slot:"reference"})],1)})),1)],1)],1)],1)],1),a("div",{staticClass:"ruleInfo"},[a("el-divider",{attrs:{"content-position":"left"}},[e._v("孔位计算规则信息")]),a("el-row",{staticClass:"row_item",attrs:{gutter:10}},e._l(e.ruleInfoCfg,(function(t,n){return a("el-col",{key:n,attrs:{span:12}},[a("el-row",[a("el-col",{attrs:{span:10}},[e._v(e._s(t.label))]),t.isNumber?a("el-col",{attrs:{span:14}},[a("el-input-number",{attrs:{controls:!1,size:"mini",disabled:t.disabled},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1):a("el-col",{attrs:{span:14}},[a("el-input",{attrs:{placeholder:"请输入内容",size:"mini",disabled:t.disabled},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1)],1)],1)})),1)],1)],1),a("footer",[a("el-button",{attrs:{size:"mini"},on:{click:e.closeHandle}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.confirmHandle}},[e._v("确认")])],1)])])},A=[],S=(a("4de4"),a("4160"),a("c975"),a("13d5"),a("dca8"),a("159b"),a("d3b7"),a("dac6")),B={pages:null,totalSize:null,data:[{ID:234,associatedMxHole:"",corpInfoId:"009_qdsoft",holeDepth:13,holeDiameter:12,holeMark:"12#13",holeType:"大饼孔",matchHoleDepth:13,matchHoleDiameter:10,matchHoleMark:"10#13",matchHoleType:"大饼孔",matchName:"",mxHoleDistance:0,name:"大饼孔",smallHoleDepth:34,smallHoleDiameter:8,smallHoleMargin:9999,smallHoleMark:"8#34",updateBy:"李炎通",updateDate:"2023-01-04 11:01:31"},{ID:354,associatedMxHole:"",corpInfoId:"009_qdsoft",holeDepth:13,holeDiameter:10,holeMark:"10#13",holeType:"垂直孔",matchHoleDepth:0,matchHoleDiameter:0,matchHoleMark:"0#0",matchHoleType:"大饼孔",matchName:"",mxHoleDistance:0,name:"胶粒孔",smallHoleDepth:0,smallHoleDiameter:0,smallHoleMargin:0,smallHoleMark:"0#0",updateBy:"李炎通",updateDate:"2023-01-04 11:00:52"}],pageNo:null,pageSize:null,state:1,config:null,info:"成功"},L={pages:null,totalSize:null,data:[{ID:437,averageDistance:"",behindBlank:32,calType:"前后端等距",corpInfoId:"009_qdsoft",expression:"[(L-32-32),(L1-0-0),2]",expressionMemo:"",fixedHoleDistance:0,frontBlank:32,holeDistanceMagnification:0,holeNum:2,minBehindBlank:0,minFrontBlank:0,sketchMap:"",sketchMapMemo:"",updateBy:"李炎通",updateDate:"2023-01-12 16:06:26"},{ID:438,averageDistance:"",behindBlank:32,calType:"前后端等距",corpInfoId:"009_qdsoft",expression:"[(L-32-32),(L1-64-64),4]",expressionMemo:"",fixedHoleDistance:64,frontBlank:32,holeDistanceMagnification:0,holeNum:4,minBehindBlank:0,minFrontBlank:0,sketchMap:"",sketchMapMemo:"",updateBy:"李炎通",updateDate:"2023-01-04 11:03:01"},{ID:440,averageDistance:"",behindBlank:32,calType:"均分孔",corpInfoId:"009_qdsoft",expression:"((L-32-32)/3,2)",expressionMemo:"",fixedHoleDistance:0,frontBlank:32,holeDistanceMagnification:0,holeNum:2,minBehindBlank:0,minFrontBlank:0,sketchMap:"",sketchMapMemo:"",updateBy:"李炎通",updateDate:"2023-01-12 16:06:26"}],pageNo:null,pageSize:null,state:1,config:null,info:"成功"},F="".concat(S["a"],"/hgsoft_base/holeInfo/");function $(e){var t=B;return e==="".concat(F,"getHoleCalRules")&&(t=L),function(){return new Promise((function(e,a){e(t)}))}}var E=S["b"];E=$;var R=E("".concat(F,"getHoleInfos")),T=E("".concat(F,"getHoleCalRules")),I=a("0ef8"),O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"QdSelect"},[a("QdInput",{attrs:{trigger:"click",isNumber:e.isNumber,limit:e.limit,disabled:e.disabled,readonly:e.readonly,isShowInput:e.isShowInput,emptyDefault:e.emptyDefault},on:{blur:e.changeHandle},model:{value:e.getValue,callback:function(t){e.getValue=t},expression:"getValue"}},[e.$slots.label?e._t("label"):a("div",{staticClass:"label_text",staticStyle:{width:"100%",height:"100%"},attrs:{title:e.getLabel()},on:{click:function(){e.readonly&&e.showSelectHandle()}}},[e._v(" "+e._s(e.getLabel())+" ")])],2),a("div",{ref:"iconBox",staticClass:"iconBox",on:{click:e.showSelectHandle}},[a("i",{staticClass:"el-icon-caret-bottom"})]),a("transition",{attrs:{name:"el-zoom-in-top"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.editState,expression:"editState"},{name:"clickoutside",rawName:"v-clickoutside",value:e.blurHandle,expression:"blurHandle"}],ref:"QdSelect",staticClass:"QdSelect_ul",style:e.getStyle,on:{mousewheel:function(e){e.stopPropagation()}}},[0==e.options.length?a("div",{staticClass:"QdSelect_ul_box"},[a("p",{staticClass:"QdSelect_ul_box__empty"},[e._v("无数据")])]):e._e(),a("ul",{staticClass:"QdSelect_ul_box"},e._l(e.getOptions,(function(t,n){return a("li",{key:n,class:{selectClass:e.selectClass(t)},attrs:{title:e.getOptionsLabel(t)},on:{click:function(a){return e.clickHandle(t)}}},[e._v(" "+e._s(e.getOptionsLabel(t))+" ")])})),0)])])],1)},X=[],P=(a("7db0"),a("45fc"),a("b680"),a("dd7e")),j={name:"QdSelect",props:{isShowInput:Boolean,row:Object,disabled:Boolean,readonly:Boolean,value:[Number,String],options:{type:Array,default:function(){return[]}},optionKey:"",optionLabel:"",extraKey:"",isNumber:{type:Boolean,default:!1},limit:Array,appendToBody:{type:Boolean,default:!1},emptyDefault:{type:String}},data:function(){return{editState:!1,popperElm:null,top:0,left:0,width:100}},methods:{selectClass:function(e){return this.optionKey?this.row&&this.extraKey&&this.row[this.extraKey]?e[this.optionKey]==this.row[this.extraKey]:e[this.optionKey]==this.getValue:e==this.getValue},getLabel:function(){var e,t,a=this;if(this.optionKey){var n=this.options.find((function(e){return a.row&&a.extraKey&&a.row[a.extraKey]?e[a.optionKey]==a.row[a.extraKey]:e[a.optionKey]==a.getValue}));t=n?n[this.optionLabel]:this.getValue}else t=this.getValue;return isNaN(Number(t))||-1==(null===(e=String(t))||void 0===e?void 0:e.indexOf("."))?t:Number(t).toFixed(1)},getOptionsLabel:function(e){return this.optionLabel?e[this.optionLabel]:e},blurHandle:function(){this.editState=!1},showSelectHandle:function(){this.disabled?this.editState=!1:this.editState=!this.editState},clickHandle:function(e){var t=this;this.getValue=this.optionKey?e[this.optionKey]:e,this.blurHandle(),this.$nextTick((function(){t.changeHandle()}))},resizeHandle:function(){var e=this.$el.getBoundingClientRect();this.width=e.width,this.left=e.left;var t=this.$refs.QdSelect.clientHeight,a=e.top+e.height;this.top=a+t>document.body.clientHeight?e.top-t:a},changeHandle:function(){this.$emit("change",this.row,this.getValue)}},directives:{clickoutside:P["a"]},watch:{editState:function(e){var t=this;e?(window.addEventListener("resize",this.resizeHandle),document.addEventListener("mousewheel",this.blurHandle),this.$nextTick((function(){t.appendToBody&&t.$el.querySelector(".QdSelect_ul")&&document.body.appendChild(t.$el.querySelector(".QdSelect_ul")),t.resizeHandle()}))):(window.removeEventListener("resize",this.resizeHandle),document.removeEventListener("mousewheel",this.blurHandle))}},components:{QdInput:I["a"]},computed:{getOptions:function(){var e=this;return this.optionLabel?this.options.reduce((function(t,a){return t.some((function(t){return t[e.optionLabel]==a[e.optionLabel]}))||t.push(a),t}),[]):this.options},getValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}},getStyle:function(){return{top:"".concat(this.top,"px"),left:"".concat(this.left,"px"),width:"".concat(this.width,"px")}}},mounted:function(){this.popperElm=this.$refs.iconBox},beforeDestroy:function(){this.appendToBody&&this.$refs.QdSelect&&this.$refs.QdSelect.remove()},destroyed:function(){}},Y=j,M=(a("2f03"),Object(g["a"])(Y,O,X,!1,null,"e50919c4",null)),V=M.exports,U=a("32e0"),z={name:"holeCfg",data:function(){return{loading:!1,computeStyle:{value:"",options:[]},holeRuleData:[],holeInfoData:[],holeType:"大饼孔",holeFB:{value:"",options:[]},holeSite:{value:""},holeInfo:{value:""},holeRule:{value:"",options:[]},ruleInfoCfg:{calType:{label:"计算方式",value:"",disabled:!0,isNumber:!1},holeNum:{label:"孔数量",value:"",disabled:!0,isNumber:!0},behindBlank:{label:"后留空(固定)",value:"",disabled:!0,isNumber:!0},minBehindBlank:{label:"最小后留空",value:"",disabled:!0,isNumber:!0},frontBlank:{label:"前留空(固定)",value:"",disabled:!0,isNumber:!0},minFrontBlank:{label:"最小前留空",value:"",disabled:!0,isNumber:!0},fixedHoleDistance:{label:"两孔间距(固定)",value:"",disabled:!0,isNumber:!0},holeDistanceMagnification:{label:"两孔间距(倍率)",value:"",disabled:!0,isNumber:!0}},holeInfos:{}}},components:{QdInput:I["a"],QdSelect:V},props:{direct:{type:String,default:"横"}},directives:{drag:U["a"]},methods:{computeStyleChange:function(){this.holeRule.value=""},holeInfoChange:function(e){this.holeRule.value=""},holeTypeChange:function(e){this.holeSite.value="",this.holeInfo.value="",this.computeStyle.value="",this.holeRule.value=""},getImage:function(e){var t=JSON.parse(e.value);return a("2d1e")("./".concat(t.calType,".jpg"))},getdisable:function(e,t){if("FB"==t.prop);else if("gap"==t.prop)return"垂直孔"!=e["holeType"]},closeHandle:function(){this.$emit("close")},confirmHandle:function(){var e=this,t=JSON.parse(this.holeInfo.value||{});t["FB"]=this.holeFB.value,t["gap"]=this.holeSite.value||0;var a=t["associatedMxHole"];a&&this.holeInfos[a]&&(t["木肖孔"]=this.holeInfos[a]);var n={holeType:this.holeType,holeFB:this.holeFB.value,holeSite:this.holeSite.value,holeInfo:t,holeRule:this.holeRule.value,ruleInfoCfg:{}};Object.keys(this.ruleInfoCfg).forEach((function(t){n.ruleInfoCfg[t]=e.ruleInfoCfg[t].value})),this.$bus.$emit("addGroupHole","addHolesByCfg",n),this.$emit("close")}},watch:{"holeRule.value":{handler:function(e,t){var a=this,n=""==e?{}:JSON.parse(e);Object.keys(this.ruleInfoCfg).forEach((function(e){var t;(null===n||void 0===n?void 0:n[e])?"calType"==e||"holeNum"==e&&"均分孔"!==n.calType?a.ruleInfoCfg[e].disabled=!0:a.ruleInfoCfg[e].disabled=!1:a.ruleInfoCfg[e].disabled=!0,"均分孔"==(null===n||void 0===n?void 0:n.calType)&&(a.ruleInfoCfg["behindBlank"].disabled=!1,a.ruleInfoCfg["frontBlank"].disabled=!1),a.ruleInfoCfg[e].value=null!==(t=null===n||void 0===n?void 0:n[e])&&void 0!==t?t:""}))}}},computed:{getSiteDisable:function(){return"垂直孔"!=this.holeType},getHoleInfoOptions:function(){var e=this;return this.holeInfoData.filter((function(t){return t.holeType==e.holeType})).reduce((function(e,t){var a={label:null===t||void 0===t?void 0:t.name,value:JSON.stringify(t)};return e.push(a),e}),[])},getHoleRuleOptions:function(){var e=this;return this.holeRuleData.reduce((function(t,a){var n,i;a.calType==e.computeStyle.value&&t.push({label:null!==(n=null===a||void 0===a?void 0:a.expression)&&void 0!==n?n:"",value:null!==(i=JSON.stringify(a))&&void 0!==i?i:""});return t}),[])}},created:function(){var e=this;return Object(D["a"])(regeneratorRuntime.mark((function t(){var a,n,i,o,s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,a=localStorage.getItem("loginId"),t.next=4,R({loginId:a});case 4:if(n=t.sent,1==n.state)for(e.holeInfoData=Object.freeze(n.data),i=0;i<(null===(o=n.data)||void 0===o?void 0:o.length);i++)s=n.data[i],e.holeInfos[s.name]=s;else e.$message.error("获取孔位信息失败");return t.next=8,T({loginId:a});case 8:r=t.sent,1==r.state?(e.holeRuleData=Object.freeze(r.data),e.computeStyle.options=e.holeRuleData.reduce((function(e,t){return-1==e.indexOf(null===t||void 0===t?void 0:t.calType)&&e.push(t.calType),e}),[])):e.$message.error("获取孔位计算规则失败"),e.loading=!1;case 11:case"end":return t.stop()}}),t)})))()},mounted:function(){this.holeFB.options="横"==this.direct?[{label:"UFB",value:"UFB"},{label:"DFB",value:"DFB"}]:[{label:"LFB",value:"LFB"},{label:"RFB",value:"RFB"}]}},G=z,W=(a("e131"),Object(g["a"])(G,N,A,!1,null,"3d51e0b5",null)),K=W.exports,Q=a("85e5"),q=a("db04"),J={props:{mode:Boolean},data:function(){return{faces:["A","B","L","R","U","D"],floatPanel:{state:!1,info:""},direct:"",holeCfg:{state:!1},state:"A",btnList:[{content:"槽",tip:"开槽",method:this.addHC("C")}],ImgResourceState:!1,ImgResourceType:""}},computed:{isShowAddBtns:function(){return["A","B"].includes(this.state)}},mounted:function(){var e=this;canvas2d.init(this.$refs.canvas),mouse.setCanvas(canvas2d.canvas),bdDecode.jcanvas=new JBDCanvas(bdDecode),bdDecode.jcanvas.init(this.$refs.jcanvas),bdDecode.jcanvas.display(!1),this.$bus.$on("addGroupHole",(function(t,a){if("openAddholeDialog"==t){e.holeCfg.state=!0,e.floatPanel.state=!1;var n=a.direct;e.direct=n}})),this.$bus.$on("closeSelectSlide",(function(){e.floatPanel.state=!1}))},methods:{showSelectEdgeInfo:function(){this.floatPanel.state=!0,this.floatPanel.info="选择板件边"},holeCfgHandle:function(){this.showSelectEdgeInfo(),this.$bus.$emit("addGroupHole","selectSlide")},lineToArcHandle:function(){this.showSelectEdgeInfo(),this.$bus.$emit("lineToArc")},selectFace:function(e){this.state=e,this.$bus.$emit("selectFace",e),"0"===e&&this.$bus.$emit("selectCanvasNode","")},addHC:function(e){var t={V:"增加垂直孔",B:"增加大饼孔","槽":"增加开槽"};this.$bus.$emit("btnClick",{type:t[e]})},importPrimitive:function(){this.ImgResourceState=!0},ImgResourceClose:function(){this.ImgResourceState=!1},ImgResourceSuccess:function(e){var t=this;return Object(D["a"])(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e||!e[0]){a.next=5;break}return a.next=3,Object(q["e"])({key:e[0].sName});case 3:n=a.sent,1===n.result&&(i=n.configdata,t.$bus.$emit("importPathData",i));case 5:t.ImgResourceClose();case 6:case"end":return a.stop()}}),a)})))()},dragenter:function(e){e.stopPropagation(),e.preventDefault()},dragleave:function(e){e.stopPropagation(),e.preventDefault()},dragover:function(e){e.stopPropagation(),e.preventDefault()},fileDrop:function(e){var t=this;return Object(D["a"])(regeneratorRuntime.mark((function a(){var n,i,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.stopPropagation(),e.preventDefault(),n=e.dataTransfer.files[0],i=getFileType(n.name),"bd"!==i){a.next=9;break}return a.next=7,decodeFile(n);case 7:o=a.sent,t.$bus.$emit("loadXmlData",o,n.name,"bd");case 9:case"end":return a.stop()}}),a)})))()}},components:{ImgResource:Q["a"],holeCfg:K}},Z=J,ee=(a("d997"),Object(g["a"])(Z,_,k,!1,null,"a3738f18",null)),te=ee.exports,ae={props:{mode:Boolean},components:{RightBottomBar:C,Canvas2d:te}},ne=ae,ie=(a("451e"),Object(g["a"])(ne,n,i,!1,null,"1be2eccc",null));t["a"]=ie.exports},"35cc":function(e,t,a){},"37bf":function(e,t,a){},"38f3":function(e,t,a){e.exports=a.p+"img/1.jpg"},"3aa0":function(e,t,a){e.exports=a.p+"img/靠前对齐.jpg"},"3dd1":function(e,t,a){"use strict";var n=a("0f16"),i=a.n(n);i.a},"3de3":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}]},[a("div",{staticClass:"code-main-box"},[a("div",{ref:"cmEditorWarp",staticClass:"codemirror-warp"},[a("codemirror",{ref:"cmEditor",attrs:{options:e.cmOptions},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}})],1),a("footer",[a("el-button",{on:{click:e.close}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")])],1)])])},i=[],o=a("8f94"),s=(a("a7be"),a("d5e0"),{data:function(){return{isShow:!1,code:"",cmOptions:{tabSize:4,mode:"text/xml",lineNumbers:!0,lineWrapping:!0,line:!0}}},computed:{codemirror:function(){return this.$refs.cmEditor.codemirror}},mounted:function(){var e=this;this.$bus.$on("openXMLCode",(function(t){e.isShow=!0,e.code=t}))},methods:{save:function(){this.$bus.$emit("saveXMLCode",this.code),this.close()},close:function(){this.isShow=!1},setValue:function(e){this.codemirror.setValue(e)}},components:{codemirror:o["codemirror"]}}),r=s,l=(a("8db7"),a("2877")),c=Object(l["a"])(r,n,i,!1,null,null,null);t["a"]=c.exports},"451e":function(e,t,a){"use strict";var n=a("e03b"),i=a.n(n);i.a},4581:function(e,t,a){"use strict";var n=a("6541"),i=a.n(n);i.a},"4f75":function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return s}));a("99af"),a("4de4"),a("caad"),a("a15b"),a("d81d"),a("b0c0"),a("ac1f"),a("2532"),a("466d"),a("1276");var n=a("b85c");function i(e,t,a){var n=parseFormulaXml(e,a),i=r(n);if(i){var o=Object.assign({},n.attr,i.attr);return o.name=t,o.d=c(i.children),l(o,[]),XmlUtil.toXml({node:"Path",attr:o,children:[]})}console.error("x2d数据不完整，没有点弧列表轮廓数据")}function o(e,t){return e.split(";").filter((function(e){return e})).map((function(e){return e.split(",").map((function(e){for(var a=e.split(" "),n=a[0],i=1;i<a.length;i++)n+=" ".concat(calcFormula(a[i],t));return n})).join(",")})).join(";")}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=parseFormulaXml(e,[]);return a.attr.d=o(a.attr.d,[t,a.attr]),a}function r(e){var t,a=Object(n["a"])(e.children);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(i.children.length>0)return i}}catch(o){a.e(o)}finally{a.f()}}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];for(var a in e)(a.match(/^\$+/)||!e[a]&&0!==e[a]&&!1!==e[a])&&delete e[a],t.includes(a)&&delete e[a]}function c(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a="",n=0;n<e.length;n++){var i=e[n].attr;if("Point"===e[n].node?a+=0===n?"m ".concat(i["$X"]," ").concat(i["$Y"],","):"l ".concat(i["$X"]," ").concat(i["$Y"],","):"Arc"===e[n].node?(0===n&&(a+="m ".concat(i["$X"]," ").concat(i["$Y"],",")),a+="a ".concat(i["$X"]," ").concat(i["$Y"]," ").concat(i["$R"]," ").concat(i["$StartAngle"]," ").concat(i["$Angle"],",")):"TArc"===e[n].node&&(0===n&&(a+="m ".concat(i["$X"]," ").concat(i["$Y"],",")),a+="ta ".concat(i["$X"]," ").concat(i["$Y"]," ").concat(i["$X2"]," ").concat(i["$Y2"]," ").concat(i["$ChordH"]," ").concat(i["$IsBulge"],",")),!t&&n===e.length-1){if("Arc"===e[0].node||"Arc"===e[n].node)break;a+="l ".concat(e[0].attr["$X"]," ").concat(e[0].attr["$Y"])}}return a+=";",a}},5403:function(e,t,a){"use strict";var n=a("20ca"),i=a("eec4"),o=a.n(i),s=function(e,t){var a=100,n=function(){console.log("没有执行方法")};t.value&&(n="function"===typeof t.value?t.value:"function"===typeof t.value.handler?t.value.handler:n,a=parseFloat(t.value.delay)>0?t.value.delay:a),e._v_delay=a,e._v_resize=n};t["a"]={bind:function(e,t){s(e,t),e._v_resize_detector=e._v_resize_detector||o()({strategy:"scroll"}),e._v_resize_detector.listenTo(e,Object(n["a"])((function(t){e._v_resize(e)}),e._v_delay))},update:function(e,t){t.value!==t.oldValue&&(delete e._v_resize,s(e,t))},unbind:function(e,t){e._v_resize_detector.uninstall(e),delete e._v_resize_detector,delete e._v_resize,delete e._v_delay}}},"54e7":function(e,t,a){"use strict";var n=a("f6e0"),i=a.n(n);i.a},"551b":function(e,t,a){"use strict";t["a"]='<?xml version="1.0" encoding="utf-8"?>\n<Board L="1200" W="1200" BH="18" CA="500" CB="500" CC="0" CD="0" CE="250" CF="50" CG="0" CH="50" CI="0" CJ="0" CK="0" CL="0" CM="0" CN="0" CO="0" CP="0" ABHoleInfo="C" ABKcInfo="" AlienNum="L2A3" BlockMemo="" BomStd="" CBNO="" CLIENT="张三" CLIENTADDR="XX市" CLIENTMOBILEPHONE="13300000000" CLIENTPHONE="13300000000" Classify1="" Classify2="" Classify3="" Classify4="" Classify5="" CncBack="0" CncBack1="0" Color="001" DESNO="一字型空间" DFB="1.50" DI="1" DesignMemo="" DevCode="" DfbName="H" FB="1.00" FBSTR="4H" FbName="H" GNO="Y0000001" Group="" HASHHOLE="" HoleFlag="" HoleStr="" IsAlien="异形" Iswd="" JXS="客户" JXSADDR="" JXSPHONE="" KcFlag="0" KcStr="" LFB="1.50" LfbName="H" MEMO="" Mat="多层板" Mat2="" Mat3="" NAME="" NumberText="2" ORDER="001" ORDERNUM="" OrderType="衣柜订单" PackNo="" ProductID="" ProductLevel="" ProductNums="" RFB="1.50" RfbName="H" SIZE="1197*1197*18" TIME="" TYPE="柜体" ToHoleDistance="352" UFB="1.50" UNIT="" USER="" UfbName="H" VeneerMat="" WlCode="" WlType="板材" WlUnit="" Workflow="" YHFB="0.00" planeType="Graph">\n<Graph>\n\t<Point X="0" Y="CD" Angle="0" Face="" HDirect="" Hole_Xcap="" Hole_Ycap="" Holenum_X="0" Holenum_Y="0" Hotspot="1" IsDim="0" R="" Rb="" StartAngle="0" X1="" XA="" Y1="" YA=""></Point>\n\t<Point X="0" Y="W-CG" Angle="0" Face="" HDirect="" Hole_Xcap="" Hole_Ycap="" Holenum_X="0" Holenum_Y="0" Hotspot="1" IsDim="0" R="" Rb="" StartAngle="0" X1="" XA="" Y1="" YA=""></Point>\n\t<Arc X="0" Y="W-CG" Angle="90" Face="" HDirect="" Hole_Xcap="" Hole_Ycap="" Holenum_X="0" Holenum_Y="0" Hotspot="0" IsDim="0" R="CG" Rb="" StartAngle="180" X1="" XA="" Y1="" YA=""></Arc>\n\t<Point X="CG" Y="W" Angle="0" Face="" HDirect="" Hole_Xcap="" Hole_Ycap="" Holenum_X="0" Holenum_Y="0" Hotspot="1" IsDim="0" R="" Rb="" StartAngle="0" X1="" XA="" Y1="" YA=""></Point>\n\t<Point X="CA-CF" Y="W" Angle="0" Face="" HDirect="" Hole_Xcap="" Hole_Ycap="" Holenum_X="0" Holenum_Y="0" Hotspot="1" IsDim="0" R="" Rb="" StartAngle="0" X1="" XA="" Y1="" YA=""></Point>\n\t<Arc X="CA-CF" Y="W" Angle="90" Face="" HDirect="" Hole_Xcap="" Hole_Ycap="" Holenum_X="0" Holenum_Y="0" Hotspot="0" IsDim="0" R="CF" Rb="" StartAngle="-90.000000" X1="" XA="" Y1="" YA=""></Arc>\n\t<Point X="CA" Y="W-CF" Angle="0" Face="" HDirect="" Hole_Xcap="" Hole_Ycap="" Holenum_X="0" Holenum_Y="0" Hotspot="1" IsDim="0" R="" Rb="" StartAngle="0" X1="" XA="" Y1="" YA=""></Point>\n\t<Point X="CA" Y="CB+CE" Angle="0" Face="" HDirect="" Hole_Xcap="" Hole_Ycap="" Holenum_X="0" Holenum_Y="0" Hotspot="1" IsDim="0" R="" Rb="" StartAngle="0" X1="" XA="" Y1="" YA=""></Point>\n\t<Arc X="CA" Y="CB+CE" Angle="-90.000000" Face="" HDirect="" Hole_Xcap="" Hole_Ycap="" Holenum_X="0" Holenum_Y="0" Hotspot="0" IsDim="0" R="CE" Rb="" StartAngle="180" X1="" XA="" Y1="" YA=""></Arc>\n\t<Point X="CA+CE" Y="CB" Angle="0" Face="" HDirect="" Hole_Xcap="" Hole_Ycap="" Holenum_X="0" Holenum_Y="0" Hotspot="1" IsDim="0" R="" Rb="" StartAngle="0" X1="" XA="" Y1="" YA=""></Point>\n\t<Point X="L-CH" Y="CB" Angle="0" Face="" HDirect="" Hole_Xcap="" Hole_Ycap="" Holenum_X="0" Holenum_Y="0" Hotspot="1" IsDim="0" R="" Rb="" StartAngle="0" X1="" XA="" Y1="" YA=""></Point>\n\t<Arc X="L-CH" Y="CB" Angle="90" Face="" HDirect="" Hole_Xcap="" Hole_Ycap="" Holenum_X="0" Holenum_Y="0" Hotspot="0" IsDim="0" R="CH" Rb="" StartAngle="-90.000000" X1="" XA="" Y1="" YA=""></Arc>\n\t<Point X="L" Y="CB-CH" Angle="0" Face="" HDirect="" Hole_Xcap="" Hole_Ycap="" Holenum_X="0" Holenum_Y="0" Hotspot="1" IsDim="0" R="" Rb="" StartAngle="0" X1="" XA="" Y1="" YA=""></Point>\n\t<Point X="L" Y="CI" Angle="0" Face="" HDirect="" Hole_Xcap="" Hole_Ycap="" Holenum_X="0" Holenum_Y="0" Hotspot="1" IsDim="0" R="" Rb="" StartAngle="0" X1="" XA="" Y1="" YA=""></Point>\n\t<Arc X="L" Y="CI" Angle="90" Face="" HDirect="" Hole_Xcap="" Hole_Ycap="" Holenum_X="0" Holenum_Y="0" Hotspot="0" IsDim="0" R="CI" Rb="" StartAngle="0" X1="" XA="" Y1="" YA=""></Arc>\n\t<Point X="L-CI" Y="0" Angle="0" Face="" HDirect="" Hole_Xcap="" Hole_Ycap="" Holenum_X="0" Holenum_Y="0" Hotspot="1" IsDim="0" R="" Rb="" StartAngle="0" X1="" XA="" Y1="" YA=""></Point>\n</Graph>\n<FaceA>\n\t<VHole X="29" Y="70" Face="A" FaceType="Down" HDirect="" HoleName="胶粒孔" Hole_D="0" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="10" Rb="" Rbdepth="0" Rdepth="12" Rtype="C"></VHole>\n\t<VHole X="29" Y="390" Face="A" FaceType="Down" HDirect="" HoleName="胶粒孔" Hole_D="0" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="10" Rb="" Rbdepth="0" Rdepth="12" Rtype="C"></VHole>\n\t<VHole X="29" Y="1112" Face="A" FaceType="Down" HDirect="" HoleName="胶粒孔" Hole_D="0" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="10" Rb="" Rbdepth="0" Rdepth="12" Rtype="C"></VHole>\n\t<VHole X="29" Y="792" Face="A" FaceType="Down" HDirect="" HoleName="胶粒孔" Hole_D="0" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="10" Rb="" Rbdepth="0" Rdepth="12" Rtype="C"></VHole>\n\t<VHole X="29" Y="591" Face="A" FaceType="Down" HDirect="" HoleName="胶粒孔" Hole_D="0" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="10" Rb="" Rbdepth="0" Rdepth="12" Rtype="C"></VHole>\n\t<VHole X="1171" Y="70" Face="A" FaceType="Down" HDirect="" HoleName="胶粒孔" Hole_D="0" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="10" Rb="" Rbdepth="0" Rdepth="12" Rtype="C"></VHole>\n\t<VHole X="1171" Y="102" Face="A" FaceType="Down" HDirect="" HoleName="木肖配对孔" Hole_D="0" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="8" Rb="" Rbdepth="0" Rdepth="10" Rtype=""></VHole>\n\t<VHole X="1171" Y="422" Face="A" FaceType="Down" HDirect="" HoleName="胶粒孔" Hole_D="0" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="10" Rb="" Rbdepth="0" Rdepth="12" Rtype="C"></VHole>\n\t<VHole X="1171" Y="390" Face="A" FaceType="Down" HDirect="" HoleName="木肖配对孔" Hole_D="0" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="8" Rb="" Rbdepth="0" Rdepth="10" Rtype=""></VHole>\n\t<VHole X="70" Y="1171" Face="A" FaceType="Down" HDirect="" HoleName="胶粒孔" Hole_D="0" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="10" Rb="" Rbdepth="0" Rdepth="12" Rtype="C"></VHole>\n\t<VHole X="102" Y="1171" Face="A" FaceType="Down" HDirect="" HoleName="木肖配对孔" Hole_D="0" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="8" Rb="" Rbdepth="0" Rdepth="10" Rtype=""></VHole>\n\t<VHole X="422" Y="1171" Face="A" FaceType="Down" HDirect="" HoleName="胶粒孔" Hole_D="0" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="10" Rb="" Rbdepth="0" Rdepth="12" Rtype="C"></VHole>\n\t<VHole X="390" Y="1171" Face="A" FaceType="Down" HDirect="" HoleName="木肖配对孔" Hole_D="0" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="8" Rb="" Rbdepth="0" Rdepth="10" Rtype=""></VHole>\n\t<VHole X="88" Y="31" Face="A" FaceType="Down" HDirect="" HoleName="胶粒孔" Hole_D="0" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="10" Rb="" Rbdepth="0" Rdepth="12" Rtype="C"></VHole>\n\t<VHole X="408" Y="31" Face="A" FaceType="Down" HDirect="" HoleName="胶粒孔" Hole_D="0" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="10" Rb="" Rbdepth="0" Rdepth="12" Rtype="C"></VHole>\n\t<VHole X="1112" Y="31" Face="A" FaceType="Down" HDirect="" HoleName="胶粒孔" Hole_D="0" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="10" Rb="" Rbdepth="0" Rdepth="12" Rtype="C"></VHole>\n\t<VHole X="792" Y="31" Face="A" FaceType="Down" HDirect="" HoleName="胶粒孔" Hole_D="0" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="10" Rb="" Rbdepth="0" Rdepth="12" Rtype="C"></VHole>\n\t<VHole X="600" Y="31" Face="A" FaceType="Down" HDirect="" HoleName="胶粒孔" Hole_D="0" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="10" Rb="" Rbdepth="0" Rdepth="12" Rtype="C"></VHole>\n\t<Cut X="88" Y="99" X1="1200-88" Y1="99" CutName="0" Cutter="0" Face="A" Hole_Z="10" NotAuto="1" device="0"></Cut>\n\t<Cut X="54" Y="1143" X1="454" Y1="1143" CutName="0" Cutter="0" Face="A" Hole_Z="10" NotAuto="1" device="0"></Cut>\n</FaceA>\n<FaceB>\n\t<VHole X="68" Y="10" Face="B" FaceType="Up" HDirect="" HoleName="胶粒孔" Hole_D="0" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="10" Rb="" Rbdepth="0" Rdepth="12" Rtype="C"></VHole>\n\t<VHole X="832" Y="10" Face="B" FaceType="Up" HDirect="" HoleName="胶粒孔" Hole_D="0" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="10" Rb="" Rbdepth="0" Rdepth="12" Rtype="C"></VHole>\n\t<VHole X="450" Y="10" Face="B" FaceType="Up" HDirect="" HoleName="胶粒孔" Hole_D="0" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="10" Rb="" Rbdepth="0" Rdepth="12" Rtype="C"></VHole>\n\t<VHole X="968" Y="10" Face="B" FaceType="Up" HDirect="" HoleName="胶粒孔" Hole_D="0" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="10" Rb="" Rbdepth="0" Rdepth="12" Rtype="C"></VHole>\n\t<VHole X="1150" Y="10" Face="B" FaceType="Up" HDirect="" HoleName="胶粒孔" Hole_D="0" Hole_Xcap="0" Hole_Ycap="0" Hole_Z="9" Holenum_X="0" Holenum_Y="0" R="10" Rb="" Rbdepth="0" Rdepth="12" Rtype="C"></VHole>\n\t<Path X="160" Y="217" BH="18" CA="50" Face="B" Flag="1" IsFill="0" KeyName="" L="156" Repeat="0" Type="Polygon" V="1" W="256" d="m 0*L/156 0*W/256,l 0 20,l 40 20,l 40 0,l L-40 0,l L-40 20,l L 20,l L 0,l L-20 0,l L-20 40,l L 40,l L W-40,l L-20 W-40,l L-20 W,l L W,l L W-20,l L-40 W-20,l L-40 W,l 40 W,l 40 W-20,l 0 W-20,l 0 W,l 20 W,l 20 W-40,l 0 W-40,l 0 40,l 20 40,l 20 0,z;" isShowCoordinate="false" name="交错门图元.x2d" type="变量异形"></Path>\n\t<Path X="37" Y="48" BH="18" Face="B" Flag="1" IsFill="0" KeyName="" L="400" Repeat="0" Type="Polygon" V="1" W="600" d="m L-20 60,l L 60,l L 40,l 0 40,l 0 60,l 20 60,l 20 0,l 0 0,l 0 20,l 60 20,l 60 0,l 40 0,l 40 W,l 60 W,l 60 W-20,l 0 W-20,l 0 W,l 20 W,l 20 W-60,l 0 W-60,l 0 W-40,l L W-40,l L W-60,l L-20 W-60,l L-20 W,l L W,l L W-20,l L-60 W-20,l L-60 W,l L-40 W,l L-40 0,l L-60 0,l L-60 20,l L 20,l L 0,l L-20 0,z;" isShowCoordinate="false" name="门图元30.x2d" type="门型图元"></Path>\n</FaceB>\n</Board>\n'},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{id:"app",tabindex:"-1","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"},on:{click:e.clickApp}},[a("AppLeft",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"appLeft",attrs:{current:e.current},on:{expandState:e.expandState}}),a("AppRight",{ref:"appRight",attrs:{current:e.current,id:"AppRight",mode:e.mode}})],1)},o=[],s=(a("caad"),a("b0c0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"AppLeft"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isExpand,expression:"!isExpand"}],staticClass:"leftContent"},[a("div",{staticClass:"app_search"},[a("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}})],1),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"app_ul",on:{contextmenu:function(t){return t.stopPropagation(),t.preventDefault(),e.menuHandle(t)}}},[a("el-tree",{ref:"treeData",attrs:{data:e.data,props:e.defaultProps,"node-key":"sName",accordion:"","show-checkbox":"","filter-node-method":e.filterNode},on:{"node-click":e.doClick,"node-contextmenu":e.menuHandle,check:e.selectChange},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node;return a("span",{staticClass:"custom-tree-node"},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:n.label,placement:"right","open-delay":500}},[a("span",{staticClass:"el-tree-node__label"},[a("i",{class:!n.data.children&&n.isLeaf?"el-icon-document":"el-icon-folder-opened"}),e._v(" "+e._s(n.label)+" ")])])],1)}}])})],1),a("LeftMenu",{ref:"leftMenu",attrs:{current:e.current,selectArray:e.selectArray,treeArray:e.data}})],1),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.isExpand?"展开":"隐藏",placement:"right"}},[a("div",{class:[e.isExpand?"shrink_icon":"expand_btn"],on:{click:e.expandHandle}},[a("i",{class:[e.isExpand?"el-icon-arrow-right":"el-icon-arrow-left"]})])])],1)}),r=[],l=(a("99af"),a("4de4"),a("c975"),a("d81d"),a("ac1f"),a("841c"),a("2909")),c=(a("96cf"),a("1da1")),u=a("db04"),d=(a("e67d"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"leftMenuDiv"},[a("transition",{attrs:{name:"el-zoom-in-top"}},[e.menu.state?a("ul",{style:e.getStyle,attrs:{id:"QdMenu",tabindex:"-1"},on:{blur:e.blurHandle}},[a("li",{directives:[{name:"show",rawName:"v-show",value:1!=e.menu.type,expression:"menu.type != 1"}],on:{click:function(t){return e.addAndUpdate("add",-1)}}},[e._v(" 新建分组 ")]),a("li",{directives:[{name:"show",rawName:"v-show",value:-1!=e.menu.type,expression:"menu.type != -1"}],on:{click:function(t){return e.addAndUpdate("add",e.menu.type)}}},[e._v(" 新建x2d ")]),a("li",{directives:[{name:"show",rawName:"v-show",value:1==e.menu.type,expression:"menu.type == 1"}],on:{click:function(t){return e.delHandle(0)}}},[e._v("删除")]),a("li",{directives:[{name:"show",rawName:"v-show",value:-1!=e.menu.type,expression:"menu.type != -1"}],on:{click:function(t){return e.addAndUpdate("update")}}},[e._v("重命名")]),a("li",{directives:[{name:"show",rawName:"v-show",value:1==e.menu.type,expression:"menu.type == 1"}],on:{click:function(t){return e.copyHandle(0)}}},[e._v("复制")]),a("li",{directives:[{name:"show",rawName:"v-show",value:1==e.menu.type,expression:"menu.type == 1"}],on:{click:e.pasteHandle}},[e._v("粘贴")]),a("li",{directives:[{name:"show",rawName:"v-show",value:1==e.menu.type,expression:"menu.type == 1"}],on:{click:e.moveHandle}},[e._v("移动")]),a("li",{directives:[{name:"show",rawName:"v-show",value:1==e.menu.type,expression:"menu.type == 1"}],on:{click:e.copyFileName}},[e._v("复制基础图形")]),a("li",{directives:[{name:"show",rawName:"v-show",value:-1!=e.menu.type,expression:"menu.type != -1"}],on:{click:e.uploadGraph}},[e._v("本地x2d上传")]),a("li",{directives:[{name:"show",rawName:"v-show",value:1==e.menu.type,expression:"menu.type == 1"}],on:{click:e.uploadPrimitiveHandle}},[e._v(" 上传为图元 ")])]):e._e()]),a("el-dialog",{attrs:{visible:e.dialog.state,width:"250px","close-on-click-modal":!1,"show-close":!1,top:"35vh"},on:{"update:visible":function(t){return e.$set(e.dialog,"state",t)}},nativeOn:{keyup:function(e){e.stopPropagation()}}},[e._v(" "+e._s(e.dialog.title)+" "),a("el-input",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addAndUpdate("save",e.dialog.saveType)}},model:{value:e.dialog.text,callback:function(t){e.$set(e.dialog,"text",t)},expression:"dialog.text"}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialog.state=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.addAndUpdate("save",e.dialog.saveType)}}},[e._v("确 定")])],1)],1),e.ImgResourceState?a("ImgResource",{attrs:{"on-close":e.ImgResourceClose,"on-success":e.ImgResourceSuccess,type:e.ImgResourceType}}):e._e()],1)}),h=[],p=(a("4160"),a("45fc"),a("a9e3"),a("4d63"),a("25f0"),a("2532"),a("466d"),a("5319"),a("159b"),a("b85c")),m="QDBaseGraph",f={handle:null,store:null,setStore:function(){var e=this.handle.transaction("webStorage","readwrite");this.store=e.objectStore("webStorage")},get:function(e){this.setStore();var t=this.store.get(m);t.addEventListener("success",e)},put:function(e,t){this.setStore();var a=this.store.put({id:m,content:e});a.addEventListener("success",t)}},v=indexedDB.open("QdDatabase",1);v.addEventListener("success",(function(e){console.log("连接数据库成功")})),v.addEventListener("error",(function(e){console.log("连接数据库失败")})),v.addEventListener("upgradeneeded",(function(e){var t=e.target.result;t.createObjectStore("webStorage",{keyPath:"id",autoIncrement:!0});console.log("创建对象仓库成功")})),v.addEventListener("success",(function(e){var t=e.target.result;f.handle=t}));var g=f,b=a("fa7d"),y=a("85e5"),w=a("4f75"),H={name:"QdMenu",props:{current:Object,selectArray:Array,treeArray:Array},data:function(){return{menu:{type:0,state:!1,top:0,left:0},dialog:{type:"",state:!1,text:"",title:"",saveType:""},curNodeName:"",ImgResourceState:!1,ImgResourceType:""}},methods:{nodeMenuHandle:function(e,t){var a=this;t&&(this.curNodeName=t.sName),this.menu.type=t?t.children?0:1:-1,this.menu.state=!0,this.$nextTick((function(){var t=e.pageX,n=e.pageY,i=a.$el.querySelector("#QdMenu");a.menu.left=t+10,a.menu.top=n+i.offsetHeight<document.body.offsetHeight?n:n-i.offsetHeight,a.$el.querySelector("#QdMenu").focus()}))},blurHandle:function(){this.menu.state=!1},addAndUpdate:function(e,t){var a=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){var i,o,s,r,l,c,d,h;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if("save"!==e){n.next=63;break}if(i=a.dialog.text,""!==i){n.next=5;break}return a.$message({type:"info",message:"名称不能为空",duration:1e3}),n.abrupt("return");case 5:if("add"!==a.dialog.type){n.next=27;break}if(1==a.menu.type||-1!=t){n.next=10;break}a.treeArray.some((function(e){return e.sName===i}))?a.$message({type:"info",message:"分组名不能重复",duration:1e3}):(a.treeArray.push({sName:i,children:[]}),a.dialog.state=!1),n.next=25;break;case 10:if(-1==a.menu.type||0!=t&&1!=t){n.next=25;break}if(i.match(new RegExp(".x2d"))||(i+=".x2d"),o="",0==t?o=a.curNodeName:a.treeArray.forEach((function(e){e.children.some((function(e){return e.sName==a.curNodeName}))&&(o=e.sName)})),s=!1,a.treeArray.forEach((function(e){e.children.some((function(e){return e.sName==i}))&&(s=!0)})),!s){n.next=20;break}a.$message({type:"info",message:"文件名不能重复",duration:1e3}),n.next=25;break;case 20:return n.next=22,Object(u["b"])({key:i,dataType:"x2d",groupName:o,data:"",type:"add"});case 22:r=n.sent,1===r.state?(0==t?a.treeArray.forEach((function(e){e.sName==o&&e.children.push({sName:i})})):a.treeArray.forEach((function(e){e.children.some((function(e){return e.sName==a.curNodeName}))&&e.children.push({sName:i})})),a.$message({type:"success",message:"添加成功",duration:1e3})):a.$message({type:"error",message:"文件名已存在"==r.info?r.info:"添加失败",duration:1e3}),a.dialog.state=!1;case 25:n.next=61;break;case 27:if("update"!==a.dialog.type){n.next=61;break}if(0!=a.menu.type){n.next=45;break}if(!a.treeArray.some((function(e){return e.sName===i}))){n.next=33;break}a.$message({type:"info",message:"分组名不能重复",duration:1e3}),n.next=43;break;case 33:if(a.curNodeName!=i){n.next=37;break}a.dialog.state=!1,n.next=43;break;case 37:return l=a.treeArray.filter((function(e){return e.sName==a.curNodeName}))[0].children.map((function(e){return e.sName})),n.next=40,Object(u["h"])({data:JSON.stringify([{key:l,groupName:i,dataType:"x2d"}])});case 40:c=n.sent,1===c.result?(a.treeArray.forEach((function(e){e.sName==a.curNodeName&&(e.sName=i)})),a.$message({type:"success",message:"修改成功",duration:1e3})):a.$message({type:"error",message:"修改失败",duration:1e3}),a.dialog.state=!1;case 43:n.next=61;break;case 45:if(i.match(new RegExp(".x2d"))||(i+=".x2d"),d=!1,a.treeArray.forEach((function(e){e.children.some((function(e){return e.sName==i}))&&(d=!0)})),!d){n.next=52;break}a.$message({type:"info",message:"文件名不能重复",duration:1e3}),n.next=61;break;case 52:if(a.curNodeName!=i){n.next=56;break}a.dialog.state=!1,n.next=61;break;case 56:return n.next=58,Object(u["c"])({key:a.curNodeName,newKey:i});case 58:h=n.sent,1===h.result?(Object(u["c"])({key:a.curNodeName.replace(".x2d",".png"),newKey:i.replace(".x2d",".png")}),a.treeArray.forEach((function(e){e.children.forEach((function(e){e.sName==a.curNodeName&&(e.sName=i)}))})),a.$bus.$emit("leftMenuHandle",{type:"x2d重命名",oldName:a.curNodeName.replace(/\.x2d/,""),newName:i.replace(/\.x2d/,"")}),a.$message({type:"success",message:"修改成功",duration:1e3})):a.$message({type:"error",message:"文件名已存在"==h.info?h.info:"修改失败",duration:1e3}),a.dialog.state=!1;case 61:n.next=68;break;case 63:a.dialog.type=e,a.dialog.saveType=t,"add"!=e||-1==a.menu.type||0!=t&&1!=t?"update"==e&&1!=a.menu.type?(a.dialog.title="分组名称",a.dialog.text=a.curNodeName):"update"==e&&1==a.menu.type?(a.dialog.title="文件名称",a.dialog.text=a.curNodeName.substring(0,a.curNodeName.indexOf("."))):(a.dialog.title="分组名称",a.dialog.text=""):(a.dialog.title="文件名称",a.dialog.text=""),a.dialog.state=!0,a.$nextTick((function(){return a.$el.querySelector(".el-dialog__wrapper .el-input__inner").focus()}));case 68:case"end":return n.stop()}}),n)})))()},delHandle:function(e){var t=this;this.$confirm("是否确认删除文件?","",{type:"warning",showClose:!1}).then(Object(c["a"])(regeneratorRuntime.mark((function e(){var a,n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t.getCheckedArr(),n=a.map((function(e){return e.replace(".x2d",".png")})),e.next=4,Object(u["d"])({key:JSON.stringify([].concat(Object(l["a"])(a),Object(l["a"])(n)))});case 4:i=e.sent,1===i.result?(t.getParent.data.forEach((function(e){e.children=e.children.filter((function(e){return!t.getCheckedArr().includes(e.sName)}))})),t.getParent.clearHandle(),t.$nextTick((function(){t.$message({type:"success",message:"删除成功",duration:1e3}),t.$bus.$emit("saveXMLCode","")}))):t.$message({type:"error",message:"删除失败",duration:1e3});case 6:case"end":return e.stop()}}),e)})))).catch((function(e){}))},copyHandle:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(1!=e||0!=t.selectArray.length){a.next=4;break}t.$message({type:"info",message:"请选择要复制的文件",duration:1e3}),a.next=10;break;case 4:return t.blurHandle(),n=0==e?t.curNodeName:t.selectArray[0].sName,a.next=8,Object(u["e"])({key:n});case 8:i=a.sent,1===i.result&&i.configdata?g.put(i.configdata,(function(){t.$message({type:"success",message:"复制成功",duration:1e3})})):t.$message({type:"error",message:"复制失败",duration:1e3});case 10:case"end":return a.stop()}}),a)})))()},pasteHandle:function(){var e=this;0==this.selectArray.length?this.$message({type:"info",message:"请选择要粘贴的文件",duration:1e3}):(this.blurHandle(),g.get((function(t){t.target.result&&t.target.result.content?(e.$bus.$emit("saveXMLCode",t.target.result.content),e.$message({type:"success",message:"粘贴成功",duration:1e3})):e.$message({type:"error",message:"暂无粘贴数据",duration:1e3})})))},copyFileName:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var a,n,i,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.blurHandle(),t.next=3,Object(u["e"])({key:e.curNodeName});case 3:if(a=t.sent,n={"文件名":e.curNodeName,"变量":{}},1===a.result&&a.configdata)for(o in i=XmlUtil.toJson(a.configdata)[0],i.attr)s=i.attr[o],isNumber(s)&&Number(s)&&(n.变量[o]=s);Object(b["a"])(JSON.stringify(n)),e.$message({type:"success",message:"复制基础图形成功",duration:1e3});case 8:case"end":return t.stop()}}),t)})))()},uploadGraph:function(){var e=this;readTextFiles({fileType:"x2d",encoding:"utf-8"}).then((function(t){var a=t.map((function(e){if(e.value)return{key:e.name,dataType:"x2d",data:e.value}})).filter((function(e){return e}));e.uploadHandle(a)}))},uploadHandle:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function a(){var n,i,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=!1,e.forEach((function(e){t.treeArray.forEach((function(t){t.children.some((function(t){return t.sName==e.key}))&&(n=!0)}))})),!n){a.next=6;break}t.$message({type:"info",message:"存在同名文件",duration:1e3}),a.next=14;break;case 6:return t.$parent.loading=!0,i="",0==t.menu.type?i=t.curNodeName:t.treeArray.forEach((function(e){e.children.some((function(e){return e.sName==t.curNodeName}))&&(i=e.sName)})),e.forEach((function(e){return e["groupName"]=i})),a.next=12,Object(u["a"])({data:JSON.stringify(e)});case 12:o=a.sent,1===o.result?(t.treeArray.forEach((function(t){t.sName==i&&e.forEach((function(e){t.children.push({sName:e.key,dataType:e.dataType})}))})),t.$message({type:"success",message:"上传成功",duration:1e3}),t.$parent.loading=!1):(t.$message({type:"error",message:"文件名已存在"==o.info?o.info:"上传失败",duration:1e3}),t.$parent.loading=!1);case 14:case"end":return a.stop()}}),a)})))()},moveHandle:function(){this.ImgResourceType="move",this.ImgResourceState=!0,this.blurHandle()},getCheckedArr:function(){var e=0==this.$parent.checkBoxArr.length?[this.curNodeName]:Object(l["a"])(this.$parent.checkBoxArr);return e},ImgResourceClose:function(){this.ImgResourceState=!1},ImgResourceSuccess:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.ImgResourceClose(),""==e){a.next=11;break}if("move"!=t.ImgResourceType){a.next=10;break}return t.$parent.loading=!0,a.next=6,Object(u["h"])({data:JSON.stringify([{key:t.getCheckedArr(),groupName:e,dataType:"x2d"}])});case 6:n=a.sent,1===n.result?(0==t.$parent.checkBoxArr.length?(t.treeArray.forEach((function(e){e.children=e.children.filter((function(e){return e.sName!=t.curNodeName}))})),t.treeArray.forEach((function(a){a.sName==e&&a.children.push({sName:t.curNodeName,dataType:"x2d"})}))):(t.treeArray.forEach((function(e){t.$parent.checkBoxArr.forEach((function(t){e.children=e.children.filter((function(e){return e.sName!=t}))}))})),t.treeArray.forEach((function(a){a.sName==e&&t.$parent.checkBoxArr.forEach((function(e){a.children.push({sName:e,dataType:"x2d"})}))}))),t.$message({type:"success",message:"移动成功",duration:1e3}),t.$parent.loading=!1):(t.$message({type:"error",message:"移动失败",duration:1e3}),t.$parent.loading=!1),a.next=11;break;case 10:"upload"==t.ImgResourceType&&t.uploadPrimitive(e);case 11:case"end":return a.stop()}}),a)})))()},uploadPrimitiveHandle:function(){this.ImgResourceType="upload",this.ImgResourceState=!0,this.blurHandle()},uploadPrimitive:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function a(){var n,i,o,s,r,l,c,d,h;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=t.getCheckedArr()||[],!(n.length>0)){a.next=33;break}i=Object(p["a"])(n),a.prev=3,i.s();case 5:if((o=i.n()).done){a.next=23;break}return s=o.value,a.next=9,Object(u["e"])({key:s});case 9:if(r=a.sent,1!==r.result||!r.configdata){a.next=20;break}return l=w["b"](r.configdata,s),c=(s.replace(/\.x2d/,"")||"")+".path",d={key:c,dataType:"path",data:l,groupName:e},a.next=16,Object(u["a"])({data:JSON.stringify([d])});case 16:h=a.sent,1===h.result?t.$message({type:"success",message:"".concat(s,"上传为图元成功"),duration:1e3}):t.$message({type:"error",message:"文件名已存在"==h.info?h.info:"".concat(s,"上传为图元失败"),duration:1e3}),a.next=21;break;case 20:t.$message({type:"error",message:"".concat(s,"未获取到x2d数据"),duration:1e3});case 21:a.next=5;break;case 23:a.next=28;break;case 25:a.prev=25,a.t0=a["catch"](3),i.e(a.t0);case 28:return a.prev=28,i.f(),a.finish(28);case 31:a.next=34;break;case 33:t.$message({type:"info",message:"请选择x2d",duration:1e3});case 34:case"end":return a.stop()}}),a,null,[[3,25,28,31]])})))()}},computed:{getParent:function(){return this.$parent},getStyle:function(){var e=this.menu,t=e.top,a=e.left;return{top:"".concat(t,"px"),left:"".concat(a,"px")}}},created:function(){var e=this;this.$bus.$on("menuHandle",(function(t){switch(t){case"copy":return e.copyHandle(1);case"paste":return e.pasteHandle();case"del":return e.delHandle(1)}}))},components:{ImgResource:y["a"]}},x=H,C=(a("6207"),a("2877")),_=Object(C["a"])(x,d,h,!1,null,"463405ce",null),k=_.exports,D=a("c32a"),N={name:"AppLeft",props:["current"],data:function(){return{data:[],defaultProps:{children:"children",label:"sName"},selectArray:[],loading:!0,isExpand:!1,checkBoxArr:[],filterText:"",nodeKey:"",x2dchange:!1}},methods:{searchHandle:function(){this.search.confirm=this.search.input},menuHandle:function(e,t){this.$refs.leftMenu.nodeMenuHandle(e,t)},clickHandle:function(e,t){var a=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:a.x2dchange?a.$confirm("是否确认保存?","",{type:"warning",showClose:!1}).then(Object(c["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:a.$bus.$emit("saveX2d"),a.getData(e,t);case 2:case"end":return n.stop()}}),n)})))).catch((function(){a.getData(e,t)})):a.getData(e,t);case 1:case"end":return n.stop()}}),n)})))()},doClick:function(e,t,a){e.children?this.$refs.treeData.setCurrentKey(this.nodeKey):(e.sName!=this.nodeKey&&this.clickHandle(a,e),this.nodeKey=t.key)},clearHandle:function(){this.selectArray=[],this.$bus.$emit("setCurrent",null),this.$bus.$emit("setRightHandle","Textarea","")},expandHandle:function(){this.isExpand=!this.isExpand,this.$emit("expandState",!this.isExpand)},filterNode:function(e,t){return!e||-1!==t.sName.indexOf(e)},selectChange:function(e,t){this.checkBoxArr=Object(l["a"])(this.$refs.treeData.getCheckedKeys(!0))},getData:function(e,t){var a=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a.$bus.$emit("setRightHandle","Loading",!0),e&&a.selectRowHandleMethods(e,a.getFilter,a.selectArray,t),n.next=4,Object(u["e"])({key:t.sName});case 4:i=n.sent,1===i.result?a.$bus.$emit("setCurrent",{data:i.configdata,sName:t.sName,dataType:i.dataType,groupName:i.groupName}):a.$message({type:"error",message:"请求服务器失败",duration:1e3}),a.$nextTick((function(){return a.$bus.$emit("setRightHandle","Loading",!1)})),a.x2dchange=!1;case 8:case"end":return n.stop()}}),n)})))()}},watch:{filterText:function(e){this.$refs.treeData.filter(e)}},components:{LeftMenu:k},created:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var a,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!1,t.abrupt("return");case 5:if(a=t.sent,1===a.result){for(n in a.data["默认"]=[].concat(Object(l["a"])(a.data[""]||[]),Object(l["a"])(a.data["默认"]||[])),delete a.data[""],a.data)i={sName:n,children:a.data[n].map((function(e){return{sName:e.key,dataType:e.dataType}})).sort(Object(D["a"])("sName"))},e.data.push(i);e.data.sort(Object(D["a"])("sName"))}else 0===a.result?e.data=[]:e.$message({type:"error",message:"请求服务器失败",duration:1e3});e.$nextTick((function(){e.loading=!1})),e.$bus.$on("x2dchange",(function(t){e.x2dchange=t}));case 9:case"end":return t.stop()}}),t)})))()},mounted:function(){}},A=N,S=(a("d4ae"),Object(C["a"])(A,s,r,!1,null,"ad9e22f4",null)),B=S.exports,L=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"},{name:"resize",rawName:"v-resize",value:e.resizefn,expression:"resizefn"}],attrs:{id:"AppRight","element-loading-text":"数据加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[a("TopBar",{ref:"topBar",staticClass:"top-bar",attrs:{sName:e.sName,mode:e.mode,isFromHome:e.isFromHome,otherFrameBtn:e.otherFrameBtn,fromHomeFile:e.fromHomeFile,originFileName:e.originFileName,isBanBtn:e.isBanBtn}}),a("div",{staticClass:"main-box"},[a("LeftMenu",{directives:[{name:"show",rawName:"v-show",value:e.mode,expression:"mode"}],ref:"left",staticClass:"left-menu",attrs:{data:e.dataList,attrs:e.boardAttr,view:e.viewState,face_a:e.dataList.FaceA,face_b:e.dataList.FaceB,isFromHome:e.isFromHome},on:{"show-attr":e.showAttr,"show-menu":e.showHoleCutMenu,"select-node":e.seletcNode,draw:e.updateAllNode}}),a("Right",{staticClass:"right-part",attrs:{mode:e.mode}}),a("div",{staticClass:"inputs"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.showEditInput,expression:"showEditInput"}],attrs:{id:"setInput"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.editHc.value,expression:"editHc.value"}],staticClass:"input-item",attrs:{type:"text"},domProps:{value:e.editHc.value},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.setInputValue(t)},input:function(t){t.target.composing||e.$set(e.editHc,"value",t.target.value)}}})]),a("div",{staticClass:"input-box"},[a("input",{directives:[{name:"show",rawName:"v-show",value:e.editInput.edit1.show,expression:"editInput.edit1.show"},{name:"model",rawName:"v-model",value:e.showEdit1Data,expression:"showEdit1Data"}],staticClass:"item input-item",attrs:{type:"text",id:"edit1"},domProps:{value:e.showEdit1Data},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.setInputValue2("edit1")},input:function(t){t.target.composing||(e.showEdit1Data=t.target.value)}}}),a("input",{directives:[{name:"show",rawName:"v-show",value:e.editInput.edit2.show,expression:"editInput.edit2.show"},{name:"model",rawName:"v-model",value:e.showEdit2Data,expression:"showEdit2Data"}],staticClass:"item input-item",attrs:{type:"text",id:"edit2"},domProps:{value:e.showEdit2Data},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.setInputValue2("edit2")},input:function(t){t.target.composing||(e.showEdit2Data=t.target.value)}}})])]),a("XmlCode",{staticClass:"xml-code"})],1),e.showAttrEdit?a("Attredit",{attrs:{datas:e.curNode,type:e.curEditType,attrs:e.boardAttr,title:e.attreditTitle,face:e.curFace},on:{close:e.hideAttr}}):e._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showMenu.hc,expression:"showMenu.hc"}],staticClass:"right-menu",attrs:{id:"hcMenu"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.menuItemShow.hc.toFaceA,expression:"menuItemShow.hc.toFaceA"}],staticClass:"item",on:{click:e.moveToFaceA}},[e._v(" 移为A面 ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.menuItemShow.hc.toFaceB,expression:"menuItemShow.hc.toFaceB"}],staticClass:"item",on:{click:e.moveToFaceB}},[e._v(" 移为B面 ")]),a("div",{staticClass:"item",on:{click:e.copyToOtherFace}},[e._v("拷贝到另一面")]),a("div",{staticClass:"item",on:{click:function(t){return e.deleteHC(-1)}}},[e._v("删除")]),a("div",{staticClass:"item",on:{click:function(t){return e.moveInFace("up")}}},[e._v("上移")]),a("div",{staticClass:"item",on:{click:function(t){return e.moveInFace("down")}}},[e._v("下移")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showMenu.point,expression:"showMenu.point"}],staticClass:"right-menu",class:{banclick:e.isBanPointMenu},attrs:{id:"pointMenu"}},e._l(e.rightPointMenuList,(function(t){return a("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"item.show"}],key:t.label,staticClass:"item",on:{click:function(e){return t.method.apply(t,t.args)}}},[e._v(" "+e._s(t.label)+" ")])})),0),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showMenu.editAttr,expression:"showMenu.editAttr"}],staticClass:"right-menu",attrs:{id:"editAttr"}},[a("div",{staticClass:"item",on:{click:e.ediltNodeAttr}},[e._v("属性编辑")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showMenu.holeGroup,expression:"showMenu.holeGroup"}],staticClass:"right-menu",attrs:{id:"holeGroup"}},[a("div",{staticClass:"item",on:{click:function(t){return e.holeGroupRightMenu("copy")}}},[e._v("复制")]),a("div",{staticClass:"item",on:{click:function(t){return e.holeGroupRightMenu("stick")}}},[e._v("粘贴")]),a("div",{staticClass:"item",on:{click:function(t){return e.holeGroupRightMenu("group")}}},[e._v("成组")]),a("div",{staticClass:"item",on:{click:function(t){return e.holeGroupRightMenu("ungroup")}}},[e._v("解组")]),a("div",{staticClass:"item",on:{click:function(t){return e.holeGroupRightMenu("delete")}}},[e._v("删除")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showMenu.lineToTArc,expression:"showMenu.lineToTArc"}],staticClass:"right-menu",attrs:{id:"lineToTArcMenu"}},[a("div",{staticClass:"item",on:{click:function(t){return e.lineToTArc("1")}}},[e._v("转为外凸弧")]),a("div",{staticClass:"item",on:{click:function(t){return e.lineToTArc("0")}}},[e._v("转为内凹弧")])]),a("Dialog"),e.ImgResourceState?a("imgSource",{attrs:{type:e.dialogType},on:{onClose:e.ImgResourceClose,onSuccess:e.ImgResourceSuccess}}):e._e(),a("el-dialog",{attrs:{title:"参数设置",visible:e.dialogFormVisible,width:"300px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"外凸弧"===e.formType||"内凹弧"===e.formType,expression:"formType === '外凸弧' || formType === '内凹弧'"}],attrs:{label:"圆弧半径"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.radius,callback:function(t){e.$set(e.form,"radius",t)},expression:"form.radius"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"斜线"===e.formType||"直角"===e.formType,expression:"formType === '斜线' || formType === '直角'"}],attrs:{label:"水平距离"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.width,callback:function(t){e.$set(e.form,"width",t)},expression:"form.width"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"斜线"===e.formType||"直角"===e.formType,expression:"formType === '斜线' || formType === '直角'"}],attrs:{label:"垂直距离"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.height,callback:function(t){e.$set(e.form,"height",t)},expression:"form.height"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.transformPoint}},[e._v("确 定")])],1)],1),e.dialogVisible_line2arc.LineToArc?a("LineToArc",{attrs:{method:e.dialogVisible_line2arc.method,isBulge:e.dialogVisible_line2arc.isBulge,chordH:e.dialogVisible_line2arc.chordH},on:{close:function(t){e.dialogVisible_line2arc.LineToArc=!1},confirm:e.transformSelectLineToTArc}}):e._e()],1)},F=[],$=a("bc9c"),E=$["a"],R=(a("4581"),Object(C["a"])(E,L,F,!1,null,"79ad1190",null)),T=R.exports,I=a("dac6"),O=a("1d74"),X={name:"App",data:function(){return{current:null,isLeftExpand:!0,mode:!1,fullscreenLoading:!1}},watch:{},computed:{},methods:{setCurrent:function(e){this.current=e},keyHandle:function(e){46==e.keyCode||e.ctrlKey&&67===e.keyCode||e.ctrlKey&&86===e.keyCode||(e.ctrlKey&&90===e.keyCode?this.$bus.$emit("keyboardHandle","cancel"):e.ctrlKey&&89===e.keyCode?this.$bus.$emit("keyboardHandle","recover"):e.ctrlKey&&81===e.keyCode&&this.$bus.$emit("editXMLCode"))},expandState:function(e){this.isLeftExpand=e,this.canvasResize()},canvasResize:function(){var e=this;this.$nextTick((function(){var t=e.$children[0].$el;e.$bus.$emit("canvasResize",{w:t.offsetWidth,h:t.offsetHeight})}))},clickApp:function(e){this.$bus.$emit("clickApp",e)}},components:{AppLeft:B,AppRight:T},created:function(){var e,t,a,n,i,o,s=this,r=Object(O["a"])(),l=null!==(e=null===(t=window)||void 0===t||null===(a=t.opener)||void 0===a?void 0:a.name)&&void 0!==e?e:"";if(I["c"]||1==(null===r||void 0===r?void 0:r.mode)||"qd_window_personCenter"==(null===(n=window)||void 0===n||null===(i=n.parent)||void 0===i?void 0:i.name)||["FileLib","qd_window_home"].includes(l));else if((null===(o=window)||void 0===o?void 0:o.opener)&&["tab_数据处理中心主页面_iframe","qd_window_bom","qd_window_bom3","kailiao"].includes(l)){var c={"tab_数据处理中心主页面_iframe":["源代码"],qd_window_bom:["源代码"],qd_window_bom3:["源代码"],kailiao:["源代码"]};this.$nextTick((function(){s.$refs.appRight.otherFrameBtn=null===c||void 0===c?void 0:c[l]}))}this.mode=!0,this.$bus.$on("setCurrent",this.setCurrent),this.canvasResize()},mounted:function(){var e=this;document.addEventListener("keydown",(function(e){83===e.keyCode&&e.ctrlKey&&e.preventDefault()})),document.addEventListener("keyup",(function(t){e.keyHandle(t)})),document.oncontextmenu=function(){return!1},window.addEventListener("resize",this.canvasResize)}},P=X,j=(a("d264"),a("5c64"),Object(C["a"])(P,i,o,!1,null,"7c2da470",null)),Y=j.exports,M=(a("eca7"),a("450d"),a("3787")),V=a.n(M),U=(a("425f"),a("4105")),z=a.n(U),G=(a("e3ea"),a("7bc3")),W=a.n(G),K=(a("5466"),a("ecdf")),Q=a.n(K),q=(a("38a0"),a("ad41")),J=a.n(q),Z=(a("06f1"),a("6ac9")),ee=a.n(Z),te=(a("2986"),a("14e9")),ae=a.n(te),ne=(a("560b"),a("dcdc")),ie=a.n(ne),oe=(a("e612"),a("dd87")),se=a.n(oe),re=(a("075a"),a("72aa")),le=a.n(re),ce=(a("5e32"),a("6721")),ue=a.n(ce),de=(a("b5d8"),a("f494")),he=a.n(de),pe=(a("6611"),a("e772")),me=a.n(pe),fe=(a("1f1a"),a("4e4b")),ve=a.n(fe),ge=(a("3c52"),a("0d7b")),be=a.n(ge),ye=(a("fe07"),a("6ac5")),we=a.n(ye),He=(a("bd49"),a("18ff")),xe=a.n(He),Ce=(a("960d"),a("defb")),_e=a.n(Ce),ke=(a("cb70"),a("b370")),De=a.n(ke),Ne=(a("0c67"),a("299c")),Ae=a.n(Ne),Se=(a("6b30"),a("c284")),Be=a.n(Se),Le=(a("a7cc"),a("df33")),Fe=a.n(Le),$e=(a("be4f"),a("896a")),Ee=a.n($e),Re=(a("9d4c"),a("e450")),Te=a.n(Re),Ie=(a("10cb"),a("f3ad")),Oe=a.n(Ie),Xe=(a("f4f9"),a("c2cc")),Pe=a.n(Xe),je=(a("7a0f"),a("0f6c")),Ye=a.n(je),Me=(a("acb6"),a("c673")),Ve=a.n(Me),Ue=(a("1951"),a("eedf")),ze=a.n(Ue),Ge=(a("9e1f"),a("6ed5")),We=a.n(Ge),Ke=(a("0fb7"),a("f529")),Qe=a.n(Ke),qe={install:function(e){e.prototype.$message=Qe.a,e.prototype.$confirm=We.a.confirm,e.prototype.$alert=We.a.alert,e.prototype.$prompt=We.a.prompt,e.use(ze.a),e.use(Ve.a),e.use(Ye.a),e.use(Pe.a),e.use(Oe.a),e.use(Te.a),e.use(Ee.a),e.use(Fe.a),e.use(Be.a),e.use(Ae.a),e.use(De.a),e.use(_e.a),e.use(xe.a),e.use(we.a),e.use(be.a),e.use(ve.a),e.use(me.a),e.use(he.a),e.use(ue.a),e.use(le.a),e.use(se.a),e.use(ie.a),e.use(ae.a),e.use(ee.a),e.use(J.a),e.use(Q.a),e.use(W.a),e.use(z.a),e.use(V.a)}},Je=qe,Ze=a("8f94"),et=a.n(Ze);a("a7be"),a("d4ec");window["math2d"]=Math2d,window["mat2d"]=Mat2d,console.log("xxx");var tt=Object(b["b"])();n["default"].use(Je),n["default"].use(et.a),n["default"].config.devtools=!0,n["default"].prototype.$vuex=n["default"].observable({parentpagename:""}),n["default"].prototype.$bus=new n["default"],n["default"].prototype.$gData={qdsoftId:tt};var at=new n["default"]({el:"#app",render:function(e){return e(Y)}});window.UIAction={loadBd:function(e){at.$bus.$emit("loadBd",e)}}},"57dc":function(e,t,a){},"5b86":function(e,t,a){},"5bae":function(e,t,a){"use strict";var n=a("ae01"),i=a.n(n);i.a},"5c64":function(e,t,a){"use strict";var n=a("d32a"),i=a.n(n);i.a},6161:function(e,t,a){e.exports=a.p+"img/前后端等距.jpg"},"61d8":function(e,t,a){},6207:function(e,t,a){"use strict";var n=a("0c8f"),i=a.n(n);i.a},6307:function(e,t,a){"use strict";var n=a("98e0"),i=a.n(n);i.a},6541:function(e,t,a){},"6e57":function(e,t,a){"use strict";var n=a("7652"),i=a.n(n);i.a},"715e":function(e,t,a){"use strict";var n=a("57dc"),i=a.n(n);i.a},7413:function(e,t,a){},7652:function(e,t,a){},"85e5":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"bg",attrs:{tabindex:"-1"},on:{keyup:function(t){return t.stopPropagation(),e.keyHandle(t)}}},[a("transition",{attrs:{name:"fade"}},[e.fadeState?a("div",{staticClass:"imgUpload__box"},[a("div",{staticClass:"imgUpload__box-header"},[e._v(" "+e._s("manage"==e.type?"管理图元":"选择分组")+" "),a("i",{staticClass:"el-icon-close",on:{click:e.closeHandle}})]),a("div",{staticClass:"imgUpload__box-content"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.tree.loading,expression:"tree.loading"}],staticClass:"imgUpload__tree"},[a("div",{staticClass:"imgUpload-search"},[a("el-input",{attrs:{placeholder:"请输入目录",clearable:""},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchHandle("tree")}},model:{value:e.tree.inputText,callback:function(t){e.$set(e.tree,"inputText",t)},expression:"tree.inputText"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){return e.searchHandle("tree")}},slot:"append"})],1)],1),a("div",{staticClass:"imgUpload__tree-box",on:{contextmenu:function(t){return t.stopPropagation(),t.preventDefault(),e.menuHandle(t,null,null,null,1)}}},[a("el-tree",{ref:"tree",attrs:{data:e.tree.data,props:e.tree.defaultProps,"node-key":"sName",accordion:"","expand-on-click-node":!1,"filter-node-method":e.filterNode},on:{"node-click":e.nodeClickHandle,"node-contextmenu":e.menuHandle},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node;return a("span",{staticClass:"custom-tree-node"},[a("span",{staticClass:"el-tree-node__label"},[a("i",{staticClass:"el-icon-folder-opened"}),e._v(" "+e._s(n.label)+" ")])])}}],null,!1,1102169073)})],1)]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.list.loading,expression:"list.loading"}],staticClass:"imgUpload__list"},[a("div",{staticClass:"imgUpload-search"},[a("el-input",{attrs:{placeholder:"请输入文件名",clearable:""},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchHandle("list")}},model:{value:e.list.inputText,callback:function(t){e.$set(e.list,"inputText",t)},expression:"list.inputText"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){return e.searchHandle("list")}},slot:"append"})],1)],1),a("div",{staticClass:"imgUpload__list-box",on:{contextmenu:function(t){t.stopPropagation(),t.preventDefault(),"manage"==e.type&&e.menuHandle(t,null,null,null,2)}}},[a("ul",e._l(e.getListData,(function(t){return a("li",{key:t.id,class:{selectClass:e.list.selectArray.includes(t)},on:{click:function(a){return e.clickHandle(t,a)},contextmenu:function(a){return a.stopPropagation(),a.preventDefault(),e.menuHandle(a,t,null,null,4)}}},[a("el-tooltip",{attrs:{placement:"bottom-start","visible-arrow":!1,"open-delay":1e3,offset:-5,"popper-class":"popperClass"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("div",[e._v(" "+e._s(t.sName)+" ")])]),a("div",[a("div",{ref:t.sName,refInFor:!0,staticClass:"imgUpload__box-img"}),a("div",{staticClass:"imgUpload__box-title"},["manage"==e.type?a("el-checkbox",{model:{value:t.checked,callback:function(a){e.$set(t,"checked",a)},expression:"item.checked"}}):e._e(),e._v(e._s(t.sName)+" ")],1)])])],1)})),0)])])]),a("div",{staticClass:"imgUpload__box-btns"},[a("el-button",{attrs:{size:"mini"},on:{click:e.closeHandle}},[e._v("取消")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.saveHandle}},[e._v("确定")])],1)]):e._e()]),a("ImgMenu",{ref:"imgMenu",attrs:{treeArray:e.tree.data}})],1)},i=[],o=(a("4de4"),a("4160"),a("caad"),a("c975"),a("baa5"),a("d81d"),a("a434"),a("2532"),a("159b"),a("96cf"),a("1da1")),s=a("db04");a("a630"),a("13d5"),a("b0c0"),a("3ca3");var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"leftMenuDiv"},[a("transition",{attrs:{name:"el-zoom-in-top"}},[e.menu.state?a("ul",{style:e.getStyle,attrs:{id:"QdMenu",tabindex:"-1"},on:{blur:e.blurHandle}},[a("li",{directives:[{name:"show",rawName:"v-show",value:1==e.menu.type||3==e.menu.type,expression:"menu.type == 1 || menu.type == 3"}],on:{click:e.addHandle}},[e._v(" 新建分组 ")]),a("li",{directives:[{name:"show",rawName:"v-show",value:4==e.menu.type,expression:"menu.type == 4"}],on:{click:e.delHandle}},[e._v("删除")]),a("li",{directives:[{name:"show",rawName:"v-show",value:(3==e.menu.type||4==e.menu.type)&&"manage"==e.$parent.type,expression:"\n          (menu.type == 3 || menu.type == 4) && $parent.type == 'manage'\n        "}],on:{click:e.updateHandle}},[e._v(" 重命名 ")]),a("li",{directives:[{name:"show",rawName:"v-show",value:4==e.menu.type,expression:"menu.type == 4"}],on:{mouseenter:function(t){e.groupListState=!0},mouseleave:function(t){e.groupListState=!1}}},[e._v(" 移动"),a("i",{staticClass:"el-icon-arrow-right"}),a("transition",{attrs:{name:"el-zoom-in-top"}},[e.groupListState?a("ul",{staticClass:"groupList",style:e.getStyle1},[a("p",{staticStyle:{background:"#f2faff","text-align":"center"}},[e._v("分组名:")]),e._l(e.treeArray.filter((function(t){return t.sName!=e.getParent.curPath})),(function(t){return a("li",{key:t.sName,on:{click:function(a){return e.moveHandle(t.sName)}}},[e._v(" "+e._s(t.sName)+" ")])}))],2):e._e()])],1)]):e._e()]),a("el-dialog",{attrs:{visible:e.dialog.state,width:"250px","close-on-click-modal":!1,"modal-append-to-body":!1,top:"35vh","show-close":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"state",t)}},nativeOn:{keyup:function(e){e.stopPropagation()}}},[e._v(" "+e._s(e.dialog.title)+" "),a("el-input",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.saveHandle(t)}},model:{value:e.dialog.text,callback:function(t){e.$set(e.dialog,"text",t)},expression:"dialog.text"}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialog.state=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.saveHandle}},[e._v("确 定")])],1)],1)],1)},l=[],c=(a("45fc"),a("4d63"),a("ac1f"),a("25f0"),a("466d"),{name:"QdMenu",props:{treeArray:Array},data:function(){return{menu:{type:0,state:!1,top:0,left:0},dialog:{type:"",state:!1,text:"",title:"",saveType:""},curNodeName:"",ImgResourceState:!1,ImgResourceType:"",groupListState:!1}},methods:{nodeMenuHandle:function(e,t,a){var n=this;t&&(this.curNodeName=t.sName),this.menu.type=a,this.menu.state=!0,this.$nextTick((function(){var t=e.pageX,a=e.pageY,i=n.$el.querySelector("#QdMenu");n.menu.left=t+10,n.menu.top=a+i.offsetHeight<document.body.offsetHeight?a:a-i.offsetHeight,n.$el.querySelector("#QdMenu").focus()}))},blurHandle:function(){this.groupListState=!1,this.menu.state=!1},delHandle:function(){var e=this,t=[];this.getParent.list.data.forEach((function(e){return e.checked&&t.push(e.sName)})),0==t.length&&t.push(this.curNodeName),this.$confirm("是否确认删除?","",{type:"warning",showClose:!1}).then(Object(o["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(s["d"])({key:JSON.stringify(t)});case 2:n=a.sent,1===n.result?(t.forEach((function(t){e.getParent.list.data=e.getParent.list.data.filter((function(e){return e.sName!=t}))})),e.getParent.list.selectArray.splice(0),e.$nextTick((function(){e.$message({type:"success",message:"删除成功",duration:1e3})}))):e.$message({type:"error",message:"删除失败",duration:1e3});case 4:case"end":return a.stop()}}),a)})))).catch((function(e){}))},addHandle:function(){var e=this;2!=this.menu.type||this.getParent.curPath?(this.dialog.text="",this.dialog.title=1==this.menu.type||3==this.menu.type?"分组名称":"文件名称",this.dialog.state=!0,this.dialog.type="add",this.$nextTick((function(){return e.$el.querySelector(".el-dialog__wrapper .el-input__inner").focus()}))):this.$message({type:"info",message:"请选择分组",duration:1e3})},updateHandle:function(){var e=this;this.dialog.title=3==this.menu.type?"分组名称":"文件名称",this.dialog.text=3==this.menu.type?this.curNodeName:this.curNodeName.substring(0,this.curNodeName.indexOf(".")),this.dialog.state=!0,this.dialog.type="update",this.$nextTick((function(){return e.$el.querySelector(".el-dialog__wrapper .el-input__inner").focus()}))},saveHandle:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,n,i,o,r,l,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.dialog.text,""!==a){t.next=4;break}return e.$message({type:"info",message:"名称不能为空",duration:1e3}),t.abrupt("return");case 4:if(1!=e.menu.type&&3!=e.menu.type||"add"!=e.dialog.type){t.next=8;break}e.treeArray.some((function(e){return e.sName===a}))?e.$message({type:"info",message:"分组名不能重复",duration:1e3}):("move"==e.$parent.type&&e.$parent.$parent.treeArray.push({sName:a,children:[]}),e.treeArray.push({sName:a,type:"group"}),e.dialog.state=!1),t.next=55;break;case 8:if(2!=e.menu.type&&4!=e.menu.type||"add"!=e.dialog.type){t.next=22;break}if(a.match(new RegExp(".path"))||(a+=".path"),n=e.getParent.list.data.some((function(e){return e.sName==a})),!n){t.next=15;break}e.$message({type:"info",message:"文件名不能重复",duration:1e3}),t.next=20;break;case 15:return t.next=17,Object(s["b"])({key:a,dataType:"path",groupName:e.getParent.curPath,data:"",type:"add"});case 17:i=t.sent,1===i.state?(e.getParent.list.data.push({sName:a,data:""}),e.$message({type:"success",message:"添加成功",duration:1e3})):e.$message({type:"error",message:"文件名已存在"==i.info?i.info:"添加失败",duration:1e3}),e.dialog.state=!1;case 20:t.next=55;break;case 22:if(3!=e.menu.type||"update"!=e.dialog.type){t.next=39;break}if(!e.treeArray.some((function(e){return e.sName===a}))){t.next=27;break}e.$message({type:"info",message:"分组名不能重复",duration:1e3}),t.next=37;break;case 27:if(e.curNodeName!=a){t.next=31;break}e.dialog.state=!1,t.next=37;break;case 31:return o=e.getParent.list.data.map((function(e){return e.sName})),t.next=34,Object(s["h"])({data:JSON.stringify([{key:o,groupName:a,dataType:"path"}])});case 34:r=t.sent,1===r.result?(e.treeArray.forEach((function(t){t.sName==e.curNodeName&&(t.sName=a)})),e.$message({type:"success",message:"修改成功",duration:1e3})):e.$message({type:"error",message:"修改失败",duration:1e3}),e.dialog.state=!1;case 37:t.next=55;break;case 39:if(4!=e.menu.type||"update"!=e.dialog.type){t.next=55;break}if(a.match(new RegExp(".path"))||(a+=".path"),l=e.getParent.list.data.some((function(e){return e.sName==a})),!l){t.next=46;break}e.$message({type:"info",message:"文件名不能重复",duration:1e3}),t.next=55;break;case 46:if(e.curNodeName!=a){t.next=50;break}e.dialog.state=!1,t.next=55;break;case 50:return t.next=52,Object(s["c"])({key:e.curNodeName,newKey:a});case 52:c=t.sent,1===c.result?(e.getParent.list.data.forEach((function(t){t.sName==e.curNodeName&&(t.sName=a)})),e.$message({type:"success",message:"修改成功",duration:1e3})):e.$message({type:"error",message:"文件名已存在"==c.info?c.info:"修改失败",duration:1e3}),e.dialog.state=!1;case 55:case"end":return t.stop()}}),t)})))()},moveHandle:function(e){var t=this;this.$confirm("确认移动图元至 "+e+" ?","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",showClose:!1}).then(Object(o["a"])(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=[],t.getParent.list.data.forEach((function(e){return e.checked&&n.push(e.sName)})),0==n.length&&n.push(t.curNodeName),t.getParent.list.loading=!0,a.next=6,Object(s["h"])({data:JSON.stringify([{key:n,groupName:e,dataType:"path"}])});case 6:i=a.sent,1===i.result?(t.getParent.list.data=t.getParent.list.data.filter((function(e){return!n.includes(e.sName)})),t.$message({type:"success",message:"移动成功",duration:1e3}),t.getParent.list.loading=!1):(t.$message({type:"error",message:"移动失败",duration:1e3}),t.getParent.list.loading=!1);case 8:case"end":return a.stop()}}),a)})))).catch((function(){}))}},computed:{getParent:function(){return this.$parent},getStyle:function(){var e=this.menu,t=e.top,a=e.left;return{top:"".concat(t,"px"),left:"".concat(a,"px")}},getStyle1:function(){var e=this.menu,t=e.top,a=e.left;return{top:"".concat(t,"px"),left:"".concat(a+100,"px")}}},created:function(){}}),u=c,d=(a("3dd1"),a("2877")),h=Object(d["a"])(u,r,l,!1,null,"016dae7d",null),p=h.exports,m=a("c32a"),f=a("b85c"),v=a("d4ec"),g=a("bee2"),b=function(){function e(t,a,n){var i=this;Object(v["a"])(this,e),this.container=t,this.jcanvas=new JCanvas,this.jcanvas.init(t,a,n),this.jcanvas.strokeStyle="red",this.jcanvas.setCoordinate(1,-1),this.bitmapSys=new CanvasBitmapSys(this.jcanvas),this.bitmapSys.init(),this.bits=[],this.bitDatas=[],this.container.appendChild(this.canvas),document.body.addEventListener("keyup",(function(e){"q"==e.key&&(i.bitmapSys.clear(),i.bitmapSys.draw(),console.log("q"))}))}return Object(g["a"])(e,[{key:"setData",value:function(e){this.bitDatas=this.createBitData(e)}},{key:"draw",value:function(){var e=this.createBitGroup(this.bitDatas);this.bitmapSys.draw(),e.setCenter(10),this.bitmapSys.draw()}},{key:"setX2dXml",value:function(e){var t=parseFormulaXml(e);this.bitmapSys.clear(),this.bitmapSys.draw();var a,n=this.bitmapSys.createBitmap("group"),i=null,o=Object(f["a"])(t.children);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(s.children.length>0){i=s.children;break}}}catch(c){o.e(c)}finally{o.f()}if(i){var r=this.getOutLineGarphData(i),l=this.createBitData(r);this.createBitGroup(l,n);this.bitmapSys.draw(),n.setCenter(0,.1),this.bitmapSys.draw()}}},{key:"getOutLineGarphData",value:function(e){var t,a=[],n=Object(f["a"])(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,o=y(i,{X:"x",Y:"y",X2:"x2",Y2:"y2",StartAngle:"startAngle",Angle:"angle",R:"r",ChordH:"h",IsBulge:"isBulge"});switch(i.node){case"Point":o.type="point",a.push(o);break;case"Arc":var s=getCanvasArcByHGArc({type:"arc",start:{x:o.x,y:o.y},r:o.r,startAngle:o.startAngle,angle:o.angle});o.type="arc",Object.assign(o,s),a.push(o);break;case"TArc":var r=getCanvasArcByHGArc({type:"tArc",start:{x:o.x,y:o.y},end:{x:o.x2,y:o.y2},h:o.h,isBulge:o.isBulge});o.type="arc",Object.assign(o,r),a.push(o);break}}}catch(l){n.e(l)}finally{n.f()}return"point"===a[0].type&&a.push(a[0]),a}},{key:"createBitData",value:function(e){for(var t=[],a=[],n=0;n<e.length;n++){var i=e[n];"arc"===i.type?(t.push({type:"path",path:a}),t.push(i),a=[]):"point"===i.type&&(a.push(new JPos(i.x,i.y)),n===e.length-1&&t.push({type:"path",path:a}))}return t}},{key:"createBitGroup",value:function(e,t){var a=t&&t.createBitmap("group")||this.bitmapSys.createBitmap("group");return e.forEach((function(e){if("path"===e.type){var t=a.createBitmap("path");t.data=t.getpolyLinePath(e.path)}else if("arc"===e.type){var n=a.createBitmap("arc");e.startAngle=-e.startAngle,e.endAngle=-e.endAngle,e.isCounterClockwise=!e.isCounterClockwise,n.data=e}})),a}},{key:"canvas",get:function(){return this.jcanvas.canvas}}]),e}();function y(e,t){var a={};for(var n in t)if(void 0!==e.attr[n]){var i=t[n];a[i]=e.attr[n]}return a}var w=a("4f75"),H={name:"ImgResource",props:{onClose:Function,onSuccess:Function,type:String},data:function(){return{tree:{loading:!1,defaultProps:{children:"children",label:"sName"},data:[],inputText:""},list:{loading:!1,data:[],inputText:"",searchText:"",selectArray:[]},fadeState:!1,curPath:""}},methods:{filterNode:function(e,t){return!e||t.sName&&-1!==t.sName.indexOf(e)},initTreeHandle:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("move"!=e.type){t.next=4;break}e.tree.data=e.$parent.treeArray.map((function(e){return{sName:e.sName,type:"group"}})),t.next=8;break;case 4:return t.next=6,Object(s["g"])({dataTypeJsonArr:JSON.stringify(["path"])});case 6:a=t.sent,1==a.state?(e.tree.data=a.data.map((function(e){return{sName:e,type:"group"}})),e.tree.data.sort(Object(m["a"])("sName"))):e.$message({type:"error",message:"获取数据失败",duration:1e3,customClass:"messageClass"});case 8:e.$nextTick((function(){return e.tree.loading=!1}));case 9:case"end":return t.stop()}}),t)})))()},closeHandle:function(){var e=this;this.fadeState=!1,setTimeout((function(){e.onClose&&e.onClose()}),200)},searchHandle:function(e){"tree"==e?this.$refs.tree.filter(this.tree.inputText):this.list.searchText=this.list.inputText},nodeClickHandle:function(e,t,a){var n=this,i=this;a.tree.$children.forEach((function(e){e.node.isCurrent=!1})),t.isCurrent=!0,this.curPath=e.sName,this.list.data.splice(0),this.list.selectArray.splice(0),this.list.searchText=this.list.inputText="","manage"!=this.type&&"import"!=this.type||(this.list.loading=!0,setTimeout(Object(o["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(s["f"])({dataType:JSON.stringify(["path"]),groupName:JSON.stringify([e.sName]),getDataFlag:!0});case 2:a=t.sent,1==a.result?a.data[e.sName]&&(n.list.data=a.data[e.sName].map((function(e){return{sName:e.key,data:e.data||"",checked:!1}})),n.list.data.sort(Object(m["a"])("sName"))):n.$message({type:"error",message:"获取数据失败",duration:1e3,customClass:"messageClass"}),n.$nextTick((function(){n.list.loading=!1,n.getListData.forEach((function(e){return i.addCanvasAndRenderPath(e)}))}));case 5:case"end":return t.stop()}}),t)}))),200))},clickHandle:function(e,t){this.list.selectArray=[e]},saveHandle:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:"manage"==e.type||"import"==e.type?0==e.list.selectArray.length?e.$message({type:"info",message:"没有选中图元",duration:1e3,customClass:"messageClass"}):e.onSuccess(e.list.selectArray):e.onSuccess(e.curPath);case 1:case"end":return t.stop()}}),t)})))()},getUrlImg:function(e){e.md5,e.sName&&e.sName.substring(e.sName.lastIndexOf(".")+1);return""},addCanvasAndRenderPath:function(e){var t=this.$refs[e.sName];if(t&&e.data){var a=new b(t[0],t[0].clientWidth,t[0].clientHeight);try{var n=w["a"](e.data,{W:1e3,L:1e3}),i=getPointAndArcListByPathD(n.attr.d);a.setData(i[0]),a.draw()}catch(o){console.log(o,e.data)}}return""},keyHandle:function(){var e=event||window.event;27==e.keyCode?this.closeHandle():13!=e.keyCode||document.querySelector("input[type=text]:focus")||this.saveHandle()},menuHandle:function(e,t,a,n,i){if("import"!=this.type){var o=i;t&&"group"==t.type?(this.nodeClickHandle(t,a,n),o=3,n.tree.$children.forEach((function(e){e.node.isCurrent=!1})),a.isCurrent=!0):t&&4==i&&this.clickHandle(t),this.$refs.imgMenu.nodeMenuHandle(e,t,o)}},deleteBatch:function(){console.log(this.list.selectArray)}},computed:{getListData:function(){var e=this.list;return e.data.filter((function(t){return t.sName&&t.sName.includes(e.searchText)}))}},components:{ImgMenu:p},destroyed:function(){},created:function(){},mounted:function(){this.fadeState=!0,this.initTreeHandle()}},x=H,C=(a("15b6"),a("6e57"),Object(d["a"])(x,n,i,!1,null,"5bbbf6df",null));t["a"]=C.exports},"8a9f":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"lineToArcBox"},[a("div",{directives:[{name:"drag",rawName:"v-drag",value:{dom:"header",type:1},expression:"{dom:'header',type:1}"}],staticClass:"content"},[a("header",[a("span",{staticClass:"header_title"},[e._v(e._s(e.title))]),a("i",{staticClass:"el-icon-close",on:{click:e.closeHandle}})]),a("main",[a("el-radio",{attrs:{label:"1"},model:{value:e.curIsBulge,callback:function(t){e.curIsBulge=t},expression:"curIsBulge"}},[e._v("转为外凸弧")]),a("el-radio",{attrs:{label:"0"},model:{value:e.curIsBulge,callback:function(t){e.curIsBulge=t},expression:"curIsBulge"}},[e._v("转为内凹弧")]),a("el-divider"),a("div",{staticClass:"cfg"},[e._v(" 设置弦高: "),a("div",{staticClass:"input"},[a("QdInput",{attrs:{isNumber:!0,isShowInput:!0,isFocus:!0},model:{value:e.curChordH,callback:function(t){e.curChordH=t},expression:"curChordH"}})],1)])],1),a("footer",[a("el-button",{attrs:{size:"mini"},on:{click:e.closeHandle}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.confirmHandle}},[e._v("确认")])],1)])])},i=[],o=(a("a9e3"),a("32e0")),s=a("0ef8"),r={directives:{drag:o["a"]},components:{QdInput:s["a"]},data:function(){return{title:"转为圆弧",curIsBulge:"1",curChordH:10,isNumber:{type:Boolean,default:!0}}},props:["method","isBulge","chordH"],mounted:function(){this.title=this.method||"转为圆弧","设置属性"===this.method&&(this.curIsBulge=this.isBulge,this.curChordH=this.chordH)},methods:{closeHandle:function(){this.$emit("close")},confirmHandle:function(){"设置属性"===this.method?(this.curIsBulge==this.isBulge&&this.curChordH==this.chordH||this.$emit("confirm",Number(this.curChordH),this.curIsBulge,this.method),this.$emit("close")):(this.$emit("confirm",Number(this.curChordH),this.curIsBulge),this.$emit("close"))},lineToTArc:function(e){}}},l=r,c=(a("6307"),a("2877")),u=Object(c["a"])(l,n,i,!1,null,"b040c804",null);t["a"]=u.exports},"8db7":function(e,t,a){"use strict";var n=a("072b"),i=a.n(n);i.a},"90a9":function(e,t,a){},9180:function(e,t,a){},"91e5":function(e,t,a){"use strict";var n=a("e6c5"),i=a.n(n);i.a},9665:function(e,t,a){},"98e0":function(e,t,a){},"9be2":function(e,t,a){e.exports=a.p+"img/均分孔.jpg"},"9fac":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"left-menu-box"}},[a("div",{staticClass:"nav-menu"},[a("div",{staticClass:"nav-menu-item",class:{selected:1==e.curNav},on:{click:function(t){return e.selectNav(1)}}},[e._v(" 数据列表 ")]),a("div",{staticClass:"nav-menu-item",class:{selected:2==e.curNav},on:{click:function(t){return e.selectNav(2)}}},[e._v(" 变量 ")])]),a("div",{attrs:{id:"table_head_box"}},[a("table",{attrs:{cellspacing:"0",id:"table_head"}},[e._m(0),a("thead",{attrs:{id:"thead"}},[a("tr",[a("td",[e._v(e._s(e.theadTitle[e.curNav][0]))]),a("td",[e._v(e._s(e.theadTitle[e.curNav][1]))])])])])]),a("div",{attrs:{id:"table_body_box"}},[a("table",{attrs:{cellspacing:"0",id:"table_body"}},[e._m(1),a("tbody",{directives:[{name:"show",rawName:"v-show",value:1===e.curNav,expression:"curNav === 1"}]},[e._l(e.listDataObj.Graph,(function(t,n){return a("tr",{key:n,staticClass:"table-item",class:{"edit-item":t.isEdit,selected:e.selection.some((function(e){return e.guid==t.guid}))},on:{click:function(a){return e.selectNodeEmit(t,"Graph",n)},dblclick:function(a){return e.showAttrEmit(t,n)}}},[a("td",[e._v(e._s(e.setIndex("Graph",n)))]),a("td",[e._v(e._s(e.setName(t)))])])})),e._m(2),e._l(e.listDataObj.FaceA,(function(t,n){return a("tr",{key:t.Face+t.id,staticClass:"table-item",class:{"edit-item":t.isEdit,selected:e.selection.some((function(e){return e.guid==t.guid}))},attrs:{id:t.id},on:{click:function(a){return e.selectNodeEmit(t,"FaceA",n)},dblclick:function(a){return e.showAttrEmit(t,n)},contextmenu:function(a){return e.showHoleOrCutEdit(a,t,n,"FaceA")}}},[a("td",[e._v(e._s(e.setIndex("FaceA",n)))]),a("td",[a("span",{class:{tdSpanClass:!0,errorTdClass:t.showError},attrs:{title:e.setName(t)}},[e._v(e._s(e.setName(t)))]),a("el-tooltip",{attrs:{effect:"light",placement:"right"}},[a("div",{staticClass:"errorTxt",attrs:{slot:"content"},slot:"content"},[e._v(e._s(t.errorTxt))]),t.showError?a("i",{staticClass:"el-icon-warning errorIcon"}):e._e()])],1)])})),e._m(3),e._l(e.listDataObj.FaceB,(function(t,n){return a("tr",{key:t.Face+t.id,staticClass:"table-item",class:{"edit-item":t.isEdit,selected:e.selection.some((function(e){return e.guid==t.guid}))},attrs:{id:t.id},on:{click:function(a){return e.selectNodeEmit(t,"FaceB",n)},dblclick:function(a){return e.showAttrEmit(t,n)},contextmenu:function(a){return e.showHoleOrCutEdit(a,t,n,"FaceB")}}},[a("td",[e._v(e._s(e.setIndex("FaceB",n)))]),a("td",[a("span",{class:{tdSpanClass:!0,errorTdClass:t.showError},attrs:{title:e.setName(t)}},[e._v(e._s(e.setName(t)))]),a("el-tooltip",{attrs:{effect:"light",placement:"right"}},[a("div",{staticClass:"errorTxt",attrs:{slot:"content"},slot:"content"},[e._v(e._s(t.errorTxt))]),t.showError?a("i",{staticClass:"el-icon-warning errorIcon"}):e._e()])],1)])})),e._m(4),e._l(e.listDataObj.FB||[],(function(t,n){return a("tr",{key:t.guid,staticClass:"table-item",class:{"edit-item":t.isEdit,selected:e.selection.some((function(e){return e.guid==t.guid}))},attrs:{id:t.id},on:{click:function(a){return e.selectNodeEmit(t,"FB",n)},dblclick:function(a){return e.showAttrEmit(t,n,!0)},contextmenu:function(a){return e.showHoleOrCutEdit(a,t,n,"FB")}}},[a("td",[e._v(e._s(e.setIndex("FB",n)))]),a("td",[a("span",{class:{tdSpanClass:!0,errorTdClass:t.showError},attrs:{title:e.setName(t)}},[e._v(e._s(e.setName(t)))]),a("el-tooltip",{attrs:{effect:"light",placement:"right"}},[a("div",{staticClass:"errorTxt",attrs:{slot:"content"},slot:"content"},[e._v(e._s(t.errorTxt))]),t.showError?a("i",{staticClass:"el-icon-warning errorIcon"}):e._e()])],1)])}))],2),a("tbody",{directives:[{name:"show",rawName:"v-show",value:2===e.curNav,expression:"curNav === 2"}]},e._l(e.keys,(function(t){return a("tr",{key:t,class:{readonly:e.isReadonly(t)}},[a("td",[e._v(e._s(t))]),a("td",{staticClass:"form-item"},[a("QdInput",{attrs:{banInput:e.isReadonly(t)},on:{change:function(a){return e.editBoardAttr(a,t)}},model:{value:e.attrs[t],callback:function(a){e.$set(e.attrs,t,a)},expression:"attrs[key]"}})],1)])})),0)])])])},i=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("colgroup",[a("col",{attrs:{width:"45"}}),a("col",{attrs:{width:"85"}})])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("colgroup",[a("col",{attrs:{width:"45"}}),a("col",{attrs:{width:"85"}})])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("tr",{staticClass:"bar"},[a("td",{attrs:{colspan:"2"}},[e._v("A 面")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("tr",{staticClass:"bar"},[a("td",{attrs:{colspan:"2"}},[e._v("B 面")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("tr",{staticClass:"bar"},[a("td",{attrs:{colspan:"2"}},[e._v("封边 面")])])}],o=(a("4160"),a("caad"),a("c975"),a("13d5"),a("45fc"),a("a434"),a("b0c0"),a("ac1f"),a("2532"),a("1276"),a("159b"),a("ad04")),s=a("e67d"),r=(a("18d2"),{props:["data","attrs","face_a","face_b","view","isFromHome"],data:function(){return{listDataObj:{Graph:[],FaceA:[],FaceB:[],FB:[]},curNav:1,keydown:{ctrl:!1},theadTitle:{1:["序号","图形名称"],2:["名称","值"]},defaultKeys:["L","W","CA","CB","CC","CD","CE","CF","CG","CH","CI","CJ","CK","CL","CM","CN","CO","CP"],selectedId:"",selectedNodesId:[],selectedNodes:[],selection:[],selectRow:null,selectRowHandleMethods:Object(s["a"])()}},components:{QdInput:o["a"]},computed:{keys:function(){var e=this,t=[];return this.attrs&&this.defaultKeys.forEach((function(a){e.attrs.hasOwnProperty(a)&&t.push(a)})),t}},watch:{face_a:function(e,t){this.emptySelected()},face_b:function(e,t){this.emptySelected()},data:function(e,t){this.listDataObj=e,this.listDataObj.FB=bdDecode.getFBCutDataUI(),console.log(this.listDataObj.FB)}},mounted:function(){var e=this;window.addEventListener("keyup",this.onWinKeyup,!1),this.$bus.$on("selectCanvasNode",(function(t){if(t){var a,n,i=null===t||void 0===t?void 0:t.split("-"),o=null!==(a=null===i||void 0===i?void 0:i[0])&&void 0!==a?a:"",s=null!==(n=null===i||void 0===i?void 0:i[1])&&void 0!==n?n:"",r=e.listDataObj[o][s];console.log(e.selection),e.selectRowHandleMethods(null,null,e.selection,r)}})),bdDecode.event.bitmapClick.replaceSubcribe((function(t){e.selectNode(t.node,t.type,t.index)}),"vueBitmapClick"),bdDecode.event.bitmapDbclick.replaceSubcribe((function(t){e.showAttr(t.attr,t.index,t.isFB)}),"vueBitmapDbclick")},beforeDestroy:function(){this.$bus.$off("selectCanvasNode")},methods:{onWinKeydown:function(e){switch(e.keyCode){case 17:break;case 18:break;default:this.keydown.ctrl=!1}},onWinKeyup:function(e){switch(e.keyCode){case 17:this.keydown.ctrl=!1;break}},selectNav:function(e){this.curNav=e},setIndex:function(e,t){return t++,"Graph"===e?t:(t+=this.data.Graph.length,"FaceA"===e?t:(t+=this.data.FaceA.length,"FaceB"===e?t:(t+=this.data.FaceB.length,"FB"===e?t:void 0)))},setName:function(e){var t=e.node;return"Point"===t?"点":"Arc"===t?"圆弧":"TArc"===t?"圆弧(弦高)":"BHole"===t?"大饼孔":"VHole"===t?"垂直孔":"Cut"===t?"开槽":"Path"===t?e.name||"图元":void 0},showAttrEmit:function(e,t,a){bdDecode.event.bitmapDbclick.emit({attr:e,index:t,isFB:a})},showAttr:function(e,t,a){if(1!==this.view){var n=e.node;this.isFromHome&&["Point","Arc","TArc"].includes(n)||this.$emit("show-attr",e,n,t)}},showHoleOrCutEdit:function(e,t,a,n){var i;if(e.preventDefault(),1!==this.view){(null===(i=this.selection)||void 0===i?void 0:i.includes(t))||this.selectNodeEmit(t,n,a),this.$emit("show-menu",{x:e.clientX,y:e.clientY,ids:this.sortSelectIds(),selectRow:this.selectRow,selection:this.selection,face:n})}},editBoardAttr:function(e,t){this.$bus.$emit("editBoard",{key:t,newValue:e.newValue,oldValue:e.oldValue})},isReadonly:function(e){return 1===this.view},selectNodeEmit:function(e,t,a){bdDecode.event.bitmapClick.emit({node:e,type:t,index:a})},selectNode:function(e,t,a){var n,i;if(console.log(ObjUtil.JsonParse(e)),bdDecode.selectNodeUI(e,t),1!==this.view){var o=null!==(n=this.data[t])&&void 0!==n?n:[];(null===(i=this.selection)||void 0===i?void 0:i.some((function(t){return(null===e||void 0===e?void 0:e.Face)&&t.Face==e.Face||(null===e||void 0===e?void 0:e.node)&&t.node==e.node})))?this.selectRowHandleMethods(event,o,this.selection,e):this.selectRowHandleMethods(null,null,this.selection,e),this.selectRow=e,!1!==e.isShow&&this.$emit("select-node",e)}},setClass:function(e,t,a){var n=a+"-"+t,i={selected:!1,"edit-item":!1};return e.isEdit&&(i["edit-item"]=!0),this.selectedNodesId.indexOf(n)>-1&&(i.selected=!0),this.selectedId===n&&(i.selected=!0),i},emptySelected:function(){var e=this.selectedNodesId,t=this.selectedNodes;e.splice(0,e.length),t.splice(0,t.length)},sortSelectIds:function(){var e,t=null===(e=this.selection)||void 0===e?void 0:e.reduce((function(e,t){var a=e["Face".concat(t.Face)];return a&&a.push(null===t||void 0===t?void 0:t.id),e}),{FaceA:[],FaceB:[]});return t.FaceA.sort(compareNumbers).reverse(),t.FaceB.sort(compareNumbers).reverse(),t}}}),l=r,c=(a("132f"),a("2877")),u=Object(c["a"])(l,n,i,!1,null,"39d6c5de",null);t["a"]=u.exports},ad04:function(e,t,a){"use strict";var n,i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"QdInput"},[1===e.editState?a("el-input",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.blurHandle,expression:"blurHandle"}],on:{input:e.limitNumber},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.blurHandle(t)}},model:{value:e.getValue,callback:function(t){e.getValue=t},expression:"getValue"}}):2===e.editState?a("el-select",{attrs:{placeholder:"请选择",size:"mini"},on:{input:e.limitNumber,change:e.selectChange},model:{value:e.getValue,callback:function(t){e.getValue=t},expression:"getValue"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):a("div",{staticClass:"Qd-edit__text",on:{click:function(t){return e.toggleHandle("click")},dblclick:function(t){return e.toggleHandle("dblclick")}}},[e._v(" "+e._s(e.getLabel)+" ")])],1)},o=[],s=(a("a9e3"),a("ac1f"),a("5319"),a("b85c")),r=(a("4160"),a("a434"),a("2b0e")),l=a("26a1"),c=[],u="@@clickoutsideContext",d=0;function h(e,t,a){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!(a&&a.context&&n.target&&i.target)||e.contains(n.target)||e.contains(i.target)||e===n.target||a.context.popperElm&&(a.context.popperElm.contains(n.target)||a.context.popperElm.contains(i.target))||(t.expression&&e[u].methodName&&a.context[e[u].methodName]?a.context[e[u].methodName]():e[u].bindingFn&&e[u].bindingFn())}}!r["default"].prototype.$isServer&&Object(l["a"])(document,"mousedown",(function(e){return n=e})),!r["default"].prototype.$isServer&&Object(l["a"])(document,"mousedown",(function(e){c.forEach((function(t){return t[u].documentHandler(e,n)}))}));var p={bind:function(e,t,a){c.push(e);var n=d++;e[u]={id:n,documentHandler:h(e,t,a),methodName:t.expression,bindingFn:t.value}},update:function(e,t,a){e[u].documentHandler=h(e,t,a),e[u].methodName=t.expression,e[u].bindingFn=t.value},unbind:function(e){for(var t=c.length,a=0;a<t;a++)if(c[a][u].id===e[u].id){c.splice(a,1);break}delete e[u]}},m={name:"QdInput",props:{value:[String,Number],isNumber:{type:Boolean,default:!1},trigger:{type:String,default:"dblclick"},limitFn:{type:Function,default:null},banInput:{type:Boolean,default:!1},inputType:{type:String,default:"el-input"},options:{type:[Array]}},directives:{clickoutside:p},data:function(){return{initValue:"",editState:0,oldValue:"",changeSelect:!1}},methods:{selectChange:function(e){this.$emit("change",{oldValue:this.getValue,newValue:e}),this.editState=0,this.changeSelect=!0},toggleHandle:function(e){var t=this;this.banInput||(e===this.trigger&&(this.oldValue=this.getValue,this.setEditState(),this.$nextTick((function(){t.$el.querySelector(".el-input__inner").focus(),t.$el.querySelector(".el-input__inner").select()}))),this.$el.click())},blurHandle:function(){this.editState=0;var e=this.oldValue,t=this.getValue;e!==t&&this.$emit("change",{oldValue:e,newValue:t})},limitNumber:function(){if(this.isNumber){var e=this.$el.querySelector("input");e.value=e.value.replace(/[^(\-){1}\d.]/g,"").replace(/\.{2,}/g,".").replace(".","$#$").replace(/\./g,"").replace("$#$",".").replace(/\-{2,}/g,"-").replace("-","$#$").replace(/\-/g,"").replace("$#$","-"),this.getValue=e.value}},setEditState:function(){switch(this.inputType){case"el-input":this.editState=1;break;case"el-select":this.editState=2;break}}},computed:{getValue:{get:function(){return this.value},set:function(e){this.limitFn&&this.limitFn(e),this.$emit("input",e)}},getLabel:{get:function(){var e=String(this.value);if(this.options&&this.options.length>0){var t,a=Object(s["a"])(this.options);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(e===n.value)return n.label}}catch(i){a.e(i)}finally{a.f()}}return e}}}},f=m,v=(a("fcf0"),a("2877")),g=Object(v["a"])(f,i,o,!1,null,"d069d5fe",null);t["a"]=g.exports},ad14:function(e,t,a){"use strict";var n=a("9180"),i=a.n(n);i.a},ae01:function(e,t,a){},b4ca:function(e,t,a){},bc4d:function(e,t,a){e.exports=a.p+"img/靠背对齐.jpg"},bc9c:function(e,t,a){"use strict";(function(e){a("99af"),a("4de4"),a("c740"),a("4160"),a("caad"),a("c975"),a("d81d"),a("13d5"),a("a434"),a("b0c0"),a("a9e3"),a("b680"),a("b64b"),a("d3b7"),a("ac1f"),a("6062"),a("2532"),a("3ca3"),a("5319"),a("159b"),a("ddb0");var n,i,o=a("3835"),s=(a("96cf"),a("1da1")),r=a("53ca"),l=a("2909"),c=a("5403"),u=a("0094"),d=a("9fac"),h=a("33c4"),p=a("0297"),m=a("3de3"),f=a("d98e"),v=a("8a9f"),g=a("db04"),b=a("16f4"),y=a("4f75"),w=a("ee37"),H=a("0ef8"),x=a("6821"),C=a.n(x),_=a("551b"),k=new Dxf,D={ctrl:!1};t["a"]={name:"AppRight",directives:{resize:c["a"]},props:{mode:Boolean},data:function(){return{isBanBtn:!1,dataType:"bd",blockGuid:"",isFromHome:!1,fromHomeFile:"",toHomeFileName:"",originFileName:"",fileId:"",loading:!1,isDraw:!1,boardAttr:{},dataList:{Graph:[],FaceA:[],FaceB:[],FaceL:[],FaceR:[],FaceU:[],FaceD:[],Attr:{}},tempDataList:null,graph:null,isMoving:!1,mousedownLoc:null,curEditType:null,curNode:null,showAttrEdit:!1,showMenu:{hc:!1,point:!1,holeGroup:!1,lineToTArc:!1,editAttr:!1},menuItemShow:{hc:{toFaceA:!1,toFaceB:!1}},showMenuItem:[],attreditTitle:"属性",handleType:"",selectedHC:{},selectedLinePoints:null,isMovingLine:!1,isBanPointMenu:!1,adjacent3Nodes:null,undoStack:[],redoStack:[],editHc:{value:0,direction:"",nodes:null},showEditInput:!1,isAddHC:!1,curFace:"A",viewState:0,selectNodeOriginAttr:null,nocheckSelect:!1,selectedItem:null,rightSelectedItem:null,editInput:{edit1:{value:0,oldValue:0,node:null,show:!1},edit2:{value:0,oldValue:0,node:null,show:!1}},inputShow:!1,isDraging:!1,noClickFnBtn:!0,sName:"",ImgResourceState:!1,dialogType:"",currentX2dData:null,styleMode:"默认",holeSlotRuleState:!1,holeSlotRuleData:{},orginCncback:"",otherFrameBtn:void 0,dataFromMainApp:{},dialogFormVisible:!1,formType:"斜线",form:{radius:"30",width:"30",height:"30"},dialogVisible_line2arc:{LineToArc:!1,method:"转为圆弧",isBulge:null,chordH:null},rightPointMenuList:[{label:"属性编辑",method:this.ediltNodeAttr,args:[],show:!1},{label:"转为斜线",method:this.openTransformPointFrom,args:["斜线"],show:!1},{label:"转为直角",method:this.openTransformPointFrom,args:["直角"],show:!1},{label:"转为外凸弧",method:this.openTransformPointFrom,args:["外凸弧"],show:!1},{label:"转为内凹弧",method:this.openTransformPointFrom,args:["内凹弧"],show:!1},{label:"删除",method:this.deletePoint,args:[],show:!1}],errorobjs:null}},computed:{showEdit1Data:{get:function(){return Number(this.editInput.edit1.value.toFixed(1)||0)},set:function(e){this.editInput.edit1.value=Number(e||0)}},showEdit2Data:{get:function(){return Number(this.editInput.edit2.value.toFixed(1)||0)},set:function(e){this.editInput.edit2.value=Number(e||0)}},selection:function(){var e,t=this.$refs.left;return null!==(e=null===t||void 0===t?void 0:t.selection)&&void 0!==e?e:[]}},watch:{curFace:function(e){hcEditLabel.isShow=!1,this.draw()},viewState:function(e){this.isDraw?this.noClickFnBtn=1===e:this.noClickFnBtn=!0},boardAttr:{deep:!0,handler:function(e){this.$bus.$emit("boarAttr",e)}}},mounted:function(){var t=this,a=this;this.importDataStrEvent(),this.importDataEvent(),this.initEvent(),this.selectFaceEvent(),this.loadBDEvent(),this.loadXmlDataEvent(),this.loadX2dEvent(),this.saveToHomeEvent(),this.openFromMainAppEvent(),this.clearExitToHomeEvent();var n=!1;bdDecode.ui.getBdXml=function(){return t.getBdXml()},e.Qd_OpenBdEdit=function(e){t.$refs.topBar.isLocalFile=!1,t.dialogType="openBd",t.ImgResourceSuccess(e)},e.loadBD=function(e,n){var i,o,s,r=null!==(i=null===(o=window)||void 0===o||null===(s=o.opener)||void 0===s?void 0:s.name)&&void 0!==i?i:"",l={"tab_数据处理中心主页面_iframe":["源代码"],qd_window_bom:["源代码"],qd_window_bom3:["源代码"],kailiao:["源代码"]};t.otherFrameBtn=null===l||void 0===l?void 0:l[r],a.loadBd(e,n)};try{e.openFromMainApp=function(e,t){n=!0,bdDecode.event.openFromMainApp.emit({data:e,limitObj:t})}}catch(i){this.loading=!1,this.$message({type:"error",message:"获取BD失败"}),console.error("从主页打开时报错",i)}setTimeout((function(){var t,a,i;if(!n&&(null===(t=window)||void 0===t||null===(a=t.opener)||void 0===a||null===(i=a.UIAction)||void 0===i?void 0:i.getBdEditorData)){var o=window.opener.UIAction.getBdEditorData();e.openFromMainApp(o.modelData,o.other)}}),2e3),setTimeout((function(){t.loadBd(_["a"],"data.bd")}),1e3)},methods:{resizefn:function(){},initEvent:function(){this.initCanvasEvent(),this.initBusEvent()},initCanvasEvent:function(){var e=this;this.$bus.$on("canvasResize",(function(t){e.onWindowResize(t)})),canvas2d.canvas.addEventListener("mousedown",this.onMouseDown),canvas2d.canvas.addEventListener("mousemove",this.mousemove),canvas2d.canvas.addEventListener("mousewheel",this.mousewheel),canvas2d.canvas.addEventListener("contextmenu",this.onContextmenu,!1),canvas2d.canvas.addEventListener("click",this.onClick,!1),canvas2d.canvas.addEventListener("mouseup",this.mouseup),canvas2d.canvas.addEventListener("dblclick",this.dblclick),window.addEventListener("keydown",this.onWinKeydown,!1),window.addEventListener("keyup",this.onWinKeyup,!1),window.addEventListener("mousedown",this.onWinMousedown,!1)},initBusEvent:function(){var e=this,t=this;function a(e,a){t.$bus.$on(e,a)}a("setCurrent",this.setCurrent),a("selectFace",this.selectFace),a("btnClick",this.btnClick),a("cncback",this.cncbackChange),a("editBoard",this.updateAllNode),a("editXMLCode",this.editXMLCode),a("saveXMLCode",this.updateXML),a("createX2d",this.createX2d),a("saveAsPath",this.saveAsPath),a("pathManage",this.pathManage),a("importPathData",this.importPathData),a("changePlane",this.changePlane),a("leftMenuHandle",this.leftMenuHandle),a("saveX2d",this.saveX2d),a("showAttr",this.showAttr),a("exportPng",this.exportPng),a("openHoleSlotRule",this.openHoleSlotRule),a("isShowHoleInfo",this.isShowHoleInfo),a("resetRect",this.resetRect),a("addGroupHole",this.addGroupHole),a("keyboardHandle",this.keyboardHandle),a("loadXmlData",this.loadXmlData),a("lineToArc",(function(){e.handleType="lineToArc"})),a("clickApp",(function(t){"lineToArc"!==e.handleType&&e.hideMenu(t)})),a("selectCanvasNode",(function(t){!t&&e.curNode&&(e.curNode.color="#fff",e.curNode=null)})),a("getCurrentX2d",(function(t){t(e.getX2d())})),a("loadBd",(function(t){t&&e.loadBd(t)}))},openFromMainAppEvent:function(){var e,t=this;(null===(e=window.opener)||void 0===e?void 0:e.gMainApp)&&(this.loading=!0);try{bdDecode.event.openFromMainApp.replaceSubcribe((function(e){var a,n;t.isBanBtn=void 0!==(null===(a=e.limitObj)||void 0===a?void 0:a.isCanAllEdit)&&!(null===(n=e.limitObj)||void 0===n?void 0:n.isCanAllEdit);var i=t;t.fromHomeFile=t.toHomeFileName=e.data.BasicGraphic,t.isFromHome=!0,t.$vuex.parentpagename="home",t.blockGuid=e.data.guid;var o=window.opener&&window.opener.gMainApp?window.opener.gMainApp:null;if(!o)return t.loading=!1,void console.error("window.opener.gMainApp不存在");o.GetBlockHolesInfo(e.data.guid,(function(a){var n=a?ObjUtil.JsonParse(a):void 0;HgServiceTool.getBdXmlFromMainApp(o,e.data,(function(n){if(0===n.result)i.$message({type:"error",message:n.message});else{var o=n.bdJson,s=n.fileName,r=n.name,l=(n.type,n.bomName,n.label,n.xml,n.errorobjs);if(i.toHomeFileName=s,i.orginCncback=o.attr.CncBack,i.errorobjs=l,o.attr.CncBack=0,i.dataFromMainApp=n,bdDecode.holeInfo=void 0,a)for(var c in a){var u,d;if(null===a||void 0===a||null===(u=a[c])||void 0===u||null===(d=u.holeinfo)||void 0===d?void 0:d[e.data.guid]){bdDecode.holeInfo=a[c].holeinfo[e.data.guid];break}}console.log(ObjUtil.JsonParse(o)),i.updateBdJson(o,r);var h=i.getBdXml();bdDecode.originAppBD=h,bdDecode.originBlock=e.data,i.loading=!1,setTimeout((function(){t.cncbackChange({CncBack:0,degree:0})}),500)}}),{defHoleInfo:n})}))}),"AppRight")}catch(a){console.log(a),this.loading=!1}},updateXML:function(e,t){var a=this;BDUtils.initData({xml:e,fileName:t},(function(e){a.afterInitBdData(t,e)}))},updateBdJson:function(e,t){var a=this;BDUtils.initData({data:e,fileName:t,isJson:!0},(function(e){a.afterInitBdData(t,e)}))},afterInitBdData:function(e,t){var a=this;if(a.reset(),hcEditLabel.init(),e&&(a.sName=e.replace(/\.bd/,"")||""),t){a.boardAttr=bdDecode.boardAttr=BDUtils.getBoardAttr(),this.isFromHome&&(this.originFileName=a.boardAttr.originFileName||"");var o=a.getSize(),s=o.bl,r=o.bw,l=o.bh;transform2d.init({bl:s,bw:r,rotation:cncbacks[a.boardAttr.CncBack]}),bdDecode.jGraph=a.graph=new JGraph(canvas2d.ctx,BDUtils.getGraphData(),a.boardAttr),graphUtil.init(a.graph,s,r,l),this.initDataList(),hcEditLabel.setBound(a.graph.getBound()),n=new PreviewLabel(s,r,l),i=new FbViewLabel(canvas2d.ctx,{bl:s,bw:r,bh:l}),bdDecode.jFbViewLabel=i,n.setPreviewData(this.dataList),i.setPreviewData(a.graph.nodes,this.dataList.FaceA,this.dataList.FaceB),this.updateHCErrorobj(),this.isDraw=!0,this.draw()}},setCurrent:function(e){if(!e)return this.currentX2dData=null;this.sName="",this.currentX2dData=e,this.updateXML(e.data,e.sName)},reset:function(){this.boardAttr=bdDecode.boardAttr={},this.dataList.Graph=[],this.dataList.FaceA=[],this.dataList.FaceB=[],this.isDraw=!1,this.tempDataList=null,this.graph=null,this.undoStack=[],this.redoStack=[],transform2d.reset(),canvas2d.clear()},onWindowResize:function(e){var t=this.mode?window.innerWidth-e.w-140:window.innerWidth-e.w,a=window.innerHeight-70;canvas2d.setSize(t,a),bdDecode.jcanvas.resize(t,a),this.draw()},initDataList:function(){var e=this,t=BDUtils.getFaceData("hole",e.graph.getLines()),a=BDUtils.getFaceData("cut"),n=BDUtils.getFaceData("path");e.dataList={Graph:[],FaceA:[],FaceB:[]},this.dataList.Graph=BDUtils.getGraphData().children;var i=["A","B"];i.forEach((function(i){for(var o=[].concat(Object(l["a"])(t[i]),Object(l["a"])(a[i]),Object(l["a"])(n[i])),s=0;s<o.length;s++)e.dataList["Face"+i].push(o[s])})),e.setOhterFaceHoles()},setOhterFaceHoles:function(){var e=this,t=this,a=[].concat(Object(l["a"])(this.dataList.FaceA),Object(l["a"])(this.dataList.FaceB)).filter((function(e){return"BHole"===e.node})),n=a.map((function(t){return t.getVHoleByBHole({BH:e.boardAttr.BH})})).filter((function(e){return e}));n.forEach((function(e){var a="Face".concat(e.Face),n=t.dataList[a];n||(t.dataList[a]=[]),t.dataList[a].push(e)}))},onMouseDown:function(e){if(this.isDraw)switch(e.preventDefault(),e.button){case 0:this.mouseLeft(e);break;case 1:this.mouseMid(e);break}},mouseLeft:function(e){if(this.isDraw){var t=this;t.mousedownLoc={x:mouse.pos.x,y:mouse.pos.y},t.handleType||(t.isMoving=!0),t.mousedownSelect(e);var a=this.selectedItem&&"Line"===this.selectedItem.type;switch(a&&!t.handleType&&(0==this.boardAttr.CncBack?this.isMovingLine=!0:this.$message({type:"info",message:"请先切换到下靠挡再移动边"})),t.handleType){case"addCut":t.addNewNode("cut");break;case"editHC":t.editHC();break;case"addGroupHole":a&&t.openAddholeDialog();break;case"lineToArc":a&&(this.showLine2ArcDialog(),this.cancelSelectSide());break;default:if(1===t.viewState)return;t.showSelectHCLabel()}t.addHCToDataList()}},mouseMid:function(e){this.isDraw&&2===e.detail&&this.resetView()},mousemove:function(e){if(this.isDraw&&!this.inputShow)if(canvas2d.setCursor("default"),this.isMoving)0===this.viewState&&1===hcEditLabel.selectedType?(this.moveSelectHC(this.curNode),this.isDraging=!0):D.ctrl&&0===this.viewState?(hcEditLabel.setDragBox(this.mousedownLoc,mouse.pos),this.draw()):2===hcEditLabel.selectedType?this.moveHoleGroup():this.moveCvs(),canvas2d.setCursor("pointer");else if(this.isAddHC)this.moveSelectHC(hcEditLabel.tempHC,this.isAddHC);else{if(this.nocheckSelect){var t=graphUtil.isIn();this.changeOutlineStyleAndCursorStyle(t),t.isIn&&("Point"===t.item.type?(canvas2d.setCursor("pointer"),this.selectedItem=t.item):this.selectedItem&&"Point"===this.selectedItem.type&&(this.selectedItem=null))}if(this.selectedItem&&!this.handleType){var a=this.selectedItem.type;"Line"===a&&this.isMovingLine&&(this.moveLine(this.selectedItem.node),this.isDraging=!0)}switch(this.handleType){case"editHC":this.changeSelectHCColor(e),this.draw(),canvas2d.drawCursorText(mouse.pos.x,mouse.pos.y,"选择孔槽");break;case"":if(1===this.viewState)return;this.changeSelectHCColor(e),this.checkHcEditLabel();break}this.draw()}},mouseup:function(e){this.isDraw&&(canvas2d.setCursor("default"),transform2d.resetTempMatrix(),this.dragSelectHole(),this.draw(),this.isDraging&&(graphUtil.setGraphChild(),this.dataList.Graph=graphUtil.graph.children,this.tempDataList&&(this.addUndo(this.tempDataList),this.tempDataList=null)),0===this.viewState&&(this.nocheckSelect=!0),hcEditLabel.tempHC||(this.isAddHC=!1),this.isMoving=!1,this.isMovingLine=!1,this.selectNodeOriginAttr=null)},mousewheel:function(e){if(this.isDraw&&!this.inputShow){e.preventDefault();var t=e.deltaY||-e.wheelDeltaY;transform2d.zoomCanvas(t),this.draw()}},dblclick:function(e){this.isDraw&&this.showHcEditLabelInput()},onContextmenu:function(e){var t=this;e.preventDefault(),this.cancelSelectSide(),this.isDraw&&(this.mousedownSelect(e),this.rightSelectedItem||this.selectHC(mouse.pos.x,mouse.pos.y,(function(e,a){t.rightSelectedItem={node:e,index:a,type:e.node}})),hcEditLabel.clearTempHC(),this.handleType="",this.canvasRightMenu(e),this.draw())},onClick:function(e){this.isDraw&&(1===this.viewState||this.isDraging?this.isDraging=!1:this.selectedItem&&!this.handleType&&(this.setNodeColor(this.selectedItem),this.draw(),this.showGraphEditInput(this.selectedItem),graphUtil.setGraphChild(),this.dataList.Graph=graphUtil.graph.children,graphUtil.tempChilds=null))},onWinKeydown:function(e){switch(e.keyCode){case 17:break;case 18:break;case 67:this.copyHCToHcEditLabel();break;case 37:this.moveByKeyBoard(-1,0);break;case 38:this.moveByKeyBoard(0,1);break;case 39:this.moveByKeyBoard(1,0);break;case 40:this.moveByKeyBoard(0,-1);break}},onWinKeyup:function(e){switch(e.keyCode){case 46:this.deleteHC(-1);break;case 17:D.ctrl=!1;break;case 86:this.stick();break;case 90:D.ctrl&&this.revoke();break}},onWinMousedown:function(e){var t=e.target;"exportX2d"===t.id||t.classList.contains("select-dropdown-item")||changeDisplay("exportX2d-dropdown","none"),t.classList.contains("input-item")||this.inputShow&&this.hideInput()},mousedownSelect:function(e){if(this.nocheckSelect){this.selectedItem=null,this.rightSelectedItem=null;var t=graphUtil.isIn();if(t.isIn){var a=t.item.type;["addGroupHole","lineToArc"].includes(this.handleType)&&"Line"===a?this.selectedItem=t.item:("Point"===a?this.selectedItem=t.item:"Line"===a?t.item.isInCenter?"contextmenu"===e.type?this.selectedItem=t.item:(this.isMoving=!1,this.splitLine(t.item.node)):"contextmenu"===e.type||(this.isMoving=!1,this.nocheckSelect=!1,this.selectedLinePoints={p1:getPoint(t.item.node.p1),p2:getPoint(t.item.node.p2)},this.tempDataList=copyObject(this.dataList),this.selectedItem=graphUtil.preMoveLine(t.item)):"Arc"===a&&("contextmenu"===e.type||(t.item.node.isSelected=!0,this.selectedItem=t.item)),"Point"!==a&&"Arc"!==a&&"TArc"!==a||("contextmenu"===e.type&&(this.rightSelectedItem=t.item),this.$bus.$emit("selectCanvasNode","Graph-".concat(t.item.index))))}}},draw:function(e){if(this.isDraw&&canvas2d.isDisplay&&transform2d){e=e||transform2d.matrix,canvas2dAction.fbView=i,canvas2dAction.curFace=this.curFace,canvas2d.clear();var t=Number(this.boardAttr.CncBack);0===this.viewState&&(["L","R","U","D"].includes(this.curFace)?(canvas2d.drawAxis(),canvas2dAction.drawFbView(e)):(canvas2d.drawAxis(t),this.drawEditView(e))),1===this.viewState&&(canvas2d.drawAxis(t),this.drawPreView(e))}},drawEditView:function(e){this.drawGraph(e),this.drawFBLabel(),canvas2dAction.drawDirectLabel()},drawPreView:function(e){var t=this.dataList.FaceA.length,a=this.dataList.FaceB.length,i=canvas2d.canvas,o=i.clientWidth,s=i.clientHeight,r=n.getFacePreviewData("A"),l=n.getFacePreviewData("B"),c=1,u={LR:{origin:{A:[0,0],B:[o/2,0]},viewSize:[o/2,s]},UD:{origin:{A:[0,s/2],B:[0,0]},viewSize:[o,s/2]}},d=r.direct;if(90!==transform2d.rotation&&270!==transform2d.rotation||(d="LR"===d?"UD":"LR"),t>0&&a>0&&(c=2),"默认"===this.styleMode&&this.drawFBLabel(),1===c)0===a?this.drawPreViewLabel("A",r,e):this.drawPreViewLabel("B",l,e);else{var h=u[d],p=h.origin["A"],m=h.origin["B"],f=.8*transform2d.getScale(r.width,r.height,h.viewSize[0],h.viewSize[1]),v=.8*transform2d.getScale(l.width,l.height,h.viewSize[0],h.viewSize[1]),g=f<v?f:v;this.drawPreViewLabel("A",r,e,p,h.viewSize,g),this.drawPreViewLabel("B",l,e,m,h.viewSize,g)}},drawPreViewLabel:function(e,t,a,i,o,s){var r=transform2d.getViewMatrix(a,t.width,t.height,i,o,s);this.graph.draw(r),this.graph.drawGrain(r,BDUtils.getBdGrainAngle(this.boardAttr.DI,this.boardAttr.CncBack,this.boardAttr.CncBack1)),this.dataList["Face"+e].forEach((function(e){e.draw(r),e.drawLabel(r)})),n.drawHoleLabel(t,r)},drawFBLabel:function(){var e=canvas2d.canvas,t=e.clientWidth,a=e.clientHeight,n=this.getFBsByCncback(),i=20,o=[{x:t/2,y:i},{x:t/2,y:a-i-10},{x:i,y:a/2},{x:t-i-65,y:a/2}];o.forEach((function(e,t){canvas2d.drawTriangle({x:e.x,y:e.y,text:n[t][0],isUp:n[t][1]})}))},drawGraph:function(e){var t=this,a=transform2d.getViewMatrix(e),n=t.dataList["Face"+t.curFace];t.graph.draw(a,t.curFace),n&&n.forEach((function(e){e.draw(a)})),hcEditLabel.draw(a,t.curFace),this.drawOther(a)},drawOther:function(e){this.selectedItem&&"Point"===this.selectedItem.type&&canvas2dAction.drawPoint(this.selectedItem.node,e)},moveCvs:function(){canvas2d.setCursor("move"),transform2d.moveCanvas(this.mousedownLoc,mouse.pos),this.draw(transform2d.tempMatrix)},showAttr:function(e,t,a){this.selectedHC={},this.curEditType=t,this.curNode=e,this.showAttrEdit=!0,this.handleType="editNodeAttr"},showHoleCutMenu:function(e){var t=this.menuItemShow.hc;"FaceA"===e.face?(t.toFaceA=!1,t.toFaceB=!0):(t.toFaceA=!0,t.toFaceB=!1),this.selectedHC=e.ids,this.showRightMenu("hcMenu","hc",e.x,e.y)},hideAttr:function(e){this.showAttrEdit=!1,this.attreditTitle="属性",this.editAttr(e),this.handleType=""},editAttr:function(e){if(this.curNode)switch(this.handleType){case"editNodeAttr":this.updateNodeAttr(e);break}else{var t;if(!e)return;"VHole"!==e.node&&"BHole"!==e.node||(t="hole"),"Cut"===e.node&&(t="cut"),t&&(hcEditLabel.addTempHC(t,e,this.graph.getLines()),this.isAddHC=!0)}this.draw(),this.handleType=""},updateNodeAttr:function(e){if(this.addUndo(),this.curNode.Face)e&&this.curNode.Face!==e.Face&&this.moveToOtherFace(e.Face),this.curNode instanceof Hole&&this.curNode.update(e),this.curNode instanceof Cut&&this.curNode.update(e),"Path"===this.curNode.node&&this.curNode.update(e);else{for(var t in e)this.curNode.attr[t]=e[t];this.graph.update(this.curNode)}this.updateFbViewData()},seletcNode:function(e){hcEditLabel.isShow=!1,["VHole","BHole","Cut","Path"].includes(e.node)&&e.Face===this.curFace&&this.showHCEditLabel(e),this.selectedItem=null,this.setNodeColor(e),this.draw()},showHCEditLabel:function(e){hcEditLabel.checkBound([e],this.curFace),hcEditLabel.isShow=!0,hcEditLabel.selectedType=1,this.editHc.nodes=[e]},setNodeColor:function(e){this.resetAllNodeColor(),graphUtil.checkPointAndArc(e)||(e.color="red",this.curNode=e)},resetAllNodeColor:function(){var e=[].concat(Object(l["a"])(this.dataList["FaceA"]),Object(l["a"])(this.dataList["FaceB"]));e.forEach((function(e){e.reColor()}))},updateAllNode:function(e){var t=this,a=copyObject(this.boardAttr);a[e.key]=e.oldValue,this.addUndo(void 0,a),e&&e.key&&(this.boardAttr[e.key]=e.newValue),this.dataList.Graph.forEach((function(e){var a=e.attr;for(var n in a)if("object"===Object(r["a"])(a[n])){var i=a[n]?a[n].formula:"";void 0!==i&&(a[n].value=calcFormula(a[n].formula,t.boardAttr))}})),this.graph.update();var n=this.getSize(),i=n.bl,o=n.bw,s=n.bh;graphUtil.setSize(i,o,s);var c=[].concat(Object(l["a"])(this.dataList.FaceA),Object(l["a"])(this.dataList.FaceB));c.forEach((function(e){for(var a in e)if("HDirect"!==a&&"object"===Object(r["a"])(e[a])){var n=e[a]?e[a].formula:"";void 0!==n&&(e[a].value=calcFormula(n,t.boardAttr))}"Path"===e.node?e.update():e instanceof Hole&&(e.update(t.graph.getLines()),e.isEdit=!1)})),this.updateAllHoleByHoleRule(),this.updateFbViewData(),this.draw()},selectFaceEvent:function(){var e=this;bdDecode.event.selectFace.replaceSubcribe((function(t){canvas2dAction.setCurFace(t),e.resetView(),"0"===t?e.changeViewState():(e.curFace=t,e.viewState=0,e.nocheckSelect=!0,canvas2d.isDisplay&&e.draw(),bdDecode.jcanvas.isDisplay&&bdDecode.jcanvas.bitmapUpdate())}),"AppRight")},selectFace:function(e){bdDecode.event.selectFace.emit(e)},hideMenu:function(e){var t=!!hasClass(e.target,"hole-cut-menu")||hasClass(e.target.parentNode,"hole-cut-menu");t||this.hideRightMenu()},moveToFaceA:function(){this.addUndo(),this.moveToOtherFace("A")},moveToFaceB:function(){this.addUndo(),this.moveToOtherFace("B")},moveToOtherFace:function(e){var t,a="A"===e?"FaceB":"FaceA",n="Face"+e,i=this.dataList,o=i[a],s=i[n],r=null!==(t=null===this||void 0===this?void 0:this.selection)&&void 0!==t?t:[];s.push.apply(s,Object(l["a"])(null===r||void 0===r?void 0:r.reduce((function(t,a){var n=o.findIndex((function(e){return(null===e||void 0===e?void 0:e.id)==(null===a||void 0===a?void 0:a.id)}));return-1!=n&&(a.Face=e,t=t.concat(o.splice(n,1))),t}),[]))),this.hideRightMenu(),this.updateFbViewData(),this.draw(),this.selectedHC={}},copyToOtherFace:function(){var e,t=null!==(e=this.selection)&&void 0!==e?e:[],a=this.menuItemShow.hc.toFaceB?"A":"B",n="B"==a?"A":"B",i=this.dataList["Face".concat(n)];this.addUndo(),t.forEach((function(e){var t,a=copyObject(e);a.Face=n,e instanceof Hole&&(t=new Hole(a,a.node,BDUtils),t.setNotAuto(1),delete t.Rule),e instanceof Cut&&(t=new Cut(a),t.setNotAuto(1)),i.push(t)})),this.hideRightMenu(),this.updateFbViewData(),this.draw(),this.selectedHC={}},moveInFace:function(e){var t=this.selectedHC["FaceA"],a=this.selectedHC["FaceB"];if(t.length+a.length>1)this.$message({type:"info",message:"只支持移动单个",duration:2e3});else{var n=Number(t[0]||-1),i=Number(a[0]||-1),o=t.length>0?"FaceA":a.length>0?"FaceB":"",s="FaceA"===o?n:i,r=this.dataList[o],l=this.dataList[o][s];if("up"===e&&0!==s){this.addUndo();var c=r[s-1];r.splice(s,1,c),r.splice(s-1,1,l)}else if("down"===e&&s!==r.length-1){this.addUndo();var u=r[s+1];r.splice(s,1,u),r.splice(s+1,1,l)}this.updateFbViewData(),this.draw()}},deleteHC:function(e){if(-1===e){var t;this.addUndo();var a=null!==(t=this.selection)&&void 0!==t?t:[],n="Face".concat(this.menuItemShow.hc.toFaceB?"A":"B"),i=this.dataList[n];a.forEach((function(e){var t,a=i.findIndex((function(t){return t==e}));-1!=a&&(i.splice(a,1),null===e||void 0===e||null===(t=e.delete)||void 0===t||t.call(e))}))}else{var o="Face"+this.curNode.Face,s=this.dataList[o][e];s.color="#fff",this.addUndo(),this.dataList[o].splice(e,1)}hcEditLabel.closeHoleGroup(),this.hideRightMenu(),this.updateFbViewData(),this.draw()},addNewNode:function(e,t){"cut"===e&&(this.showAttrEdit=!0,this.attreditTitle="增加槽",this.curEditType="Cut",this.curNode=null),"hole"===e&&(this.showAttrEdit=!0,this.attreditTitle=t?"增加大饼孔":"增加垂直孔",this.curEditType=t?"BHole":"VHole",this.curNode=null)},changeHandleType:function(e){this.handleType=e},changeSelectHCColor:function(e){var t=this;this.selectHC(mouse.pos.x,mouse.pos.y,(function(e){e.color="red",canvas2d.setCursor("pointer")}),(function(e){e!==t.curNode&&e.reColor()}))},selectHC:function(e,t,a,n){for(var i=transform2d.getViewMatrix(),o=this.dataList["Face"+this.curFace]||[],s=0;s<o.length;s++)o[s].isPointInPath(i,e,t)?a&&a(o[s],s):n&&n(o[s],s)},editHC:function(){var e=this;this.selectHC(mouse.pos.x,mouse.pos.y,(function(t,a){e.showAttr(t,t.node,a),t.reColor()}))},splitLine:function(e){var t=this;this.$prompt("等分数量","",{inputPattern:/^[0-9]*$/,inputErrorMessage:"请输入数字,且为整数",showClose:!1}).then((function(a){var n=a.value;if(isNumber(n)){var i=parseInt(n),o={x:e.x1,y:e.y1},s={x:e.x2,y:e.y2},r=t.dataList.Graph.indexOf(e.p2),l=math2d.getLineEqualPoints(o,s,i);t.addMorePoint(l,r,"insert"),t.graph.update(),t.draw()}}))},deletePoint:function(){if(this.adjacent3Nodes&&!this.isBanPointMenu){var e=this.adjacent3Nodes.center,t=this.graph.children.indexOf(e);this.addUndo(),this.graph.children.splice(t,1),this.graph.update(),this.updateFbViewData(),this.draw(),this.selectedItem=null}},ediltNodeAttr:function(){if(this.rightSelectedItem){var e=this.rightSelectedItem.node;"TArc"!==e.node&&"Arc"!==e.node||(e=e.arc);var t=this.graph.children.indexOf(e);-1===t&&(t=this.rightSelectedItem.index),this.$bus.$emit("showAttr",e,e.node,t)}this.rightSelectedItem=null},moveLine:function(e){if(this.selectedLinePoints){var t=this.selectedLinePoints.p1,a=this.selectedLinePoints.p2,n=getMoveD(this.mousedownLoc);graphUtil.moveLine(e,t,a,n)}},showRightMenu:function(e,t,a,n){this.hideRightMenu();var i=document.getElementById(e);i.style.left=a+10+"px",i.style.top=n+"px",this.showMenu[t]=!0},hideRightMenu:function(){for(var e in this.showMenu)this.showMenu[e]=!1},canvasRightMenu:function(e){if(this.selectedItem)"Point"===this.selectedItem.type?(this.setAdjacentPoints(),this.showRightMenu("pointMenu","point",e.x,e.y)):"Line"===this.selectedItem.type&&this.showLine2ArcDialog();else if(this.rightSelectedItem){var t=this.rightSelectedItem.node;if("Arc"===t.node)return;if("TArc"===t.node){var a=t.attr.IsBulge.value,n=t.attr.ChordH.value;this.showLine2ArcDialog(!0,"设置属性",a,n)}else this.showRightMenu("editAttr","editAttr",e.x,e.y)}else hcEditLabel.setSelectedToCurGroup()?this.showRightMenu("holeGroup","holeGroup",e.x,e.y):this.hideRightMenu()},setAdjacentPoints:function(){var e=this.selectedItem.index,t=this.dataList.Graph.length,a=0===e?t-1:e-1,n=e===t-1?0:e+1,i=this.dataList.Graph[a],o=this.dataList.Graph[n];if("Point"===i.node&&"Point"===o.node){var s=[getPoint(i),getPoint(this.selectedItem.node),getPoint(o)],r=s[0],l=s[1],c=s[2],u=math2d.threePointsClockwise(r,l,c);0===u?this.updateRightPointMenu("水平点"):this.updateRightPointMenu("转折点"),this.isBanPointMenu=!1,this.adjacent3Nodes={last:i,center:this.selectedItem.node,next:o}}else this.isBanPointMenu=!0},point2Angle:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30;if(this.adjacent3Nodes&&!this.isBanPointMenu){var n="rightAngle"===e?3:2,i=this.adjacent3Nodes,o=[getPoint(i.last),getPoint(i.center),getPoint(i.next)],s=o[0],r=o[1],l=o[2],c=l.x-s.x,u=l.y-s.y,d=math2d.threePointsClockwise(s,r,l);if(d<0&&(c>0&&u>0||c<0&&u<0)||d>0&&(c<0&&u>0||c>0&&u<0)){var h=[a,t];t=h[0],a=h[1]}var p=this.graph.children.indexOf(i.center),m=math2d.getPointsIn2Line(i,n,t,a);this.addMorePoint(m,p),this.graph.update(),this.draw(),this.selectedItem=null}},point2Arc:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"外凸",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;if(this.adjacent3Nodes&&!this.isBanPointMenu){var n=this.adjacent3Nodes,i=math2d.getPointsIn2Line(n,2,a,a),o=i[0],s=getCoordinate(n.center),r=i[1],l=graphUtil.isClockwise(o,s,r);if(0!==l){var c,u=math2d.getAngleBy3Points(o,s,r),d=Math.tan(math2d.toRads(u/2)),h=math2d.round(d*a),p=math2d.getCircleCenter(o,r,h),m=p[0],f=p[1],v=180-u,g=math2d.lineAngle(o.x,o.y,m.x,m.y),b=math2d.lineAngle(o.x,o.y,f.x,f.y);0!==g&&180!==g&&(g=-g),0!==b&&180!==b&&(b=-b);var y=math2d.getLineLength(m.x,m.y,s.x,s.y),w=math2d.getLineLength(f.x,f.y,s.x,s.y);l>0&&(t="外凸"===t?"内凹":"外凸");var H="外凸"===t?1:-1,x=l>0?1:-1,C=y>w?1:-1,_=H*x*C;c=_<0?g:b,"内凹"===t&&(v*=-1),c=math2d.round(c);var k={node:"Point",attr:{X:{formula:o.x,value:o.x},Y:{formula:o.y,value:o.y},Hotspot:{formula:"1",value:"1"},IsDim:{formula:"0",value:"0"}}},D={node:"Point",attr:{X:{formula:r.x,value:r.x},Y:{formula:r.y,value:r.y},Hotspot:{formula:"1",value:"1"},IsDim:{formula:"0",value:"0"}}},N={node:"Arc",attr:{X:{formula:o.x,value:o.x},Y:{formula:o.y,value:o.y},R:{formula:h,value:h},StartAngle:{formula:c,value:c},Angle:{formula:v,value:v},Hotspot:{formula:"0",value:"0"},IsDim:{formula:"0",value:"0"}}},A=[k,N,D],S=this.graph.children.indexOf(n.center);this.addUndo(),(e=this.graph.children).splice.apply(e,[S,1].concat(A)),this.graph.update(),this.updateFbViewData(),this.draw(),this.selectedItem=null}}},addPoint:function(e,t,a){var n={node:"Point",attr:{X:{formula:e,value:e},Y:{formula:t,value:t},Hotspot:{formula:"1",value:"1"},IsDim:{formula:"0",value:"0"}}};this.addUndo(),this.dataList.Graph.splice(a,0,n),this.updateFbViewData()},addMorePoint:function(e,t){var a,n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"replace",o=[];(e.forEach((function(e){var t=math2d.round(e.x,4),a=math2d.round(e.y,4);o.push({node:"Point",attr:{X:{formula:t,value:t},Y:{formula:a,value:a},Hotspot:{formula:"1",value:"1"},IsDim:{formula:"0",value:"0"}},guid:ObjUtil.guid})})),this.addUndo(),"replace"===i)&&(a=this.graph.children).splice.apply(a,[t,1].concat(o));"insert"===i&&(n=this.graph.children).splice.apply(n,[t,0].concat(o));this.updateFbViewData()},importDataStrEvent:function(){var e=this;bdDecode.event.bdStrImport.replaceSubcribe((function(t){if("x2d"===t.fileType)e.loadX2d(t.str,t.fileName);else if("dxf"===t.fileType)if(t.cfg&&t.cfg.isToPath){var a=k.dxfToPath(t.str);a.attr.name=t.fileName.replace(".dxf",""),e.importPathData(a)}else{var n=k.dxfToBd(t.str);if(t.cfg.onlySetGraph){var i=e.getSize(),o=i.bl,s=i.bw,r=n.attr.L,l=n.attr.W;if(n.errorMsg)return void e.$message({type:"info",message:n.errorMsg});if(o!==r||s!==l)return void e.$message({type:"info",message:"导入图形尺寸为".concat(r,"*").concat(l,"(显示参考").concat(o,"*").concat(s,"),与BD不一致")});e.addUndo()}BDUtils.changeData(n,t.cfg.onlySetGraph),e.resetData()}else if("path"===t.fileType){var c=XmlUtil.toJson(t.str)[0];e.importPathData(c)}else"bd"===t.fileType&&e.loadBd(t.str,t.fileName)}),"AppRight")},importDataEvent:function(){bdDecode.event.bdImport.replaceSubcribe((function(e){var t=readFile(e.fileType),a="";t.then((function(e){var t=e.files[0];return a=t.name,decodeFile(t,"text","utf-8")})).then((function(t){bdDecode.event.bdStrImport.emit({str:t,fileName:a,fileType:e.fileType,cfg:e.cfg})}))}),"AppRight")},importData:function(e,t){bdDecode.event.bdImport.emit({fileType:e,cfg:t})},importPathData:function(e){var t=this;"string"===typeof e&&(e=XmlUtil.toJson(e)[0]),this.$bus.$emit("openDialog",{type:"editAttr",target:e.attr,editKeys:["L","W"],callback:function(a){e.attr.L=a.L,e.attr.W=a.W,hcEditLabel.addTempHC("path",e.attr),hcEditLabel.tempHC.Face=t.curFace,t.isAddHC=!0}})},loadXmlDataEvent:function(){var e=this;bdDecode.event.loadXmlData.replaceSubcribe((function(t){"bd"===t.dataType?e.loadBd(t.data,t.fileName):"x2d"===t.dataType&&e.loadX2d(t.data,t.fileName,t.di)}),"AppRight")},loadXmlData:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"bd",n=arguments.length>3?arguments[3]:void 0;bdDecode.event.loadXmlData.emit({data:e,fileName:t,dataType:a,di:n})},loadX2dEvent:function(){var e=this;bdDecode.event.loadX2d.replaceSubcribe((function(t){var a=XmlUtil.toJson(t.x2dXml)[0],n=BDUtils.x2dToBd(a),i=t.filename.replace(/\.x2d/,"")||"";e.updateBdJson(n,i),e.$bus.$emit("addHCBtnState",{isBanBtn:!1,message:""})}),"AppRight")},loadX2d:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0";bdDecode.event.loadX2d.emit({x2dXml:e,filename:t,di:a})},loadBDEvent:function(){var e=this;bdDecode.event.loadBD.replaceSubcribe((function(t){var a=UnlockBdXML(t.data);e.updateXML(a,t.fileName),e.$bus.$emit("addHCBtnState",{isBanBtn:!1,message:""})}),"AppRight")},loadBd:function(e,t){bdDecode.event.loadBD.emit({data:e,fileName:t})},resetView:function(){transform2d.reset(),transform2d.rotation=cncbacks[this.boardAttr.CncBack],canvas2d.isDisplay&&this.draw()},resetData:function(){this.boardAttr=bdDecode.boardAttr=BDUtils.getBoardAttr(),bdDecode.jGraph=this.graph=new JGraph(canvas2d.ctx,BDUtils.getGraphData(),this.boardAttr),graphUtil.init(this.graph),this.initDataList(),this.resetView()},graphObjToBdJson:function(e){var t=bdDecode.graphObjToBdJson(this.dataList,this.boardAttr,e);return t},editXMLCode:function(){this.$bus.$emit("openXMLCode",this.getBdXml())},getX2d:function(e){if(BDUtils.hasData){var t=this.graphObjToBdJson(),a=BDUtils.bdToX2d(t,e),n=XmlUtil.toXml(a);return n}return""},getBdXml:function(e){if(BDUtils.hasData){var t=this.graphObjToBdJson(e);this.isFromHome&&(t.attr.CncBack=this.orginCncback||t.attr.CncBack);var a=bdDecode.getBDXml(t);return a}return""},changePlane:function(e){var t=this.getX2d(e);this.updateXML(t,this.sName),this.$message({type:"success",message:"平面已转换为".concat(e.toUpperCase(),"平面"),duration:2e3}),this.$bus.$emit("x2dchange",!0)},exportX2d:function(e){var t=BDUtils.saveFile("x2d",this.getX2d(e),this.sName);t&&this.$message({type:"success",message:"导出x2d结束(".concat(e,"平面)"),duration:2e3})},exportBd:function(){var e=this.graphObjToBdJson(),t=XmlUtil.toXml(BDUtils.setBdAttr(e)),a=BDUtils.saveFile("bd",t,this.sName);a&&this.$message({type:"success",message:"导出bd结束",duration:2e3})},exportDxf:function(){var e=[].concat(Object(l["a"])(this.graph.nodes),Object(l["a"])(this.dataList["Face"+this.curFace]||[])),t=BDUtils.exportDxf(k,e,this.sName);t&&this.$message({type:"success",message:"导出dxf结束",duration:2e3})},revoke:function(){var e=this.undoStack.pop();if(e){var t=copyObject(this.dataList);t.Attr=copyObject(this.boardAttr),this.redoStack.push(t),this.loadData(e)}},recover:function(){var e=this.redoStack.pop();if(e){var t=copyObject(this.dataList);this.undoStack.push(t),this.loadData(e)}},cncbackChange:function(e){console.log(ObjUtil.JsonParse(e)),this.boardAttr.CncBack=e.CncBack,0==this.boardAttr.CncBack?this.$bus.$emit("addHCBtnState",{isBanBtn:!1,message:""}):this.$bus.$emit("addHCBtnState",{isBanBtn:!0,message:"请先切换到下靠挡"}),this.setRotation(e.degree)},setRotation:function(e){var t=this;this.graph&&(transform2d.rotation=e,this.graph.nodes.forEach((function(e){"Arc"===e.node&&e.updateAttr()})),["FaceA","FaceB"].forEach((function(e){var a=t.dataList[e].filter((function(e){return"Path"===e.node}));a.forEach((function(e){return e.update()}))})),this.draw())},saveXml:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.getBdXml({isClearOutKC:!0}),'<?xml version="1.0" encoding="utf-8"?>'!=a){t.next=4;break}return e.$message({type:"error",message:"请先打开Bd文件",duration:2e3}),t.abrupt("return");case 4:return e.loading=!0,n=new Blob([a],{type:"application/xml"}),t.next=8,Object(w["f"])({id:e.fileId,upload:n,icon:""});case 8:i=t.sent,1==i.state?e.$message({type:"success",message:"保存成功",duration:1e3}):e.$message({type:"error",message:"保存失败",duration:1e3}),e.loading=!1;case 11:case"end":return t.stop()}}),t)})))()},saveAsXml:function(){var e=this.getBdXml({isClearOutKC:!0});'<?xml version="1.0" encoding="utf-8"?>'!=e?(this.ImgResourceState=!0,this.dialogType="saveAsBd"):this.$message({type:"error",message:"请先打开Bd文件",duration:2e3})},saveBdXml:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.loading=!0,e=e||t.getBdXml({isClearOutKC:!0}),e){a.next=5;break}return t.$message({type:"error",message:"xml为空，保存失败",duration:1e3}),a.abrupt("return");case 5:n=LockBdXML(e,""),exportRaw(t.sName+".bd",n),t.loading=!1;case 8:case"end":return a.stop()}}),a)})))()},saveX2d:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,i,o,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.loading=!0,e=e||t.getX2d(),e){a.next=5;break}return t.$message({type:"error",message:"xml为空，保存失败",duration:1e3}),a.abrupt("return");case 5:return n=t.currentX2dData&&t.currentX2dData.groupName||"",i=t.toImgUrl(),o=[{key:t.sName+".x2d",data:e},{key:t.sName+".png",data:i||"",dataType:"png",groupName:n}],a.next=10,Object(g["a"])({data:JSON.stringify(o)});case 10:s=a.sent,1===s.state||1===s.result?t.$message({type:"success",message:"保存成功",duration:1e3}):t.$message({type:"error",message:"保存失败",duration:1e3}),t.$nextTick((function(){t.loading=!1,t.$bus.$emit("x2dchange",!1)}));case 13:case"end":return a.stop()}}),a)})))()},checkHcEditLabel:function(){if(["A","B"].includes(this.curFace)){var e=hcEditLabel.isPointInText(mouse.pos.x,mouse.pos.y);e.isInHLabel?hcEditLabel.hLabel.textSize=16:hcEditLabel.hLabel.textSize=12,e.isInVLabel?hcEditLabel.vLabel.textSize=16:hcEditLabel.vLabel.textSize=12}},showHcEditLabelInput:function(){if(["A","B"].includes(this.curFace)){var e,t,a,n,i=hcEditLabel.isPointInText(mouse.pos.x,mouse.pos.y);if(i.isInHLabel&&(e=hcEditLabel.hLabel.len,t=hcEditLabel.hLabel.textX,a=hcEditLabel.hLabel.textY,n="h"),i.isInVLabel&&(e=hcEditLabel.vLabel.len,t=hcEditLabel.vLabel.textX,a=hcEditLabel.vLabel.textY,n="v"),i.isInHLabel||i.isInVLabel){var o=document.getElementById("setInput"),s=document.getElementsByClassName("input-item")[0];this.editHc.value=e,this.showEditInput=!0,this.inputShow=!0,this.inputFocus(s),this.editHc.direction=n,setDomPosition(o,t,a)}}},setInputValue:function(){var e=this;if(this.showEditInput=!1,this.inputShow=!1,"string"===typeof this.editHc.value&&isNumber(this.editHc.value)){this.addUndo();var t=Number(this.editHc.value||0);isNaN(t)&&(t=0),t%1!=0&&(t=Number(t.toFixed(1)));var a=this.editHc.nodes,n=this.editHc.direction;a.forEach((function(a){var i=hcEditLabel.hLabel.len,o=t-i,s=hcEditLabel.vLabel.len,r=t-s;hcEditLabel.hDist>0&&(o*=-1),hcEditLabel.vDist>0&&(r*=-1),a instanceof Hole&&("h"===n&&(a.X.value+=o,a.X.formula=a.X.value),"v"===n&&(a.Y.value+=r,a.Y.formula=a.Y.value),a.update(e.graph.getLines())),a instanceof Cut&&("h"===n&&(a.X.value+=o,a.X1.value+=o,a.X.formula=a.X.value,a.X1.formula=a.X1.value),"v"===n&&(a.Y.value+=r,a.Y1.value+=r,a.Y.formula=a.Y.value,a.Y1.formula=a.Y1.value))})),hcEditLabel.checkBound(a,this.curFace),this.updateFbViewData(),this.draw()}},setInputValue2:function(e){var t=this.editInput[e],a=t.value-t.oldValue,n=!0;if(0!==a){var i=!1;if(this.addUndo(),"Line"===t.type&&(graphUtil.setLineLen(t),i=!0),"Point"===t.type&&(graphUtil.setLineLenByPoint(t),i=!0),"Arc"===t.type&&(0===parseInt(t.value)?(graphUtil.arcToRightAngle(t.node),i=!0):(n=graphUtil.setArcR(t),i=!0)),i){var o=graphUtil.checkRangeAbnormal();o?this.revoke():(graphUtil.updateGraph(),this.updateFbViewData(),this.draw())}}n&&this.hideInput()},showSelectHCLabel:function(){var e=this,t=this,a=!1,n=hcEditLabel.setSelectedToCurGroup();if(n)hcEditLabel.isShow=!0,hcEditLabel.selectedType=2,this.editHc.nodes=hcEditLabel.curGroup.holes,hcEditLabel.checkBound(this.editHc.nodes,this.curFace),this.tempDataList=copyObject(this.dataList),this.draw();else if(t.selectHC(mouse.pos.x,mouse.pos.y,(function(n,i){var o="Face"+t.curFace;n.isShowLabel=!0,n.isShowCoordinate=!0,t.curNode=n,e.$bus.$emit("selectCanvasNode","Face".concat(e.curFace,"-").concat(i)),e.showHCEditLabel(n),a=!0,t.tempDataList=copyObject(t.dataList),t.selectNodeOriginAttr=t.addNodeAttrCache(n),t.selectedHC={},t.selectedHC[o]=[i]}),(function(e,t){e.isShowLabel=!1,e.isShowCoordinate=!1})),!a){var i=hcEditLabel.isPointInText(mouse.pos.x,mouse.pos.y);i.isInHLabel||i.isInVLabel?hcEditLabel.isShow=!0:hcEditLabel.closeHoleGroup()}},moveSelectHC:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!1!==["A","B"].includes(e.Face)){var a=transform2d.getViewMatrix(),n=mat2d.transformCoord(mouse.pos,mat2d.invert(a));t&&"BHole"===e.node?this.moveAddBhole(e,n):"VHole"!==e.node&&"BHole"!==e.node||this.moveSelectHole(e,n),"Cut"===e.node&&this.moveSelectCut(e,n,a),"Path"===e.node&&this.movePath(e,n,t,a),hcEditLabel.selectedType=1,hcEditLabel.checkBound([e],this.curFace),this.draw()}},moveAddBhole:function(e,t){var a=graphUtil.getAddBholeXY(e,t);e.X.value=e.X.formula=a.x,e.Y.value=e.Y.formula=a.y,e.update()},movePath:function(e,t,a,n){if(a)e.X.value=e.X.formula=math2d.round(t.x),e.Y.value=e.Y.formula=math2d.round(t.y);else{var i=this.getMouseMoveDiff(t,n),o=i.dx,s=i.dy,r=this.selectNodeOriginAttr.X,l=this.selectNodeOriginAttr.Y;e.X.value=e.X.formula=math2d.round(r+o),e.Y.value=e.Y.formula=math2d.round(l+s)}},getMouseMoveDiff:function(e,t){var a=0,n=0;if(this.mousedownLoc){var i=mat2d.transformCoord(this.mousedownLoc,mat2d.invert(t));a=math2d.round(e.x)-i.x,n=math2d.round(e.y)-i.y}return{dx:a,dy:n}},moveSelectHole:function(e,t){if(!e.isSetHoleRange){var a=e.HDirect.formula,n=e.Hole_D?parseInt(e.Hole_D.value):29,i=e.R.value/2;if("VHole"===e.node)e.X.value=e.X.formula=math2d.round(t.x),e.Y.value=e.Y.formula=math2d.round(t.y);else{var o={x:e.X.value,y:e.Y.value},s=graphUtil.getMoveBHoleRange(a,o,i,n);if(s.isAttachLine)"L"!==a&&"R"!==a||t.y>=s.bound.miny&&t.y<=s.bound.maxy&&(e.Y.value=e.Y.formula=math2d.round(t.y)),"U"!==a&&"D"!==a||t.x>=s.bound.minx&&t.x<=s.bound.maxx&&(e.X.value=e.X.formula=math2d.round(t.x));else{var r=graphUtil.getAddBholeXY(e,t);e.X.value=e.X.formula=math2d.round(r.x),e.Y.value=e.Y.formula=math2d.round(r.y)}}e.update()}},moveSelectCut:function(e,t,a){var n,i,o=transform2d.rotation;if(e.CDirect&&(n=e.CDirect.formula),e.Cut_L&&(i=parseInt(e.Cut_L.value)),this.mousedownLoc&&this.selectNodeOriginAttr){var s=this.getMouseMoveDiff(t,a),r=s.dx,l=s.dy,c=this.selectNodeOriginAttr.X,u=this.selectNodeOriginAttr.Y,d=this.selectNodeOriginAttr.X1,h=this.selectNodeOriginAttr.Y1;e.X.value=e.X.formula=math2d.round(c+r),e.Y.value=e.Y.formula=math2d.round(u+l),e.X1.value=e.X1.formula=math2d.round(d+r),e.Y1.value=e.Y1.formula=math2d.round(h+l)}else{var p=e.X.value,m=e.Y.value,f=e.X1.value,v=e.Y1.value,g=!1;e.X.value=e.X.formula=math2d.round(t.x),e.Y.value=e.Y.formula=math2d.round(t.y),n?("水平"!==n||o%360!==0&&180!==o)&&("垂直"!==n||90!==o&&270!==o)||(g=!0):p!==f&&m===v&&(g=!0),g?(e.X1.value=e.X1.formula=e.X.value+i,e.Y1.value=e.Y1.formula=e.Y.value):(e.X1.value=e.X1.formula=e.X.value,e.Y1.value=e.Y1.formula=e.Y.value+i)}e.isEdit=!0},moveHoleGroup:function(){var e=hcEditLabel.curGroup.holes,t=hcEditLabel.tempGroup.holes,a=transform2d.getViewMatrix(),n=mat2d.transformCoord(this.mousedownLoc,mat2d.invert(a)),i=mat2d.transformCoord(mouse.pos,mat2d.invert(a)),o=i.x-n.x,s=i.y-n.y,r=this.graph.getLines();e.forEach((function(e,a){var n=t[a].X.value+o,i=t[a].Y.value+s;e.X.value=e.X.formula=math2d.round(n),e.Y.value=e.Y.formula=math2d.round(i),e.update(r)})),hcEditLabel.checkBound(e,this.curFace),hcEditLabel.setHoleGroupBound(o,s),this.draw()},addHCToDataList:function(){var e=hcEditLabel.tempHC;if(e){var t="Face"+e.Face;this.addUndo(),e.BDUtils=BDUtils,this.dataList[t].push(e),hcEditLabel.clearTempHC(),this.updateFbViewData()}this.isAddHC=!1},copyHCToHcEditLabel:function(){var e=this;if(D.ctrl&&e.curNode)if(hcEditLabel.curGroup){var t=hcEditLabel.curGroup.holes,a=[];t.forEach((function(e){var a=copyObject(e),n=new Hole(a,a.node,BDUtils);n.setNotAuto(1),t.push(n)})),hcEditLabel.curGroup.holes=a}else{var n=copyObject(e.curNode),i="Cut"===n.node?"cut":"hole";hcEditLabel.addTempHC(i,n,e.graph.getLines()),e.isAddHC=!0}},dragSelectHole:function(){if(hcEditLabel.dragging){var e=this.dataList["Face"+this.curFace];hcEditLabel.selectHoleInRect(e,this.curFace)}},addUndo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.dataList,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.boardAttr;function a(e){return"[object Object]"===toString.call(e)}function n(e,t){t=t||new Set;var o=[];return e.forEach((function(e){a(e)?o.push(i(e,t)):Array.isArray(e)?o.push(n(e,t)):o.push(e)})),o}function i(e,t){if(t=t||new Set,t.has(e))return e;if(a(e)){var o=Object.create(null);return Object.keys(e).forEach((function(s){var r=e[s];a(r)?(o[s]=i(r,t),t.add(r)):Array.isArray(r)?(o[s]=n(r,t),t.add(r)):o[s]=r})),o}return Array.isArray(e)?n(e):void 0}e.Attr=i(t);var o=i(e);this.undoStack.push(o),this.redoStack=[],this.$bus.$emit("x2dchange",!0)},loadData:function(e){if(e){var t=this,a=[].concat(Object(l["a"])(e.FaceA),Object(l["a"])(e.FaceB));t.dataList.Graph=e.Graph,t.dataList.FaceA=[],t.dataList.FaceB=[],t.dataList.Attr=t.dataList.Attr||{},t.graph.reset(e.Graph);var n=e.Attr||{};for(var i in n)t.dataList.Attr[i]=n[i],t.boardAttr[i]=n[i];a.forEach((function(e){if("VHole"===e.node||"BHole"===e.node){var a=new Hole(e,e.node,BDUtils);"A"===e.Face?t.dataList.FaceA.push(a):t.dataList.FaceB.push(a)}if("Cut"===e.node){var n=new Cut(e);"A"===e.Face?t.dataList.FaceA.push(n):t.dataList.FaceB.push(n)}if("Path"===e.node){var i=new Path2DX(e);"A"===e.Face?t.dataList.FaceA.push(i):t.dataList.FaceB.push(i)}})),t.updateFbViewData(),hcEditLabel.isShow=!1,t.draw()}},changeViewState:function(){if(this.viewState=1,this.curFace="",this.handleType="",this.nocheckSelect=!1,this.isDraw){var e=this.getSize();n.setPreviewData(this.dataList,e),this.draw()}},btnClick:function(e){switch(e.type){case"增加开槽":this.addNewNode("cut");break;case"增加垂直孔":this.addNewNode("hole",0);break;case"增加大饼孔":this.addNewNode("hole",1);break;case"撤销":this.revoke();break;case"恢复":this.recover();break;case"保存":this.saveXml();break;case"另存为":this.saveAsXml();break;case"保存到主页":this.saveToHome();break;case"清除还原回到主页":this.clearExitToHome();break;case"导出bd":this.exportBd();break;case 8:this.restoreQuit();break;case"导出dxf":this.exportDxf();break;case"导出x2d":this.exportX2d(e.plane);break;case"导入":this.importData(e.fileType,e);break;case"反向排序":this.reverseGraphList();break}},saveToHomeEvent:function(){var e=this;bdDecode.event.saveToHome.replaceSubcribe(Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,i,o,s,r,l,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.getBdXml({isClearOutKC:!0}),a){t.next=4;break}return e.$message({type:"warn",message:"数据未加载完，不能保存!"}),t.abrupt("return");case 4:return n=C()(a)+".bd",i={md5:n,data:a,bomName:e.dataFromMainApp.bomName,label:e.dataFromMainApp.label},t.prev=6,t.next=9,HgServiceTool.saveBDToCache(i);case 9:o=t.sent,console.log("缓存BD结果",o,i),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](6),console.log("保存bd到缓存失败",t.t0);case 16:return s=new Blob([a],{type:"text/html"}),t.next=19,Object(w["e"])({upload:s,dirName:"@USER_DATA",fileName:n,icon:"",type:"BD",bomName:i.bomName,label:i.label});case 19:if(r=t.sent,1!=r.state){t.next=31;break}if(l=bdDecode.isSameSize(a),l){t.next=25;break}return e.$message.error("整体尺寸已经不一样,请恢复原来的尺寸"),t.abrupt("return");case 25:c=bdDecode.checkAppBDUI(e.getBdXml()),window.opener.UIAction.SetDataFromBD({name:n,guid:e.blockGuid,checkData:c}),window.opener.gBomWorker&&(console.log("gBomWorker",e.$gData.qdsoftId),window.opener.gBomWorker.postMessage({method:"UpdateBD",qdsoftid:e.$gData.qdsoftId,data:a,fileName:n,path:"@USER_DATA//"+n})),window.close(),t.next=32;break;case 31:e.$message.error("保存失败，请重试");case 32:case"end":return t.stop()}}),t,null,[[6,13]])}))),"AppRight")},saveToHome:function(){return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,bdDecode.event.saveToHome.asyncEmit();case 2:return e.abrupt("return");case 3:case"end":return e.stop()}}),e)})))()},clearExitToHomeEvent:function(){var e=this;bdDecode.event.clearExitToHome.replaceSubcribe(Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=bdDecode.getClearCheckAppBDUI(),window.opener.UIAction.SetDataFromBD({name:e.originFileName,guid:e.blockGuid,checkData:a}),window.close();case 3:case"end":return t.stop()}}),t)}))),"AppRight")},clearExitToHome:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:console.log("清除还原:","保存的名称："+e.originFileName,e.blockGuid),e.$confirm("确定是否清除还原?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,bdDecode.event.clearExitToHome.asyncEmit();case 2:return e.abrupt("return");case 3:case"end":return e.stop()}}),e)})))).catch((function(){}));case 2:case"end":return t.stop()}}),t)})))()},moveByKeyBoard:function(e,t){1===hcEditLabel.selectedType?this.moveHoleByKeyBoard(this.curNode,e,t):2===hcEditLabel.selectedType&&this.moveHolesBykeyBoard(e,t)},moveHoleByKeyBoard:function(e,t,a){if("VHole"===e.node)e.X.value+=t,e.Y.value+=a;else{if("BHole"!==e.node)return;var n=e.HDirect.formula;"L"!==n&&"R"!==n||(e.Y.value+=a),"U"!==n&&"D"!==n||(e.X.value+=t)}e.X.formula=e.X.value,e.Y.formula=e.Y.value,e.update(this.graph.getLines()),hcEditLabel.checkBound([e],this.curFace),this.draw()},moveHolesBykeyBoard:function(e,t){var a=hcEditLabel.curGroup.holes,n=this.graph.getLines();a.forEach((function(a){a.X.value+=e,a.Y.value+=t,a.X.formula=a.X.value,a.Y.formula=a.Y.value,a.update(n)})),hcEditLabel.checkBound(a,this.curFace),hcEditLabel.setHoleGroupBound2(e,t),this.draw()},holeGroupRightMenu:function(e){switch(e){case"copy":hcEditLabel.copyCurGroup(this.graph.getLines());break;case"stick":this.stickHoleGroup();break;case"group":case"ungroup":hcEditLabel.setGroup(e);break;case"delete":this.deleteHolegroup();break}},stickHoleGroup:function(){var e,t=hcEditLabel.copyHoleGroup.holes,a=[];t.forEach((function(e){var t=new Hole(e,e.node,BDUtils);t.setNotAuto(1),a.push(t)})),this.addUndo(),hcEditLabel.addHoleGroup(this.curFace,a),(e=this.dataList["Face"+this.curFace]).push.apply(e,a),this.updateFbViewData(),this.draw()},deleteHolegroup:function(){for(var e=hcEditLabel.getGroupHoleId(),t=this.dataList["Face"+this.curFace],a=0;a<t.length;a++){var n=t[a].id;e.indexOf(n)>-1&&(t.splice(a,1),a--)}hcEditLabel.deleteHoleGroup(),hcEditLabel.closeHoleGroup()},addNodeAttrCache:function(e){var t=e.node,a={Cut:["X","Y","X1","Y1"],Path:["X","Y"]},n={type:t},i=a[t];return i&&i.forEach((function(t){var a=e[t].value;n[t]=a})),n},stick:function(){},showGraphEditInput:function(e){var t=e.type;if("Line"===t){var a=e.node,n=graphUtil.getNearNode(a),i=n.pre,o=n.next;if("Arc"===i.type||"Arc"===o.type)return;this.showLineInput("edit1","Line",i.node,a,"pre"),this.showLineInput("edit2","Line",o.node,a,"next")}else"Arc"===t?this.showArcInput(e.node):"Point"===t&&this.showPointInput(e.node)},showLineInput:function(e,t,a,n,i){if("Line"===t){var o=a.lineType();if("斜"!==o){var s=a.label.getTextRect(),r=document.getElementById(e),l=this.editInput[e];l.lineType=a.lineType(),l.value=a.len,l.oldValue=a.len,l.show=!0,l.selectNode=n,l.node=a,l.type="Line",l.position=i,setDomPosition(r,s.x,s.y)}}this.inputShow=!0},showPointInput:function(e){var t=graphUtil.getLine(e,"p2");if(t){var a=graphUtil.getNearNode(t).next.node,n=t.lineType();if("斜"!==n&&"Line"===a.node){var i=t.label.getTextRect(),o=document.getElementById("edit1"),s=this.editInput["edit1"];s.value=t.len,s.oldValue=t.len,s.type="Point",s.node=t,s.show=!0,s.lineType=t.lineType(),setDomPosition(o,i.x,i.y),this.inputShow=!0,this.inputFocus(o)}}},showArcInput:function(e){var t=graphUtil.arcNearLineType(e);if(1===t.type){var a=e.rLabel.getTextRect(),n=document.getElementById("edit1"),i=this.editInput["edit1"],o=math2d.round(e.r);e.isSelected=!0,i.value=o,i.oldValue=o,i.type="Arc",i.node=e,i.show=!0,setDomPosition(n,a.x,a.y),this.inputShow=!0,this.inputFocus(n),this.draw()}},hideInput:function(){this.showEditInput=!1,this.editInput.edit1.show=!1,this.editInput.edit2.show=!1,this.inputShow=!1},inputFocus:function(e){this.$nextTick((function(){e.select(),e.focus()}))},reverseGraphList:function(){var e=this;this.$confirm("是否对当前所有点进行反向排序?","",{type:"warning",showClose:!1}).then(Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.addUndo(),reverse(e.graph.children),e.graph.update(),e.draw();case 4:case"end":return t.stop()}}),t)})))).catch((function(){}))},createX2d:function(e){var t=this;this.$confirm("是否覆盖源代码?","",{type:"warning",showClose:!1}).then(Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.updateXML(e),t.$bus.$emit("x2dchange",!0);case 2:case"end":return a.stop()}}),a)}))))},saveAsPath:function(){if(this.sName){var e=y["b"](this.getX2d(),this.sName);exportRaw(this.sName+".path",e)}},lineToTArc:function(e){var t=this;this.$prompt("设置弦高","",{inputPattern:/^[1-9][0-9]*$/,inputErrorMessage:"请输入大于0的整数",showClose:!1}).then((function(a){var n=a.value,i=Number(n);isNaN(i)?console.error("弦高的值输入格式有误"):t.transformSelectLineToTArc(i,e)}))},transformSelectLineToTArc:function(e,t,a){if(e=Number(e),this.addUndo(),"设置属性"===a){var n=this.rightSelectedItem.node,i=n.attr;i.IsBulge.formula=i.IsBulge.value=t,i.ChordH.formula=i.ChordH.value=e,this.graph.update(n)}else{var o=this.selectedItem.node,s={node:"TArc",attr:{X:o.p1.attr.X,Y:o.p1.attr.Y,X2:o.p2.attr.X,Y2:o.p2.attr.Y,ChordH:{formula:e,value:e},IsBulge:{formula:t,value:t},Hotspot:{formula:"0",value:"0"},IsDim:{formula:"0",value:"0"}}},r=this.graph.children.indexOf(this.selectedItem.node.p2);this.graph.children.splice(r,0,s),this.graph.update()}this.updateFbViewData(),this.draw()},pathManage:function(){this.ImgResourceState=!0},ImgResourceClose:function(){this.ImgResourceState=!1},ImgResourceSuccess:function(e,t,a){var n=this;return Object(s["a"])(regeneratorRuntime.mark((function i(){var o,s,r,l,c;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(n.loading=!0,"openBd"!=n.dialogType){i.next=9;break}return i.next=4,Object(w["b"])({id:e.id});case 4:o=i.sent,n.fileId=e.id,n.loadBd(o),i.next=19;break;case 9:if("saveAsBd"!=n.dialogType){i.next=19;break}if(r=n.getBdXml(),r){i.next=14;break}return n.$message({type:"warn",message:"数据未加载完，不能保存!"}),i.abrupt("return");case 14:return l=new Blob([r],{type:"text/html"}),i.next=17,Object(w["d"])({upload:l,dirId:t.dirId,fileName:a+".bd",icon:null!==(s=null===e||void 0===e?void 0:e.icon)&&void 0!==s?s:"",type:"BD"});case 17:c=i.sent,1==c.state?n.$message({type:"success",message:"保存成功",duration:1e3}):n.$message({type:"error",message:"保存失败",duration:1e3});case 19:n.ImgResourceClose(),n.loading=!1;case 21:case"end":return i.stop()}}),i)})))()},leftMenuHandle:function(e){"x2d重命名"===e.type&&e.oldName===this.sName&&(this.sName=e.newName)},toImgUrl:function(){if(BDUtils.hasData){var e=canvas2d.canvas2.clientWidth||canvas2d.canvas2.width,t=canvas2d.canvas2.clientHeight||canvas2d.canvas2.height,a=this.getSize(),n=a.bl,i=a.bw,o=.7*transform2d.getScale(n,i,e,t,0),s=transform2d.getMatrix({h:t});s=transform2d.getViewMatrix(s,n,i,[0,0],[e,t],o);var r=[].concat(Object(l["a"])(this.dataList["FaceA"]),Object(l["a"])(this.dataList["FaceB"]));canvas2d.clear2(),this.graph.draw2(canvas2d.ctx2,s),r.forEach((function(e){"Path"===e.node&&e.draw2(canvas2d.ctx2,s)}));var c=canvas2d.toDataUrl();return c}},getFBsByCncback:function(){var e=Number(this.boardAttr.LFB||0),t=Number(this.boardAttr.RFB||0),a=Number(this.boardAttr.UFB||0),n=Number(this.boardAttr.DFB||0),i=BDUtils.transformFbByCncback([a,n,e,t],this.boardAttr.CncBack);return i.map((function(e){return[e,!0]}))},exportPng:function(){var e=[].concat(Object(l["a"])(this.dataList["FaceA"]),Object(l["a"])(this.dataList["FaceB"])),t={textBgColor:"",textColor:"#000",color:"#000"};this.styleMode="导出png",canvas2d.isHideAxis=!0,e.forEach((function(e){e.color="#000",e.setLabelStyle(t)})),this.graph.color="#000",this.graph.setLabelStyle(t),n.setLabelStyle(t),this.draw();var a=canvas2d.canvas.toDataURL("image/png");DomUtil.saveBase64File(a,"".concat(this.sName||"bd",".png")),this.styleMode="默认",canvas2d.isHideAxis=!1,e.forEach((function(e){e.color="#fff",e.setLabelStyle()})),this.graph.color="#fff",this.graph.setLabelStyle(),n.setLabelStyle(),this.draw()},openHoleSlotRule:function(){this.holeSlotRuleState=!0},saveHoleSlotRule:function(){this.holeSlotRuleState=!1},isShowHoleInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;bdDecode.jcanvas.showHoleInfo(e);var a=["A","B"];a.forEach((function(a){var n=t.dataList["Face"+a];n&&n.forEach((function(t){t.isShowInfo=e}))})),i.isShowHoleInfo(e),n.isShowInfo=e,this.draw()},resetBdAttr:function(e,t){Object.assign(e.attr,t);var a=["CA","CB","CC","CD","CE","CF","CG","CH","CI","CJ","CK","CL","CM","CN","CO","CP"];a.forEach((function(a){void 0!==e.attr[a]&&void 0===t[a]&&(e.attr[a]=0)})),console.log(e,t)},resetRect:function(){this.addUndo(),BDUtils.resetRect(this.graph),this.graph.update(),this.updateFbViewData(),this.draw()},addHoleCfg:function(e){BDUtils.addHoleCfgs(e,this.curFace),this.addUndo(),this.updateAllHoleByHoleRule(),this.updateFbViewData(),this.draw()},updateAllHoleByHoleRule:function(){var e,t,a=BDUtils.getHoleShapeDataByHoleRule();function n(e){for(var t=e.length-1;t>0;t--){var a=e[t];2===a.holeType&&e.splice(t,1)}}n(this.dataList["FaceA"]),n(this.dataList["FaceB"]),(e=this.dataList["FaceA"]).push.apply(e,Object(l["a"])(a["A"])),(t=this.dataList["FaceB"]).push.apply(t,Object(l["a"])(a["B"]))},changeOutlineStyleAndCursorStyle:function(e){if(e.isIn){var t=e.item;if("Point"===t.type);else if("Line"===t.type&&(t.node.changeLineStyle(!0),!["addGroupHole","lineToArc"].includes(this.handleType)))if(e.isInLineCenter)canvas2d.setCursor("pointer"),t.node.changeCenterStyle(!0,!0);else{var a=t.node.lineType();t.node.changeCenterStyle(!0,!1),"竖"===a?canvas2d.setCursor("col-resize"):"横"===a&&canvas2d.setCursor("row-resize")}}else canvas2d.setCursor("default")},addGroupHole:function(e,t){var a=this;if("selectSlide"===e)this.handleType="addGroupHole";else if("addHolesByCfg"===e){var n=this.selectedItem.node,i=BDUtils.getHolesByHoleRule(n.len,n.getBox(),t.holeInfo,t.ruleInfoCfg);return this.addUndo(),void i.forEach((function(e){var t=a.curFace;e.Face=t,e["X"].value=calcFormula(e["X"].formula,a.boardAttr),e["Y"].value=calcFormula(e["Y"].formula,a.boardAttr),e.update(),a.dataList["Face"+t].push(e)}))}},openAddholeDialog:function(){this.selectedItem&&this.$bus.$emit("addGroupHole","openAddholeDialog",{direct:this.selectedItem.node.lineType()})},cancelSelectSide:function(){this.handleType="",this.$bus.$emit("closeSelectSlide")},openTransformPointFrom:function(e){this.formType=e,this.form.radius="30",this.form.width="30",this.form.height="30",this.dialogFormVisible=!0},transformPoint:function(){this.dialogFormVisible=!1;var e=Number(this.form.radius||0),t=Number(this.form.width||0),a=Number(this.form.height||0);switch(this.formType){case"斜线":this.point2Angle("line",t,a);break;case"直角":this.point2Angle("rightAngle",t,a);break;case"外凸弧":this.point2Arc("外凸",e);break;case"内凹弧":this.point2Arc("内凹",e);break}},keyboardHandle:function(e){switch(e){case"cancel":this.revoke();break;case"recover":this.recover();break}},showLine2ArcDialog:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"转为圆弧",a=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=this.dialogVisible_line2arc;e?(i.method=t,i.isBulge=a,i.chordH=n,i.LineToArc=!0):i.LineToArc=!1},updateRightPointMenu:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"所有",t={"所有":[0,1,2,3,4,5],"水平点":[5],"转折点":[1,2,3,4]},a=t[e]||[];this.rightPointMenuList.forEach((function(e,t){a.includes(t)?e.show=!0:e.show=!1})),this.isFromHome&&(this.rightPointMenuList[0].show=!1)},calcFaceCenterMatrix:function(e){var t=this.getSize(),a=t.bl,n=t.bw,i=canvas2d.canvas,o=i.clientWidth,s=i.clientHeight,r=this.curFace,l={L:[o/2,0],R:[o/2,0],U:[0,s/2],D:[0,s/2]},c=l[r]||[0,0];return transform2d.getViewMatrix(e,a,n,c)},getSize:function(){var e=this.boardAttr,t=e.L,a=void 0===t?0:t,n=e.W,i=void 0===n?0:n,o=e.BH,s=void 0===o?0:o;return a=Number(a),i=Number(i),s=Number(s),{bl:a,bw:i,bh:s}},updateFbViewData:function(){if(i){var e=this.getSize(),t=this.dataList,a=t.FaceA,n=t.FaceB;i.setSize(e),i.setPreviewData(this.graph.nodes,a,n)}},updateHCErrorobj:function(){var e=this.errorobjs;if(e){var t=function(e,t,n){if(n){var i=n.Face,s=n.Type,r=n.X,l=n.Y;if(e.Face===i){var c=e.get(["X","Y"]),u=Object(o["a"])(c,2),d=u[0],h=u[1],p=!1;("Hole"===s&&a.includes(e.node)||"Cut"===s&&"Cut"===e.node)&&(p=!0),p&&d===r&&h===l&&e.addErrortag(t)}}},a=["BHole","VHole"],n=[].concat(Object(l["a"])(this.dataList.FaceA),Object(l["a"])(this.dataList.FaceB));e.forEach((function(e){var a=e.errortag,i=e.obj1,o=e.obj2;n.forEach((function(e){t(e,a,i),t(e,a,o)}))}))}}},components:{TopBar:u["a"],LeftMenu:d["a"],Right:h["a"],Attredit:p["a"],XmlCode:m["a"],Dialog:f["a"],imgSource:b["a"],QdInput:H["a"],LineToArc:v["a"]}}}).call(this,a("c8ba"))},bd00:function(e,t,a){"use strict";var n=a("1176"),i=a.n(n);i.a},c32a:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("a9e3");var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ascending";return function(a,n){var i=a[e]||"",o=n[e]||"";return isNaN(Number(i))||isNaN(Number(o))?"ascending"==t?i.localeCompare(o,"zh-Hans-CN",{sensitivity:"accent"}):o.localeCompare(i,"zh-Hans-CN",{sensitivity:"accent"}):Number(i)==Number(o)?i.length<o.length&&"ascending"==t||i.length>o.length&&"descending"==t?-1:i.length>o.length&&"ascending"==t||i.length<o.length&&"descending"==t?1:0:(i=Number(i),o=Number(o),i<o&&"ascending"==t||i>o&&"descending"==t?-1:i>o&&"ascending"==t||i<o&&"descending"==t?1:0)}}},d264:function(e,t,a){"use strict";var n=a("90a9"),i=a.n(n);i.a},d2c8:function(e,t,a){},d32a:function(e,t,a){},d4ae:function(e,t,a){"use strict";var n=a("b4ca"),i=a.n(n);i.a},d898:function(e,t,a){e.exports=a.p+"img/中心孔.jpg"},d98e:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dialog-wrap"},[a("el-dialog",{attrs:{title:"修改属性",visible:e.dialogVisibles.editAttr},on:{"update:visible":function(t){return e.$set(e.dialogVisibles,"editAttr",t)}}},[a("div",{staticClass:"edit-input-box"},e._l(e.editAttrs,(function(t,n){return a("div",{key:n,staticClass:"edit-input"},[a("span",{staticClass:"attr-name"},[e._v(e._s(t.label))]),a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1)})),0),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.close}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.configrue}},[e._v("确 定")])],1)])],1)},i=[],o=(a("4160"),a("159b"),{props:["Dialog"],data:function(){return{dialogVisibles:{editAttr:!1},labels:{L:"宽",W:"高"},editAttrs:[],targetData:null}},created:function(){this.$bus.$on("openDialog",this.openDialog)},methods:{openDialog:function(e){switch(this.targetData=e,this.targetData.callback=e.callback||function(){},e.type){case"editAttr":this.initEditAttr();break}},initEditAttr:function(){var e=this,t=this.targetData,a=t.editKeys,n=t.target;this.editAttrs=[],a.forEach((function(t){var a=n[t],i=e.labels[t]||t;e.editAttrs.push({label:i,key:t,value:a}),e.dialogVisibles.editAttr=!0}))},configrue:function(){var e={};this.editAttrs.forEach((function(t){e[t.key]=t.value})),this.targetData.callback(e),this.close()},close:function(){for(var e in this.dialogVisibles)this.dialogVisibles[e]=!1;this.targetData=null}}}),s=o,r=(a("715e"),a("2877")),l=Object(r["a"])(s,n,i,!1,null,null,null);t["a"]=l.exports},d997:function(e,t,a){"use strict";var n=a("35cc"),i=a.n(n);i.a},dac6:function(e,t,a){"use strict";a.d(t,"c",(function(){return d})),a.d(t,"a",(function(){return h})),a.d(t,"b",(function(){return b}));a("d3b7");var n=a("5530"),i=a("bc3a"),o=a.n(i),s=a("4328"),r=a.n(s),l=a("323e"),c=a.n(l),u=(a("a5d8"),a("fa7d"));c.a.configure({ease:"ease",speed:500,showSpinner:!1});var d=!1,h="".concat(location.origin);console.log(h);var p=Object(u["b"])(),m=localStorage.getItem("loginId")||"",f=localStorage.getItem("logName"),v={baseURL:"".concat(location.origin,"/hgsoft_base/BaseGraph"),timeout:6e4,transformRequest:[function(e){return void 0!==e&&"[object FormData]"===[].toString.apply(e)?e:r.a.stringify(e)}]},g=o.a.create(v);g.interceptors.request.use((function(e){return c.a.start(),e}),(function(e){return Promise.reject(e)})),g.interceptors.response.use((function(e){return c.a.done(),{data:e.data,status:e.status}}),(function(e){return c.a.done(),Promise.reject(e)}));function b(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"post";return function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0,s=Object(n["a"])(Object(n["a"])({},i),{},{group:"qd_textdata_list_head",qdsoft:p,loginId:m,logName:f});if(t){var r=new FormData;for(var l in s)r.append(l,s[l]);s=r}return g({method:a,url:e,data:s}).then((function(e){return o&&o(e.data),e.data})).catch((function(){return o&&o({result:-1}),{result:-1}}))}}},db04:function(e,t,a){"use strict";a.d(t,"f",(function(){return i})),a.d(t,"e",(function(){return o})),a.d(t,"b",(function(){return s})),a.d(t,"d",(function(){return r})),a.d(t,"c",(function(){return l})),a.d(t,"h",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"g",(function(){return d}));var n=a("dac6"),i=Object(n["b"])("/GetTextKeyList/"),o=Object(n["b"])("/GetTextData/"),s=Object(n["b"])("/SetTextData/"),r=(Object(n["b"])("/SetTextData/"),Object(n["b"])("/DeleteTextKey/")),l=Object(n["b"])("/UpdateTextKey/"),c=Object(n["b"])("/updateBatch/"),u=Object(n["b"])("/addBatch/"),d=Object(n["b"])("/getGroupName/")},dd7e:function(e,t,a){"use strict";a("4160"),a("a434");var n,i=a("2b0e"),o=a("26a1"),s=[],r="@@clickoutsideContext",l=0;function c(e,t,a){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!(a&&a.context&&n.target&&i.target)||e.contains(n.target)||e.contains(i.target)||e===n.target||a.context.popperElm&&(a.context.popperElm.contains(n.target)||a.context.popperElm.contains(i.target))||(t.expression&&e[r].methodName&&a.context[e[r].methodName]?a.context[e[r].methodName]():e[r].bindingFn&&e[r].bindingFn())}}!i["default"].prototype.$isServer&&Object(o["a"])(document,"mousedown",(function(e){return n=e})),!i["default"].prototype.$isServer&&Object(o["a"])(document,"mouseup",(function(e){s.forEach((function(t){return t[r].documentHandler(e,n)}))})),t["a"]={bind:function(e,t,a){s.push(e);var n=l++;e[r]={id:n,documentHandler:c(e,t,a),methodName:t.expression,bindingFn:t.value}},update:function(e,t,a){e[r].documentHandler=c(e,t,a),e[r].methodName=t.expression,e[r].bindingFn=t.value},unbind:function(e){for(var t=s.length,a=0;a<t;a++)if(s[a][r].id===e[r].id){s.splice(a,1);break}delete e[r]}}},e03b:function(e,t,a){},e131:function(e,t,a){"use strict";var n=a("5b86"),i=a.n(n);i.a},e551:function(e,t,a){"use strict";var n=a("ecb9"),i=a.n(n);i.a},e58f:function(e,t,a){},e67d:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));a("4de4"),a("c740"),a("a434");var n=a("2909");function i(){var e=-1;return function(t,a,i,o){try{if(t&&t.ctrlKey&&i.length>0){var s=i.findIndex((function(e){return e==o}));-1!==s?i.splice(s,1):i.push(o)}else if(t&&t.shiftKey&&i.length>0){var r=a.findIndex((function(t){return t==e})),l=a.findIndex((function(e){return e==o})),c=[Math.min(r,l),Math.max(r,l)];r=c[0],l=c[1],i.splice(0),i.push.apply(i,Object(n["a"])(a.filter((function(e,t){return t>=r&&t<=l}))))}else i.splice(0),i.push(o),e=o}catch(u){}}}},e6c5:function(e,t,a){},ecb9:function(e,t,a){},ee37:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return r})),a.d(t,"f",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"d",(function(){return u}));var n=a("dac6"),i="".concat(n["a"],"/hgsoft_base/fileSource/"),o=Object(n["b"])("".concat(i,"getDirData.action")),s=Object(n["b"])("".concat(i,"getResources.action")),r=(Object(n["b"])("".concat(i,"getResourceData.action")),Object(n["b"])("".concat(i,"getResourceDataStr.action"))),l=Object(n["b"])("".concat(i,"saveResourceData.action"),!0),c=Object(n["b"])("".concat(i,"SaveResources.action"),!0),u=Object(n["b"])("".concat(i,"saveResourceAs.action"),!0);Object(n["b"])("".concat(i,"delResource.action"),!0)},ee87:function(e,t,a){e.exports=a.p+"img/default.png"},f6e0:function(e,t,a){},fa7d:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));a("d3b7"),a("25f0");function n(e){var t=document.createElement("textarea");t.innerHTML=e.toString(),document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}function i(){var e;try{e=window.opener&&window.opener.gMainApp?window.opener.gMainApp:null}catch(i){console.log("获取不到主页传来的gMainApp",i),e=null}var t=JSON.parse(localStorage.getItem("loginCorpInfo")),a=t?t.qdSoftId:"",n=e?e.mQdSoftid:"";return a||n||"009_qdsoft"}},fcf0:function(e,t,a){"use strict";var n=a("fd3c"),i=a.n(n);i.a},fd3c:function(e,t,a){}});